search.patientBanner= select distinct p.name_full_formatted, p.person_id,\
   to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, pa.alias AS MRN,\
   pa.end_effective_dt_tm as mrnDate, ap.format_mask as MRN_format, \
  get_cd_value(p.SEX_CD, 'display') AS SEX, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm\
   from person p LEFT OUTER JOIN person_alias pa ON \
  (pa.person_id=p.person_id and pa.active_ind=1 and pa.person_alias_type_cd=2328) \
  INNER JOIN alias_pool ap ON (ap.alias_pool_cd = pa.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate)\
   where p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222 and p.person_id=?

search.patientBannerWithEncntr= select distinct p.name_full_formatted, p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm,\
   pa.alias AS MRN, pa.end_effective_dt_tm as mrnDate, ap.format_mask as MRN_format, get_cd_value(p.SEX_CD, 'display') AS SEX, \
  to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, \
  to_char(e.reg_dt_tm,'MM/DD/YYYY HH24:MI') as Reg_dt_tm, to_char(e.disch_dt_tm,'MM/DD/YYYY HH24:MI') as Disch_dt_tm, \
  ea.alias as Acct,ap1.format_mask as FIN_format from person p LEFT OUTER JOIN person_alias pa ON (pa.person_id=p.person_id \
  and pa.active_ind=1 and pa.person_alias_type_cd=2328) INNER JOIN alias_pool ap ON (ap.alias_pool_cd = pa.alias_pool_cd and ap.active_ind = 1\
   and ap.end_effective_dt_tm > sysdate)  LEFT OUTER JOIN encounter e ON (e.person_id=p.person_id and e.active_ind=1 and e.end_effective_dt_tm>sysdate)\
   LEFT OUTER JOIN encntr_alias ea ON (ea.encntr_id=e.encntr_id and ea.active_ind=1 and ea.encntr_alias_type_cd=91)\
   INNER JOIN alias_pool ap1 on (ap1.alias_pool_cd = ea.alias_pool_cd and ap1.active_ind=1 and ap1.end_effective_dt_tm > sysdate) \
  where p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222 and p.person_id=? and e.encntr_id=?

search.personByPagination= select * from (select a.*, rownum rnum from (select distinct p.name_full_formatted,p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm,GET_MRNS(p.person_id) as MRNString, get_cd_value(p.SEX_CD, 'display') AS SEX, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, pa2.alias AS SSN, ap1.format_mask as SSN_format, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from person p LEFT OUTER join person_alias pa2 ON (pa2.person_id=p.person_id and pa2.active_ind=1 and pa2.person_alias_type_cd=2334 and pa2.alias_pool_cd=7091 and pa2.end_effective_dt_tm > sysdate) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = pa2.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=p.person_id and a.parent_entity_name='PERSON' and a.active_ind=1 and a.end_effective_dt_tm>sysdate and a.address_type_cd = 288) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where p.person_type_cd=222 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.personByNoPagination= select distinct p.name_full_formatted,p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm,GET_MRNS(p.person_id) as MRNString, get_cd_value(p.SEX_CD, 'display') AS SEX, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, pa2.alias AS SSN, ap1.format_mask as SSN_format, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from person p LEFT OUTER join person_alias pa2 ON (pa2.person_id=p.person_id and pa2.active_ind=1 and pa2.person_alias_type_cd=2334 and pa2.alias_pool_cd=7091 and pa2.end_effective_dt_tm > sysdate) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = pa2.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=p.person_id and a.parent_entity_name='PERSON' and a.active_ind=1 and a.end_effective_dt_tm>sysdate and a.address_type_cd = 288) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where p.person_type_cd=222 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

person.encounter= select get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, case when to_char(e.reg_dt_tm,'HH24:MI') = '00:00' then to_char(e.reg_dt_tm,'MM/DD/YYYY') else to_char(e.reg_dt_tm,'MM/DD/YYYY HH24:MI') end as Reg_dt_tm, case when to_char(e.disch_dt_tm,'HH24:MI') = '00:00' then to_char(e.disch_dt_tm,'MM/DD/YYYY') else to_char(e.disch_dt_tm,'MM/DD/YYYY HH24:MI') end as Disch_dt_tm, get_cd_value(e.med_service_cd, 'display') as Medical_service, get_cd_value(e.loc_facility_cd, 'display') as Facility, case when e.loc_room_cd>0 then case when e.loc_bed_cd>0 then concat(concat(concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display')),';'), get_cd_value(e.loc_bed_cd, 'display')) else (concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display'))) end else get_cd_value(e.loc_nurse_unit_cd, 'display') end as location, ea.alias as Acct,ap.format_mask as FIN_format, e.encntr_id as Encntr_id, get_cd_value(e.encntr_status_cd, 'display') as EncntrStatus, ea1.alias as ChartNum, eppa.PPR_CD as relation_cd ,p.name_full_formatted as Attending, n.source_string as Admit_diagnosis from encounter e left outer join encntr_alias ea on (ea.encntr_id=e.encntr_id and ea.active_ind=1 and ea.encntr_alias_type_cd=91) left outer join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) left outer join encntr_alias ea1 on(ea1.encntr_id=e.encntr_id and ea1.active_ind =1 and ea1.encntr_alias_type_cd= 14865492 and ea1.end_effective_dt_tm >sysdate) left outer join  encntr_prsnl_reltn epr on(epr.encntr_id = e.encntr_id and epr.encntr_prsnl_r_cd =    3432.00 and epr.end_effective_dt_tm >sysdate) left outer join prsnl p on(p.person_id = epr.prsnl_person_id) left outer join diagnosis di on (di.encntr_id = e.encntr_id and di.active_ind=1 and di.active_status_cd=1623 and di.diag_type_cd = 39660.00 and di.beg_effective_dt_tm<=sysdate and ((di.end_effective_dt_tm>=sysdate) or (di.end_effective_dt_tm=null))) left outer join nomenclature n on (n.nomenclature_id=di.nomenclature_id and n.active_ind = 1 and n.end_effective_dt_tm > sysdate) left outer join EMRP_PERSON_PRSNL_ACTIVITY eppa on (eppa.person_id = e.person_id and eppa.prsnl_id = ?) where e.person_id=? and e.active_ind =1 and e.end_effective_dt_tm >sysdate  and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.active_ind=1 and por.end_effective_dt_tm >sysdate) order by e.reg_dt_tm desc

person.encounterWithOrgandDisch= select get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, case when to_char(e.reg_dt_tm,'HH24:MI') = '00:00' then to_char(e.reg_dt_tm,'MM/DD/YYYY') else to_char(e.reg_dt_tm,'MM/DD/YYYY HH24:MI') end as Reg_dt_tm, case when to_char(e.disch_dt_tm,'HH24:MI') = '00:00' then to_char(e.disch_dt_tm,'MM/DD/YYYY') else to_char(e.disch_dt_tm,'MM/DD/YYYY HH24:MI') end as Disch_dt_tm, get_cd_value(e.med_service_cd,'display') as Medical_service, get_cd_value(e.loc_facility_cd, 'display') as Facility, case when e.loc_room_cd>0 then case when e.loc_bed_cd>0 then concat(concat(concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display')),';'),get_cd_value(e.loc_bed_cd, 'display')) else (concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display'))) end else get_cd_value(e.loc_nurse_unit_cd, 'display') end as location, ea.alias as Acct,ap.format_mask as FIN_format, e.encntr_id as Encntr_id, get_cd_value(e.encntr_status_cd, 'display') as EncntrStatus, ea1.alias as ChartNum, eppa.PPR_CD as relation_cd from encounter e left outer join encntr_alias ea on (ea.encntr_id=e.encntr_id and ea.active_ind=1 and ea.encntr_alias_type_cd=91) left outer join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) left outer join encntr_alias ea1 on(ea1.encntr_id=e.encntr_id and ea1.active_ind =1 and ea1.encntr_alias_type_cd= 14865492 and ea1.end_effective_dt_tm >sysdate) left outer join EMRP_PERSON_PRSNL_ACTIVITY eppa on (eppa.person_id = e.person_id and eppa.prsnl_id = ?) where e.person_id=? and e.active_ind =1 and e.end_effective_dt_tm >sysdate and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.active_ind=1 and por.end_effective_dt_tm >sysdate) 

search.accByPagination= select * from (select a.*, rownum rnum from (select distinct p.name_full_formatted, p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, get_cd_value(p.SEX_CD, 'display') AS SEX, GET_MRNS(p.person_id) as MRNString, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, ap1.format_mask as SSN_format,paSSN.alias AS SSN, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from encntr_alias ea JOIN encounter e ON (ea.encntr_id=e.encntr_id and e.active_ind=1 and e.end_effective_dt_tm>sysdate) JOIN person p ON (e.person_id=p.person_id and p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222) LEFT OUTER join person_alias paSSN ON (paSSN.person_id=p.person_id and paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=p.person_id and a.parent_entity_name='PERSON' and a.active_ind=1  and a.address_type_cd = 288 and a.end_effective_dt_tm>sysdate) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where ea.active_ind=1 and ea.encntr_alias_type_cd=91 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.accByNoPagination= select distinct p.name_full_formatted, p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, get_cd_value(p.SEX_CD, 'display') AS SEX, GET_MRNS(p.person_id) as MRNString, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, ap1.format_mask as SSN_format,paSSN.alias AS SSN, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from encntr_alias ea JOIN encounter e ON (ea.encntr_id=e.encntr_id and e.active_ind=1 and e.end_effective_dt_tm>sysdate) JOIN person p ON (e.person_id=p.person_id and p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222) LEFT OUTER join person_alias paSSN ON (paSSN.person_id=p.person_id and paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=p.person_id and a.parent_entity_name='PERSON' and a.active_ind=1  and a.address_type_cd = 288 and a.end_effective_dt_tm>sysdate) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where ea.active_ind=1 and ea.encntr_alias_type_cd=91 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.accAndMRNByPagination= select * from (select a.*, rownum rnum from (select distinct p.name_full_formatted, p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, get_cd_value(p.SEX_CD, 'display') AS SEX, GET_MRNS(p.person_id) as MRNString, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, ap1.format_mask as SSN_format,paSSN.alias AS SSN, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from encntr_alias ea JOIN encounter e ON (ea.encntr_id=e.encntr_id and e.active_ind=1 and e.end_effective_dt_tm>sysdate) JOIN person p ON (e.person_id=p.person_id and p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222) LEFT OUTER join person_alias paMRN ON (paMRN.person_id=p.person_id and paMRN.active_ind=1 and paMRN.person_alias_type_cd=2328) LEFT OUTER join person_alias paSSN ON (paSSN.person_id=p.person_id and paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=p.person_id and a.parent_entity_name='PERSON' and a.active_ind=1  and a.address_type_cd = 288 and a.end_effective_dt_tm>sysdate) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where ea.active_ind=1 and ea.encntr_alias_type_cd=91 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.accAndMRNByNoPagination= select distinct p.name_full_formatted, p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, get_cd_value(p.SEX_CD, 'display') AS SEX, GET_MRNS(p.person_id) as MRNString, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, ap1.format_mask as SSN_format,paSSN.alias AS SSN, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from encntr_alias ea JOIN encounter e ON (ea.encntr_id=e.encntr_id and e.active_ind=1 and e.end_effective_dt_tm>sysdate) JOIN person p ON (e.person_id=p.person_id and p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222) LEFT OUTER join person_alias paMRN ON (paMRN.person_id=p.person_id and paMRN.active_ind=1 and paMRN.person_alias_type_cd=2328) LEFT OUTER join person_alias paSSN ON (paSSN.person_id=p.person_id and paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=p.person_id and a.parent_entity_name='PERSON' and a.active_ind=1  and a.address_type_cd = 288 and a.end_effective_dt_tm>sysdate) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where ea.active_ind=1 and ea.encntr_alias_type_cd=91 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.ssnByPagination= select * from (select a.*, rownum rnum from (select distinct p.name_full_formatted,p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, GET_MRNS(p.person_id) as MRNString, get_cd_value(p.SEX_CD, 'display') AS SEX, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, paSSN.alias AS SSN, ap1.format_mask as SSN_format, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from person_alias paSSN JOIN person p ON (p.person_id=paSSN.person_id and p.person_type_cd=222) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=paSSN.person_id and a.parent_entity_name='PERSON' and a.active_ind=1 and a.end_effective_dt_tm>sysdate and a.address_type_cd = 288) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate)  where paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.ssnByNoPagination= select distinct p.name_full_formatted,p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, GET_MRNS(p.person_id) as MRNString, get_cd_value(p.SEX_CD, 'display') AS SEX, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, paSSN.alias AS SSN, ap1.format_mask as SSN_format, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from person_alias paSSN JOIN person p ON (p.person_id=paSSN.person_id and p.person_type_cd=222) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=paSSN.person_id and a.parent_entity_name='PERSON' and a.active_ind=1 and a.end_effective_dt_tm>sysdate and a.address_type_cd = 288) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate)  where paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.ssnAndMRNByPagination= select * from (select a.*, rownum rnum from (select distinct p.name_full_formatted,p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, GET_MRNS(p.person_id) as MRNString, get_cd_value(p.SEX_CD, 'display') AS SEX, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, paSSN.alias AS SSN, ap1.format_mask as SSN_format, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from person_alias paSSN JOIN person p ON (p.person_id=paSSN.person_id and p.person_type_cd=222) LEFT OUTER join person_alias paMRN ON (paMRN.person_id=p.person_id and paMRN.active_ind=1 and paMRN.person_alias_type_cd=2328) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=paSSN.person_id and a.parent_entity_name='PERSON' and a.active_ind=1 and a.end_effective_dt_tm>sysdate and a.address_type_cd = 288) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.ssnAndMRNByNoPagination= select distinct p.name_full_formatted,p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, GET_MRNS(p.person_id) as MRNString, get_cd_value(p.SEX_CD, 'display') AS SEX, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, paSSN.alias AS SSN, ap1.format_mask as SSN_format, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from person_alias paSSN JOIN person p ON (p.person_id=paSSN.person_id and p.person_type_cd=222) LEFT OUTER join person_alias paMRN ON (paMRN.person_id=p.person_id and paMRN.active_ind=1 and paMRN.person_alias_type_cd=2328) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=paSSN.person_id and a.parent_entity_name='PERSON' and a.active_ind=1 and a.end_effective_dt_tm>sysdate and a.address_type_cd = 288) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.mrnByPagination= select * from (select a.*, rownum rnum from (select distinct p.name_full_formatted,p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, GET_MRNS(p.person_id) as MRNString, get_cd_value(p.SEX_CD, 'display') AS SEX, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, paSSN.alias AS SSN, ap1.format_mask as SSN_format, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from person_alias paMRN JOIN person p ON (paMRN.person_id=p.person_id and p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222) LEFT OUTER join person_alias paSSN ON (paSSN.person_id=p.person_id and paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=paMRN.person_id and a.parent_entity_name='PERSON' and a.active_ind=1 and a.end_effective_dt_tm>sysdate and a.address_type_cd = 288) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where paMRN.active_ind=1 and paMRN.person_alias_type_cd=2328 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.mrnByNoPagination= select distinct p.name_full_formatted,p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm, GET_MRNS(p.person_id) as MRNString, get_cd_value(p.SEX_CD, 'display') AS SEX, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, paSSN.alias AS SSN, ap1.format_mask as SSN_format, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from person_alias paMRN JOIN person p ON (paMRN.person_id=p.person_id and p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222) LEFT OUTER join person_alias paSSN ON (paSSN.person_id=p.person_id and paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=paMRN.person_id and a.parent_entity_name='PERSON' and a.active_ind=1 and a.end_effective_dt_tm>sysdate and a.address_type_cd = 288) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where paMRN.active_ind=1 and paMRN.person_alias_type_cd=2328 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.rowCountFromPerson= select count(distinct p.person_id) as rowcount from person p INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.rowCountByMRN= select count(distinct p.person_id) as rowcount from person_alias paMRN JOIN person p ON (paMRN.person_id=p.person_id and p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222) LEFT OUTER join person_alias paSSN ON (paSSN.person_id=p.person_id and paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where paMRN.active_ind=1 and paMRN.person_alias_type_cd=2328 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.rowCountBySSN= select count(distinct p.person_id) as rowcount from person_alias paSSN JOIN person p ON (paSSN.person_id=p.person_id and p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222) LEFT OUTER join person_alias paMRN ON (paMRN.person_id=p.person_id and paMRN.active_ind=1 and paMRN.person_alias_type_cd=2328) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

search.rowCountByACC= select count(distinct p.person_id) as rowcount from encntr_alias ea JOIN encounter e ON (ea.encntr_id=e.encntr_id and e.active_ind=1 and e.end_effective_dt_tm>sysdate) JOIN person p ON (e.person_id=p.person_id and p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222) LEFT OUTER join person_alias paMRN ON (paMRN.person_id=p.person_id and paMRN.active_ind=1 and paMRN.person_alias_type_cd=2328) LEFT OUTER join person_alias paSSN ON (paSSN.person_id=p.person_id and paSSN.active_ind=1 and paSSN.person_alias_type_cd=2334 and paSSN.alias_pool_cd=7091 and paSSN.end_effective_dt_tm > sysdate) INNER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = paSSN.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=p.person_id and a.parent_entity_name='PERSON' and a.active_ind=1  and a.address_type_cd = 288 and a.end_effective_dt_tm>sysdate) INNER JOIN person_alias pa3 on (pa3.person_id=p.person_id and pa3.active_ind=1 and pa3.person_alias_type_cd=2328) INNER JOIN alias_pool ap3 on (ap3.alias_pool_cd = pa3.alias_pool_cd and ap3.active_ind = 1 and ap3.end_effective_dt_tm > sysdate) where ea.active_ind=1 and ea.encntr_alias_type_cd=91 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

generalLaboratory= select ce.result_val, ce.result_status_cd, ce.event_class_cd, eesr.child_event_set_cd as mainseq, eesr.parent_event_set_cd as typecode, eesr.parent_event_set_name as type1, child_event_set_name  as Event1, get_cd_value(ce.result_status_cd, 'cdf_meaning') as prefixC, get_cd_value(ce.event_class_cd, 'cdf_meaning') as check_numeric, get_cd_value(ce.normalcy_cd, 'cdf_meaning') as check_normalcy,cen.ce_event_note_id as check_comments, ce.parent_event_id,ce.event_id, ce.event_cd, v.event_set_cd, get_cd_value(ce.result_status_cd, 'display') as Result_status, case when (ce.event_class_cd = 5235) then (case when (ce.result_val like '1:%') then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/',substr(ce.result_val,3,4))))) when (ce.result_val like '0:%')then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/', concat(substr(ce.result_val,3,4),concat(' ', concat(substr(ce.result_val,11,2),concat(':', substr(ce.result_val,13,2))))))))) when(ce.result_val like '2:%')then  concat(substr(ce.result_val,11,2),concat(':', substr(ce.result_val,13,2)))end) else (case when ce.event_tag is null then ce.result_val else ce.event_tag end) end as Resultval, to_char(ce.event_end_dt_tm,'MM/DD/YYYY HH24:MI') as eventdate, get_cd_value(ce.result_units_cd, 'display') as Unit, ce.normal_high as normal_high, ce.normal_low as normal_low, ce.critical_high as critical_high, ce.critical_low as critical_low, get_cd_value(ce.normalcy_cd, 'display') as Normalcy from emrp_event_set_reltn eesr join v500_event_set_explode v on (v.event_set_cd = eesr.child_event_set_cd) join clinical_event ce on (ce.event_cd = v.event_cd and ce.person_id=? and ce.event_end_dt_tm between to_date(?,'dd-mon-yyyy hh24:mi:ss') and to_date(?,'dd-mon-yyyy hh24:mi:ss') and ce.valid_until_dt_tm>sysdate and ce.view_level = 1 and ce.result_status_cd != 602 and ce.encntr_id in(select encntr_id from encounter e where e.person_id = ? and e.end_effective_dt_tm>sysdate and e.active_ind = 1 and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id =? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))) left outer join ce_event_note cen on (ce.event_id=cen.event_id and cen.valid_until_dt_tm>sysdate) where eesr.flowsheet_tab_event_set_cd= ? order by eesr.child_event_set_hierarchy_seq ,ce.event_end_dt_tm desc,ce.parent_event_id

immunizations= select ce.result_val, ce.result_status_cd, ce.event_class_cd, eesr.child_event_set_cd as mainseq, eesr.parent_event_set_cd as typecode, eesr.parent_event_set_name as type1, child_event_set_name  as Event1, get_cd_value(ce.result_status_cd, 'cdf_meaning') as prefixC, get_cd_value(ce.event_class_cd, 'cdf_meaning') as check_numeric, get_cd_value(ce.normalcy_cd, 'cdf_meaning') as check_normalcy,cen.ce_event_note_id as check_comments, ce.parent_event_id,ce.event_id, ce.event_cd, v.event_set_cd, get_cd_value(ce.result_status_cd, 'display') as Result_status, case when (ce.event_class_cd = 5235) then (case when (ce.result_val like '1:%') then concat(substr(ce.result_val,7,2), concat('/', concat(substr(ce.result_val,9,2),concat('/',substr(ce.result_val,3,4))))) when (ce.result_val like '0:%')then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2), concat('/', concat(substr(ce.result_val,3,4), concat(' ', concat(substr(ce.result_val,11,2), concat(':', substr(ce.result_val,13,2))))))))) when(ce.result_val like '2:%')then  concat(substr(ce.result_val,11,2),concat(':', substr(ce.result_val,13,2)))end) when (ce.event_class_cd in(525,529)) then ce.event_tag else (case when ce.event_tag is null then ce.result_val else ce.event_tag end) end as Resultval, to_char(ce.event_end_dt_tm,'MM/DD/YYYY HH24:MI') as eventdate, get_cd_value(ce.result_units_cd, 'display') as Unit, ce.normal_high as normal_high, ce.normal_low as normal_low, ce.critical_high as critical_high, ce.critical_low as critical_low, get_cd_value(ce.normalcy_cd, 'display') as Normalcy, case when (ce.normal_high is not null and ce.normal_high!=' ' and ce.normal_low is not null and ce.normal_low!=' ') then concat('[', concat(ce.normal_low, concat('-', concat(ce.normal_high, ']')))) else case when ce.normal_high is not null and ce.normal_high!=' ' and (ce.normal_low is null or ce.normal_low=' ') then concat('[',concat(ce.normal_high,']')) else case when (ce.normal_high is null or ce.normal_high=' ') and ce.normal_low is not null and ce.normal_low!=' ' then concat('[',concat(ce.normal_low,']')) else '' end end end as ref_range from emrp_event_set_reltn eesr join v500_event_set_explode v on (v.event_set_cd = eesr.child_event_set_cd) join clinical_event ce on (ce.event_cd = v.event_cd and ce.person_id = ? and ce.valid_until_dt_tm>sysdate and ce.view_level = 1 and ce.result_status_cd != 602 and ce.encntr_id in(select encntr_id from encounter e where e.person_id = ? and e.end_effective_dt_tm>sysdate and e.active_ind = 1 and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id = ? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))) left outer join ce_event_note cen on (ce.event_id=cen.event_id and cen.valid_until_dt_tm>sysdate) where eesr.flowsheet_tab_event_set_cd=? order by eesr.child_event_set_hierarchy_seq ,ce.event_end_dt_tm desc,ce.parent_event_id

generalLaboratoryWithEncntr= select ce.result_val, ce.result_status_cd, ce.event_class_cd, eesr.child_event_set_cd as mainseq, eesr.parent_event_set_cd as typecode, eesr.parent_event_set_name as type1, child_event_set_name  as Event1, get_cd_value(ce.result_status_cd, 'cdf_meaning') as prefixC, get_cd_value(ce.event_class_cd, 'cdf_meaning') as check_numeric, get_cd_value(ce.normalcy_cd, 'cdf_meaning') as check_normalcy,cen.ce_event_note_id as check_comments, ce.parent_event_id,ce.event_id, ce.event_cd, v.event_set_cd, get_cd_value(ce.result_status_cd, 'display') as Result_status, case when (ce.event_class_cd = 5235) then (case when (ce.result_val like '1:%') then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/',substr(ce.result_val,3,4))))) when (ce.result_val like '0:%')then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/', concat(substr(ce.result_val,3,4),concat(' ', concat(substr(ce.result_val,11,2),concat(':', substr(ce.result_val,13,2))))))))) when(ce.result_val like '2:%')then  concat(substr(ce.result_val,11,2),concat(':', substr(ce.result_val,13,2)))end) else (case when ce.event_tag is null then ce.result_val else ce.event_tag end) end as Resultval, to_char(ce.event_end_dt_tm,'MM/DD/YYYY HH24:MI') as eventdate, get_cd_value(ce.result_units_cd, 'display') as Unit, ce.normal_high as normal_high, ce.normal_low as normal_low, ce.critical_high as critical_high, ce.critical_low as critical_low, get_cd_value(ce.normalcy_cd, 'display') as Normalcy from emrp_event_set_reltn eesr join v500_event_set_explode v on (v.event_set_cd = eesr.child_event_set_cd) join clinical_event ce on (ce.event_cd = v.event_cd and ce.person_id=? and ce.valid_until_dt_tm>sysdate and ce.view_level = 1 and ce.result_status_cd != 602 and ce.encntr_id = ?) left outer join ce_event_note cen on (ce.event_id=cen.event_id and cen.valid_until_dt_tm>sysdate) where eesr.flowsheet_tab_event_set_cd=? order by eesr.child_event_set_hierarchy_seq ,ce.event_end_dt_tm desc,ce.parent_event_id

ordersWithEncntr= select get_cd_value(o1.dcp_clin_cat_cd, 'display') as order_grouping_disp, o1.dcp_clin_cat_cd as order_grouping_id, o1.order_id, o1.template_order_flag, o1.iv_ind, case when o1.med_order_type_cd = 14176.00 or o1.ingredient_ind=1 then o1.ordered_as_mnemonic when o1.hna_order_mnemonic = o1.ordered_as_mnemonic then to_char(get_cd_value(o1.catalog_cd, 'display')) else concat(concat(trim(o1.hna_order_mnemonic),'('),concat(trim(o1.ordered_as_mnemonic),')')) end as order_disp, get_cd_value(o1.ORDER_STATUS_CD, 'display') as order_status, o1.current_start_dt_tm, o1.clinical_display_line, o2.order_id as child_order_id, o2.template_order_id as child_template_order_id, case when o2.med_order_type_cd = 14176.00 or o2.ingredient_ind=1 then o2.ordered_as_mnemonic when o2.hna_order_mnemonic = o2.ordered_as_mnemonic then to_char(get_cd_value(o2.catalog_cd, 'display')) else concat(concat(trim(o2.hna_order_mnemonic),'('),concat(trim(o2.ordered_as_mnemonic),')')) end as child_order_disp, get_cd_value(o2.ORDER_STATUS_CD, 'display') as child_order_status, o2.clinical_display_line as child_clinical_display_line from orders o1 left outer join orders o2 on(o2.template_order_id = o1.order_id and o2.template_order_flag =2 and (o2.hide_flag = 0 or o2.hide_flag is NUll) and o2.encntr_id = ?) where o1.person_id = ? and o1.encntr_id = ? and o1.active_ind = 1 and o1.template_order_flag not in(2,3,4) and (o1.hide_flag = 0 or o1.hide_flag is NUll) order by order_grouping_disp, o1.dcp_clin_cat_cd, o1.current_start_dt_tm desc, o1.order_id,o2.template_order_id ,o2.current_start_dt_Tm desc

ordersWithDates= select get_cd_value(o1.dcp_clin_cat_cd, 'display') as order_grouping_disp ,o1.dcp_clin_cat_cd as order_grouping_id, o1.order_id, o1.template_order_flag, o1.iv_ind, case when o1.med_order_type_cd = 14176.00 or o1.ingredient_ind=1 then o1.ordered_as_mnemonic when o1.hna_order_mnemonic = o1.ordered_as_mnemonic then to_char(get_cd_value(o1.catalog_cd, 'display')) else concat(concat(trim(o1.hna_order_mnemonic),'('),concat(trim(o1.ordered_as_mnemonic),')')) end as order_disp, get_cd_value(o1.ORDER_STATUS_CD, 'display') as order_status, o1.current_start_dt_tm, o1.clinical_display_line, o2.order_id as child_order_id, o2.template_order_id as child_template_order_id, case when o2.med_order_type_cd = 14176.00 or o2.ingredient_ind=1 then o2.ordered_as_mnemonic when o2.hna_order_mnemonic = o2.ordered_as_mnemonic then to_char(get_cd_value(o2.catalog_cd, 'display')) else concat(concat(trim(o2.hna_order_mnemonic),'('),concat(trim(o2.ordered_as_mnemonic),')')) end as child_order_disp, get_cd_value(o2.ORDER_STATUS_CD, 'display') as child_order_status, o2.clinical_display_line as child_clinical_display_line from orders o1 left outer join orders o2 on(o2.template_order_id = o1.order_id and o2.template_order_flag =2 and (o2.hide_flag = 0 or o2.hide_flag is NUll)) where o1.person_id = ? and o1.current_start_dt_tm between to_date(?,'dd-mon-yyyy hh24:mi:ss') and to_date(?,'dd-mon-yyyy hh24:mi:ss') and o1.encntr_id in (select e.encntr_id from encounter e where e.person_id = ? and e.end_effective_dt_tm>sysdate and e.active_ind = 1 and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id = ? and por.end_effective_dt_tm >sysdate and por.active_ind = 1)) order by order_grouping_disp, o1.dcp_clin_cat_cd, o1.current_start_dt_tm desc, o1.order_id,o2.template_order_id ,o2.current_start_dt_Tm desc

folderMediaInquiry= select concat(get_cd_value(ict.lib_group_cd, 'display'), concat(' - ',get_cd_value(ict.lib_group_cd, 'description'))) as libgrp, ict.lib_group_cd as libgrpcd, f.parent_object_id as ParentObjId ,f.seq_object_id SeqobjId, i.filing_number as filingNo, get_cd_value(i.image_class_type_cd, 'display') as Folderno, i.volume as volume, get_cd_value(i.image_class_type_cd, 'description') as folderName, case when (t.loan_type_flag =0) then get_cd_value(t.tracking_point_cd, 'display') when(t.loan_type_flag =1)then  pr.name_full_formatted when (t.loan_type_flag =2)then bl.name when (t.loan_type_flag =3)then p.name_full_formatted end as CurrentLocation from folder f join trackable_object t on(t.seq_object_id = f.seq_object_id and t.active_ind = 1) join image_class i on(i.seq_object_id = t.seq_object_id) join image_class_type ict on(ict.image_class_type_cd = i.image_class_type_cd) left outer join borrower_lender bl on (bl.borrower_lender_id = t.tracking_point_cd) left outer join person p  on (p.person_id = t.tracking_point_cd) left outer join prsnl pr on(pr.person_id = t.tracking_point_cd) where f.person_id = ? order by libgrp, f.parent_object_id, i.image_class_type_cd, f.seq_object_id

ExamsUsingFolderId= select ocs.mnemonic as examname,fe.seq_object_id as SeqObjectId, fe.folder_id as FolderId, ord.accession as AccessionNbr, ed.order_id as OrderId, case when to_char(ed.complete_dt_tm,'HH24:MI') = '00:00' then to_char(ed.complete_dt_tm,'MM/DD/YYYY') else to_char(ed.complete_dt_tm,'MM/DD/YYYY HH24:MI') end as ExamDateTime, get_cd_value(ic.image_class_type_cd, 'display') as FolderNo, ic.volume as volume from film_exam fe join trackable_object t on(t.seq_object_id = fe.seq_object_id  and t.active_ind =1) join exam_data ed on(ed.seq_exam_id = fe.seq_exam_id) join encounter e on(e.encntr_id = ed.encntr_id) join trackable_object te on(te.seq_object_id = ed.seq_exam_id and te.active_ind = 1) left outer join order_radiology ord on (ord.order_id = ed.order_id) left outer join order_catalog_synonym ocs on(ocs.catalog_cd = ed.catalog_cd and ocs.mnemonic_type_cd = 1121.00) left outer join image_class ic on(ic.seq_object_id =fe.folder_id) where fe.folder_id = ? order by ed.complete_dt_tm desc

problem= select distinct case when n.SOURCE_STRING is null then pb.PROBLEM_FTDESC else n.SOURCE_STRING end as source_string, n.source_identifier as Code, p.name_full_formatted as Responsible_provider, pb.PROBLEM_ID as ProblemId, to_char(pb.ONSET_DT_TM, 'MM/DD/YYYY') as Onsetdate, to_char(pb.actual_resolution_dt_tm, 'MM/DD/YYYY HH24:MI') as resolution_date, pb.ACTIVE_IND, get_cd_value(pb.LIFE_CYCLE_STATUS_CD, 'display') as status , get_cd_value(pb.classification_cd, 'display') as Classification from problem pb left OUTER JOIN nomenclature n on(n.nomenclature_id = pb.nomenclature_id) left outer join problem_prsnl_r ppr on(ppr.problem_id = pb.problem_id and ppr.problem_reltn_cd = 1415 and ppr.active_ind = 1 and ppr.end_effective_dt_tm > sysdate) left outer join prsnl p on(p.person_id = ppr.problem_reltn_prsnl_id ) where pb.PERSON_ID=? and pb.ACTIVE_IND=1 and pb.LIFE_CYCLE_STATUS_CD in(1394,1397) and pb.end_effective_dt_tm > sysdate order by lower(source_string)

allergy= select a.allergy_id, get_cd_value(a.reaction_class_cd, 'display') as Type, case when n.SOURCE_STRING is null then a.substance_ftdesc else n.source_string end as SubstanceString, case when n1.SOURCE_STRING is null then r.REACTION_FTDESC else n1.source_string end as ReactionSourceString, get_cd_value(a.SEVERITY_CD, 'display') as severity, get_cd_value(a.SUBSTANCE_TYPE_CD, 'display') as Category , get_cd_value(A.REACTION_STATUS_CD, 'display') as reaction_status, get_cd_value(A.SOURCE_OF_INFO_CD, 'display') as source, concat(get_cd_value(A.onset_precision_cd, 'display'), concat(' ',to_char(a.onset_dt_tm,'MM/DD/YYYY'))) as onset_disp, concat(to_char(a.updt_dt_tm, 'MM/DD/YYYY'), concat(' ',p.name_full_formatted)) as updated_by, to_char(a.reviewed_dt_tm,'MM/DD/YYYY HH24:MI') as Reviewed, AC.ALLERGY_COMMENT as comment_text, AC.COMMENT_DT_TM as comment_dt_tm, p1.name_full_formatted as comment_prsnl from allergy a left outer join nomenclature n on( n.nomenclature_id = a.substance_nom_id) left outer join prsnl p on (P.PERSON_ID=A.updt_id) left outer join REACTION r on(r.allergy_id =a.allergy_id and r.active_ind =1 and r.end_effective_dt_tm >sysdate) left outer join nomenclature n1 on( n1.nomenclature_id = r.REACTION_NOM_ID) left outer join allergy_comment ac on (AC.ALLERGY_ID=A.ALLERGY_Id AND AC.BEG_EFFECTIVE_DT_TM<=sysdate AND AC.END_EFFECTIVE_DT_TM>sysdate) left outer join prsnl p1 on (p1.person_id = ac.COMMENT_PRSNL_ID) where a.person_id=? and a.active_ind = 1 order by lower(SubstanceString)

allergyActive= select a.allergy_id, get_cd_value(a.reaction_class_cd, 'display') as Type, case when n.SOURCE_STRING is null then a.substance_ftdesc else n.source_string end as SubstanceString, case when n1.SOURCE_STRING is null then r.REACTION_FTDESC else n1.source_string end as ReactionSourceString, get_cd_value(a.SEVERITY_CD, 'display') as severity, get_cd_value(a.SUBSTANCE_TYPE_CD, 'display') as Category , get_cd_value(A.REACTION_STATUS_CD, 'display') as reaction_status, get_cd_value(A.SOURCE_OF_INFO_CD, 'display') as source, concat(get_cd_value(A.onset_precision_cd, 'display'), concat(' ',to_char(a.onset_dt_tm,'MM/DD/YYYY'))) as onset_disp, concat(to_char(a.updt_dt_tm, 'MM/DD/YYYY'), concat(' ',p.name_full_formatted)) as updated_by, to_char(a.reviewed_dt_tm,'MM/DD/YYYY HH24:MI') as Reviewed, AC.ALLERGY_COMMENT as comment_text, AC.COMMENT_DT_TM as comment_dt_tm, p1.name_full_formatted as comment_prsnl from allergy a left outer join nomenclature n on( n.nomenclature_id = a.substance_nom_id) left outer join prsnl p on (P.PERSON_ID=A.updt_id) left outer join REACTION r on(r.allergy_id =a.allergy_id and r.active_ind =1 and r.end_effective_dt_tm >sysdate) left outer join nomenclature n1 on( n1.nomenclature_id = r.REACTION_NOM_ID) left outer join allergy_comment ac on (AC.ALLERGY_ID=A.ALLERGY_Id AND AC.BEG_EFFECTIVE_DT_TM<=sysdate AND AC.END_EFFECTIVE_DT_TM>sysdate) left outer join prsnl p1 on (p1.person_id = ac.COMMENT_PRSNL_ID) where a.person_id=? and a.active_ind = 1 and a.reaction_status_cd =1392 order by lower(SubstanceString)

allergyHistory= SELECT a.person_id,a.allergy_instance_id, SUBSTANCE_NOM_ID, case when a.SOURCE_OF_INFO_CD>0 then get_cd_value(A.SOURCE_OF_INFO_CD, 'display') else a.source_of_info_ft end as INFO_SOURCE, case when a.SUBSTANCE_NOM_ID>0 then N.SOURCE_STRING else a.SUBSTANCE_FTDESC end as substance, get_cd_value(a.SUBSTANCE_TYPE_CD, 'display') as Category, get_cd_value(a.reaction_class_cd, 'display') as reaction_Type, get_cd_value(a.SEVERITY_CD, 'display') as severity, concat(get_cd_value(A.onset_precision_cd, 'display'), concat(' ',to_char(a.onset_dt_tm,'MM/DD/YYYY'))) as onset_disp, get_cd_value(A.REACTION_STATUS_CD, 'display') as reaction_status, to_char(a.reviewed_dt_tm,'MM/DD/YYYY HH24:MI') as Reviewed_date, to_char(a.BEG_EFFECTIVE_DT_TM,'MM/DD/YYYY HH24:MI') as orig_date, concat(' ',p.name_full_formatted) as updated_by, get_cd_value(A.CANCEL_REASON_CD, 'display') as CancelReason,  concat(' ',p2.name_full_formatted) as reviewedPrsnl,concat(' ',p3.name_full_formatted) as orig_prsnl, concat(' ',p5.name_full_formatted) as combine_prsnl, concat(' ',p6.name_full_formatted) as combine_patient, a.cmb_flag from allergy a left outer join nomenclature n on n.NOMENCLATURE_ID=a.SUBSTANCE_NOM_ID left outer join prsnl p on (P.PERSON_ID=A.updt_id) left outer join prsnl p1 on (P1.person_id = a.created_prsnl_id) left outer join prsnl p2 on (P2.person_id = a.reviewed_prsnl_id) left outer join prsnl p3 on (P3.person_id = a.orig_prsnl_id) left outer join prsnl p5 on (P5.person_id = a.CMB_PRSNL_ID) left outer join person p6 on (P6.person_id = a.CMB_PERSON_ID) WHERE (A.ALLERGY_ID= ?) order by A.BEG_EFFECTIVE_DT_TM desc, A.ALLERGY_INSTANCE_ID

allergyHistoryReaction= select R.ALLERGY_INSTANCE_ID, REACTION_NOM_ID, case when (R.REACTION_NOM_ID>0) then N.SOURCE_STRING ELSE   R.REACTION_FTDESC end as REACTION_STRING, R.BEG_EFFECTIVE_DT_TM, R.UPDT_DT_TM, concat(' ',p1.name_full_formatted) as  update_prsnl, R.ACTIVE_IND, concat(' ',p2.name_full_formatted) CMB_PRSNL_NAME, concat(' ',p.name_full_formatted) CMB_PERSON_NAME, R.CMB_DT_TM, R.END_EFFECTIVE_DT_TM from  ALLERGY A ,REACTION R LEFT outer join NOMENCLATURE N on N.NOMENCLATURE_ID=R.REACTION_NOM_ID LEFT outer join PERSON  P on P.PERSON_ID=R.CMB_PERSON_ID LEFT outer join PRSNL  P1 on P1.PERSON_ID=R.UPDT_ID LEFT outer join PRSNL P2 on P2.PERSON_ID=R.CMB_PRSNL_ID WHERE A.ALLERGY_ID= ? and  R.ALLERGY_INSTANCE_ID=A.ALLERGY_INSTANCE_ID order by BEG_EFFECTIVE_DT_TM,  REACTION_ID

allergyHistoryComment= SELECT AC.ALLERGY_INSTANCE_ID, AC.ALLERGY_COMMENT_ID, AC.ALLERGY_COMMENT, AC.COMMENT_DT_TM,AC.BEG_EFFECTIVE_DT_TM, AC.UPDT_DT_TM, AC.UPDT_ID, concat(' ',p7.name_full_formatted) as UPDT_PRSNL_NAME, AC.ACTIVE_IND, AC.CMB_COMMENT_ID, AC.CMB_FLAG, AC.CMB_PRSNL_ID,  concat(' ',p8.name_full_formatted) as CMB_PRSNL_NAME, AC.CMB_PERSON_ID, concat(' ',p.name_full_formatted) as CMB_PERSON_NAME, AC.CMB_DT_TM FROM ALLERGY A JOIN ALLERGY_COMMENT  AC on  (AC.ALLERGY_ID=A.ALLERGY_ID ) LEFT OUTER JOIN  PRSNL  P7 on P7.PERSON_ID=AC.UPDT_ID LEFT OUTER JOIN  PRSNL  P8  on P8.PERSON_ID=AC.CMB_PRSNL_ID LEFT OUTER JOIN  PERSON P on P.PERSON_ID=AC.CMB_PERSON_ID WHERE A.ALLERGY_ID= ?    and A.BEG_EFFECTIVE_DT_TM <=sysdate and A.END_EFFECTIVE_DT_TM>=sysdate order by  BEG_EFFECTIVE_DT_TM, ALLERGY_COMMENT_ID 

Result= select c.EVENT_ID,case when c.event_tag is null then c.result_val else c.event_tag end as value,to_char(c.VALID_FROM_DT_TM, 'MM/DD/YYYY HH24:MI') as validFrom,   to_char(c.VALID_UNTIL_DT_TM, 'MM/DD/YYYY HH24:MI') as validUntil, get_cd_value(c.EVENT_CD, 'description') as EventDisplay, get_cd_value(c.RESULT_UNITS_CD, 'display') as ResultUnit, get_cd_value(c.CONTRIBUTOR_SYSTEM_CD, 'display') as ContributorSystem, get_cd_value(c.RESULT_STATUS_CD, 'display') as ResultStatus, to_char(c.EVENT_END_DT_TM, 'Month DD , YYYY HH24:MI') as EndTime,c.normal_high as normal_high, c.normal_low as normal_low, get_cd_value(c.normalcy_cd, 'display') as Normalcy, c.accession_nbr as Accession_Number, c.critical_low as CriticalLow ,c.critical_high as CriticalHigh from CLINICAL_EVENT c where c.event_id=? and c.view_level = 1 and c.valid_from_dt_tm > = to_date(?,'MM/dd/yyyy hh24:mi:ss') and c.valid_until_dt_tm < = to_date(? ,'MM/dd/yyyy hh24:mi:ss')

DateResult= select c.EVENT_ID,c.RESULT_VAL as value,to_char(c.VALID_FROM_DT_TM, 'MM/DD/YYYY HH24:MI') as validFrom, to_char(c.VALID_UNTIL_DT_TM, 'MM/DD/YYYY HH24:MI') as validUntil, get_cd_value(c.EVENT_CD, 'description') as EventDisplay, get_cd_value(c.RESULT_UNITS_CD, 'display') as ResultUnit, get_cd_value(c.CONTRIBUTOR_SYSTEM_CD, 'display') as ContributorSystem, get_cd_value(c.RESULT_STATUS_CD, 'display') as ResultStatus, to_char(c.EVENT_END_DT_TM, 'Month DD , YYYY HH24:MI') as EndTime, c.normal_high as normal_high, c.normal_low as normal_low, get_cd_value(c.normalcy_cd, 'display') as Normalcy, c.accession_nbr as Accession_Number, c.critical_low as CriticalLow ,c.critical_high as CriticalHigh, to_char(cdr.result_dt_tm, 'MM/DD/YYYY HH24:MI') as result_dt_tm, cdr.date_type_flag from CLINICAL_EVENT c join ce_date_result cdr on(cdr.event_id = c.event_id and cdr.valid_until_dt_tm >sysdate) where c.event_id=? and c.VALID_UNTIL_DT_TM >sysdate and c.view_level = 1

GroupResults= select c.event_tag as ResultDisplay ,c.event_id ,to_char(c.event_end_dt_tm, 'Day, Month DD, YYYY HH24:MI') as ResultDateTime,c.REFERENCE_NBR, get_cd_value(c.contributor_system_cd, 'display') as ContributorSystem, get_cd_value(c.result_status_cd, 'display') as ResultStatus, ce.event_id as parent_event_id ,ce.event_tag as parent_event_tag, ce1.event_class_cd, ce1.event_id as child_event_id, ce1.event_tag as child_event_tag, get_cd_value(ce1.result_units_cd, 'display') as child_result_unit, case when ce1.event_class_cd=5235 then (case when (ce1.result_val like '1:%') then concat(substr(ce1.result_val,7,2),concat('/', concat(substr(ce1.result_val,9,2),concat('/',substr(ce1.result_val,3,4))))) when (ce1.result_val like '0:%')then concat(substr(ce1.result_val,7,2),concat('/', concat(substr(ce1.result_val,9,2),concat('/', concat(substr(ce1.result_val,3,4),concat(' ', concat(substr(ce1.result_val,11,2),concat(':', substr(ce1.result_val,13,2))))))))) when(ce1.result_val like '2:%')then  concat(substr(ce1.result_val,11,2),concat(':', substr(ce1.result_val,13,2)))end) else ce1.result_val end as child_result_val from clinical_event c join clinical_event ce on (ce.parent_event_id = c.event_id and ce.valid_until_dt_tm>sysdate) join clinical_event ce1 on(ce1.parent_event_id = ce.event_id and ce1.valid_until_dt_tm>sysdate) where c.event_id = ? order by ce.event_id, ce1.event_id

ActionList= select cp1.ce_event_prsnl_id, cp1.event_prsnl_id, cp1.event_id, case when(cp1.action_type_cd in (634, 626)) then 1 when(cp1.action_type_cd = 625)then 3 else 4 end as sortorder, get_cd_value(cp1.ACTION_TYPE_CD, 'display') as action, to_char(cp1.ACTION_DT_TM, 'MM/DD/YYYY HH24:MI:SS') as ACTION_DT_TM, to_char (cp1.valid_from_dt_tm, 'MM/DD/YYYY HH24:MI:SS') as valid_from_dt_tm, case when p1.name_full is null then pr.name_full_formatted else p1.name_full end as performedBy, pr.name_full_formatted as AlernatePerformedby from clinical_event c join ce_event_prsnl cp1 on (((cp1.event_id = c.parent_event_id and cp1.action_type_cd in (625.00, 624)) or (cp1.event_id = c.event_id)) and cp1.valid_until_dt_tm >sysdate) left outer join prsnl pr on(pr.person_id =  cp1.action_prsnl_id) left outer join person_name p1 on (p1.person_id = cp1.action_prsnl_id and p1.name_type_cd = 16027279 and p1.beg_effective_dt_tm <=cp1.action_dt_tm and p1.end_effective_dt_tm >=cp1.action_dt_tm and p1.active_ind = 1) where c.event_id=? and c.view_level=1 and c.valid_until_dt_tm>sysdate order by action, cp1.action_dt_tm, sortorder, cp1.event_prsnl_id desc, cp1.valid_from_dt_tm desc

ActionListWithDates= select pr.person_id,cp1.ce_event_prsnl_id ,cp1.event_prsnl_id,cp1.event_id,case when(cp1.action_type_cd in (634, 626)) then 1 when(cp1.action_type_cd = 625)then 3 else 4 end as sortorder,  get_cd_value(cp1.ACTION_TYPE_CD, 'display') as action,to_char(cp1.ACTION_DT_TM, 'MM/DD/YYYY HH24:MI:SS') as ACTION_DT_TM, to_char (cp1.valid_from_dt_tm, 'MM/DD/YYYY HH24:MI:SS') as valid_from_dt_tm, case when p1.name_full is null then pr.name_full_formatted else p1.name_full end as performedBy,  pr.name_full_formatted as AlernatePerformedby from clinical_event c  join ce_event_prsnl cp1 on (((cp1.event_id = c.parent_event_id and cp1.action_type_cd in (625.00, 624)) or (cp1.event_id = c.event_id))  and cp1.valid_from_dt_tm < = to_date(?,'MM/dd/yyyy hh24:mi:ss') and cp1.valid_until_dt_tm >= to_date(?, 'MM/dd/yyyy hh24:mi:ss')) left outer join prsnl pr on(pr.person_id =  cp1.action_prsnl_id) left outer join person_name p1 on (p1.person_id = pr.person_id and p1.name_type_cd = 16027279 and p1.beg_effective_dt_tm <=cp1.action_dt_tm and p1.end_effective_dt_tm >=cp1.action_dt_tm and p1.active_ind = 1) where c.event_id=? and c.view_level=1 and c.valid_until_dt_tm >sysdate order by cp1.action_dt_tm, sortorder, cp1.valid_from_dt_tm desc

Specimen= select cs.EVENT_ID, cs.source_text as Source, get_cd_value(cs.SOURCE_TYPE_CD, 'display') as sourceType, p.name_full_formatted as collectedBy, case when cs.collect_dt_tm is not null then concat(to_char(cs.collect_dt_tm, 'Month DD, YYYY'), concat(' at ', to_char(cs.collect_dt_tm, 'HH24:MI'))) else to_char(cs.collect_dt_tm, 'Month DD, YYYY HH24:MI') end as collectedOn, get_cd_value(cs.COLLECT_PRIORITY_CD, 'display') as collectionPriority from clinical_event ce join ce_specimen_coll cs on (cs.event_id = ce.parent_event_id) left outer join prsnl p on (p.person_id = cs.collect_prsnl_id) where ce.event_id=? and ce.VALID_UNTIL_DT_TM > sysdate

comments= select case when c.importance_flag=1 then 'Low Importance' when c.importance_flag=2 then 'Medium Importance' when c.importance_flag>2 then 'High Importance' else 'Not Applicable' end as importanceFlag, get_cd_value(c.NOTE_TYPE_CD, 'display') as noteType, c.COMPRESSION_CD, lb.blob_length, lb.LONG_BLOB, to_char(c.note_dt_tm,'Month DD, YYYY HH24:MI') as commentDate, p.NAME_FULL_FORMATTED as Prsnl from ce_event_note c left outer join long_blob lb on(lb.parent_entity_id = c.ce_event_note_id and lb.parent_entity_name = 'CE_EVENT_NOTE') left outer join prsnl p on(p.person_id = c.note_prsnl_id) where c.event_id=? and c.note_type_cd in (5871,5875)

diagnosis= select di.diagnosis_id as diagnosisId, di.diagnosis_display as annotatedDisplay, to_char(di.diag_dt_tm, 'MM/DD/YYYY') as diagnosisDateAndTime, get_cd_value(di.CONFIRMATION_STATUS_CD, 'display') as confirmation, get_cd_value(di.CLASSIFICATION_CD, 'display') as classification, get_cd_value(di.diag_type_cd, 'display') as Diag_type, di.diag_ftdesc as diagFtDesc, n.source_string as sourceString, n.source_identifier as code, n.source_vocabulary_cd as vocabulary from diagnosis di join nomenclature n on (n.nomenclature_id=di.nomenclature_id) where di.person_id=? and di.active_ind=1 and di.active_status_cd=1623 and di.diagnosis_group!=0 and di.beg_effective_dt_tm<=sysdate and ((di.end_effective_dt_tm>=sysdate) or (di.end_effective_dt_tm=null)) order by di.diag_dt_tm desc

diagnosisWithEncntr= select di.diagnosis_id as diagnosisId, di.diagnosis_display as annotatedDisplay, to_char(di.diag_dt_tm, 'MM/DD/YYYY') as diagnosisDateAndTime, get_cd_value(di.CONFIRMATION_STATUS_CD, 'display') as confirmation, get_cd_value(di.CLASSIFICATION_CD, 'display') as classification, get_cd_value(di.diag_type_cd, 'display') as Diag_type, case when n.source_string is null then di.diag_ftdesc else n.source_string end sourceString, n.source_identifier as code, n.source_vocabulary_cd as vocabulary from diagnosis di join nomenclature n on (n.nomenclature_id=di.nomenclature_id) where di.person_id=? and di.encntr_id = ? and di.active_ind=1 and di.active_status_cd=1623 and di.diagnosis_group!=0 and di.beg_effective_dt_tm<=sysdate and ((di.end_effective_dt_tm>=sysdate) or (di.end_effective_dt_tm=null)) order by di.diag_dt_tm desc

diagnosisWithDates= select di.diagnosis_id as diagnosisId, di.diagnosis_display as annotatedDisplay, to_char(di.diag_dt_tm, 'MM/DD/YYYY') as diagnosisDateAndTime, get_cd_value(di.CONFIRMATION_STATUS_CD, 'display') as confirmation, get_cd_value(di.CLASSIFICATION_CD, 'display') as classification, get_cd_value(di.diag_type_cd, 'display') as Diag_type, case when n.source_string is null then di.diag_ftdesc else n.source_string end sourceString, n.source_identifier as code, get_cd_value(n.source_vocabulary_cd, 'display') as vocabulary from diagnosis di join nomenclature n on (n.nomenclature_id=di.nomenclature_id) where di.person_id=? and di.diag_dt_tm between to_date(?,'dd-mon-yyyy hh24:mi:ss') and to_date(?,'dd-mon-yyyy hh24:mi:ss') and di.active_ind=1 and di.active_status_cd=1623 and di.diagnosis_group!=0 and di.beg_effective_dt_tm<=sysdate and ((di.end_effective_dt_tm>=sysdate) or (di.end_effective_dt_tm=null)) order by di.diag_dt_tm desc

popup.immunization= select c.event_reltn_cd,c.EVENT_ID,case when (cmr.iv_event_cd > 0) then get_cd_value(cmr.iv_event_cd, 'display') else get_cd_value(c.EVENT_CD, 'display') end as event_title_text, c.event_tag, get_cd_value(c.RESULT_UNITS_CD, 'display') as units,  to_char(c.EVENT_END_DT_TM, 'Month DD, YYYY "at" HH24:MI') as Given_on, get_cd_value(cmr.admin_route_cd, 'display') as Route, get_cd_value(c.event_class_cd, 'display') as EventClass, get_cd_value(cen.NOTE_TYPE_CD, 'display') as noteType, cen.COMPRESSION_CD, cen.ENTRY_METHOD_CD, lb.LONG_BLOB as Reason_for_med, to_char(cen.note_dt_tm,'MM/DD/YYYY HH24:MI') as Note_Date ,p.NAME_FULL_FORMATTED as Note_Prsnl, get_cd_value(c.result_status_cd, 'display') as result_status, get_cd_value(cmr.admin_site_cd, 'display') as site,  p1.name_full_formatted as given_by, get_cd_value(cmr.SUBSTANCE_MANUFACTURER_CD, 'display') as manufacturer, to_char(cmr.SUBSTANCE_EXP_DT_TM, 'Month DD, YYYY') as   SUBSTANCE_EXP_DT_TM,cmr.SUBSTANCE_LOT_NUMBER,cmr.admin_note , cmr1.infusion_rate, get_cd_value(cmr1.infusion_unit_cd, 'display') as infusion_rate_unit,cmr.initial_volume, get_cd_value(cmr.infused_volume_unit_cd, 'display') as volume_unit, to_char(mae.scheduled_dt_tm ,'Month DD, YYYY HH24:MI') as Schedule_on from CLINICAL_EVENT c left outer join ce_med_result cmr on (cmr.event_id = c.event_id and cmr.valid_until_dt_tm > sysdate) left outer join ce_med_result cmr1 on (cmr1.event_id = c.parent_event_id and cmr1.valid_until_dt_tm > sysdate) left outer join med_admin_event mae on(mae.event_id = c.event_id) left outer join ce_event_note cen on (cen.event_id = c.event_id and cen.valid_until_dt_tm > sysdate and cen.note_type_cd = 16022961.00) left outer join long_blob lb on(lb.parent_entity_id = cen.ce_event_note_id and lb.parent_entity_name = 'CE_EVENT_NOTE') left outer join prsnl p on(p.person_id = cen.note_prsnl_id) left outer join prsnl p1 on (p1.person_id = cmr.admin_prov_id) where c.event_id=? and c.view_level = 1 and c.valid_from_dt_tm > = to_date(?,'MM/dd/yyyy hh24:mi:ss') and c.valid_until_dt_tm < = to_date(?,'MM/dd/yyyy hh24:mi:ss')

PrescriptionList= select case when o1.orig_ord_as_flag = 2 then 'Hx' else 'Rx' end as Label, case when o1.order_status_cd = 1088 then 1 else 2 end as sort_order, case when o1.order_status_cd = 1088 then 'Current' else 'Past' end as Category,o1.encntr_id, case when o1.med_order_type_cd = 14176.00 or o1.ingredient_ind=1 then o1.ordered_as_mnemonic when o1.hna_order_mnemonic = o1.ordered_as_mnemonic then get_cd_value(o1.catalog_cd, 'display') else concat(concat(trim(o1.hna_order_mnemonic),'('),concat(trim(o1.ordered_as_mnemonic),')')) end as order_disp, get_cd_value(o1.ORDER_STATUS_CD, 'display') as orderstatus, o1.current_start_dt_tm, o1.order_id,o1.clinical_display_line from orders o1 where o1.person_id = ? and o1.catalog_type_cd = 2605 and o1.activity_type_cd =5059 and o1.template_order_id = 0.0 and o1.active_ind=1 and o1.prescription_order_id = 0.0 and o1.cs_flag !=1 and o1.orig_ord_as_flag in(1,2) and o1.order_status_cd not in (14857626.00) order by sort_order,o1.current_start_dt_tm desc

PrescriptionListWithEncntr= select case when o1.orig_ord_as_flag = 2 then 'Hx' else 'Rx' end as Label, case when o1.order_status_cd = 1088 then 1 else 2 end as sort_order, case when o1.order_status_cd = 1088 then 'Current' else 'Past' end as Category,o1.encntr_id, case when o1.med_order_type_cd = 14176.00 or o1.ingredient_ind=1 then o1.ordered_as_mnemonic when o1.hna_order_mnemonic = o1.ordered_as_mnemonic then get_cd_value(o1.catalog_cd, 'display') else concat(concat(trim(o1.hna_order_mnemonic),'('),concat(trim(o1.ordered_as_mnemonic),')')) end as order_disp, get_cd_value(o1.ORDER_STATUS_CD, 'display') as orderstatus, o1.current_start_dt_tm, o1.order_id,o1.clinical_display_line from orders o1 where o1.person_id = ? and o1.encntr_id=? and o1.catalog_type_cd = 2605 and o1.activity_type_cd =5059 and o1.template_order_id = 0.0 and o1.active_ind=1 and o1.prescription_order_id = 0.0 and o1.cs_flag !=1 and o1.orig_ord_as_flag in(1,2) and o1.order_status_cd not in (14857626.00) order by sort_order,o1.current_start_dt_tm desc

MAROPOrderList= select case when o1.med_order_type_cd = 14176.00 or o1.ingredient_ind=1 then o1.ordered_as_mnemonic when o1.hna_order_mnemonic = o1.ordered_as_mnemonic then to_char(o1.catalog_cd) else concat(concat(trim(o1.hna_order_mnemonic),'('),concat(trim(o1.ordered_as_mnemonic),')')) end as order_disp, get_cd_value(o1.ORDER_STATUS_CD, 'display') as orderstatus, o1.current_start_dt_tm, o1.order_id,o1.clinical_display_line from orders o1 where o1.person_id=? and o1.current_start_dt_tm between to_date(?,'dd-mon-yyyy hh24:mi:ss') and to_date(?,'dd-mon-yyyy hh24:mi:ss') and o1.encntr_id in (select e.encntr_id from encounter e where e.person_id = ? and e.end_effective_dt_tm>sysdate and e.active_ind = 1 and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id = ? and por.end_effective_dt_tm >sysdate and por.active_ind = 1)) and o1.catalog_type_cd = 2605 and o1.activity_type_cd =5059 and o1.template_order_id = 0.0 and o1.active_ind=1 and o1.prescription_order_id = 0.0 and o1.cs_flag !=1 and o1.orig_ord_as_flag in (1,2)

MAROPOrderListByEncntr= select o1.encntr_id,case when o1.med_order_type_cd = 14176.00 or o1.ingredient_ind=1 then o1.ordered_as_mnemonic when o1.hna_order_mnemonic = o1.ordered_as_mnemonic then to_char(o1.catalog_cd) else concat(concat(trim(o1.hna_order_mnemonic),'('),concat(trim(o1.ordered_as_mnemonic),')')) end as order_disp, get_cd_value(o1.ORDER_STATUS_CD, 'display') as orderstatus, o1.current_start_dt_tm, o1.order_id,o1.clinical_display_line from orders o1 where o1.person_id = ? and o1.encntr_id = ? and o1.catalog_type_cd = 2605 and o1.activity_type_cd =5059 and o1.template_order_id = 0.0 and o1.active_ind=1 and o1.prescription_order_id = 0.0 and o1.cs_flag !=1 and o1.orig_ord_as_flag in (1,2)

MAROPOrderDetails= select ofm.label_text ,ofm.oe_format_id,ofm.action_type_cd,od.oe_field_display_value, oi.hna_order_mnemonic, oi.ordered_as_mnemonic, case when oi.ordered_as_mnemonic is not null then concat(oi.hna_order_mnemonic, concat(' (', concat(oi.ordered_as_mnemonic, ')'))) else oi.hna_order_mnemonic end as orderMneminic, oi.order_detail_display_line as ingredient from order_detail od join orders o on (o.order_id = od.order_id) join OE_FORMAT_FIELDS ofm on (ofm.oe_field_id = od.oe_field_id and OFm.OE_FORMAT_ID=O.OE_FORMAT_ID and ofm.action_type_cd in (SELECT case when O.ORIG_ORD_AS_FLAG in (1, 2) then 15471629.00 else 1078 end as ORIG_ORD_AS_FLAG FROM ORDERS O WHERE O.ORDER_ID = ?)) left outer join order_ingredient oi on (oi.order_id = od.order_id  and oi.action_sequence = od.action_sequence and (oi.ingredient_type_flag = 0 or oi.ingredient_type_flag is null)) where od.order_id = ? and OD.OE_FIELD_MEANING_ID!=125 AND OD.OE_FIELD_MEANING_ID!=2071 AND OD.OE_FIELD_MEANING_ID!=2094 and od.action_sequence = (select max(od1.action_sequence) from order_detail od1 where od1.order_id = od.order_id and od1.oe_field_meaning_id = od.oe_field_meaning_id) order by od.detail_sequence

MAROPOrderHistory= select oa.action_sequence, get_cd_value(o.catalog_type_cd, 'display') as Department, o.HNA_ORDER_MNEMONIC, o.ORDERED_AS_MNEMONIC, o.person_id, o.orig_ord_as_flag, case when oa.action_type_cd in (1079.00, 4570.00, 15471633.00, 4572.00) then get_cd_value(ORIG_ORD_AS_FLAG, 'display') else get_cd_value(oa.action_type_cd, 'display') end as action_type_cd, get_cd_value(oa.dept_status_cd, 'display') as dept_status_cd, get_cd_value(oa.communication_type_cd, 'display') as communication_type_cd, get_cd_value(oa.order_status_cd, 'display')  as Order_status, p.name_full_formatted as action_prsnl, p1.name_full_formatted as order_prsnl, to_char(oa.action_dt_tm, 'MM/DD/YYYY HH24:MI') as action_dt_tm, to_char(oa.order_dt_tm, 'MM/DD/YYYY "at" HH24:MI') as order_dt_tm, ofm.label_text, case when emrp_to_date(od.oe_field_display_value, 'MM/DD/YY HH24:MI:SS') is not null then to_char(emrp_to_date(od.oe_field_display_value, 'MM/DD/YY HH24:MI:SS'), 'MM/DD/YYYY HH24:MI') else od.oe_field_display_value end as oe_field_display_value, case when oi.ordered_as_mnemonic is not null then concat(oi.hna_order_mnemonic, concat(' (', concat(oi.ordered_as_mnemonic, ')'))) else oi.hna_order_mnemonic end as orderMnemonic, oi.order_detail_display_line as ingredient, oi.action_sequence, oi.comp_sequence from order_action oa join orders o on(o.order_id = oa.order_id) join prsnl p on(p.person_id = oa.action_personnel_id) join prsnl p1 on (p1.person_id = oa.order_provider_id) left outer join order_detail od on (od.order_id = oa.order_id and od.action_sequence = oa.action_sequence AND OD.OE_FIELD_MEANING_ID!=125 AND OD.OE_FIELD_MEANING_ID!=2071 AND OD.OE_FIELD_MEANING_ID!=2094) left outer join OE_FORMAT_FIELDS ofm on (ofm.oe_field_id = od.oe_field_id and OFm.OE_FORMAT_ID=O.OE_FORMAT_ID and ofm.action_type_cd in (SELECT case when O.ORIG_ORD_AS_FLAG in (1, 2) then 15471629.00 else 1078 end as ORIG_ORD_AS_FLAG FROM ORDERS O WHERE O.ORDER_ID = ?)) left outer join order_ingredient oi on (oi.order_id = oa.order_id and oi.action_sequence = oa.action_sequence and (oi.ingredient_type_flag = 0 or oi.ingredient_type_flag is null)) where oa.order_id = ? AND (OA.ACTION_TYPE_CD!= 1077 OR (OA.CORE_IND in (case when (SELECT OA1.CORE_IND FROM ORDER_ACTION OA1 WHERE OA1.ORDER_ID= ? AND OA1.ACTION_TYPE_CD=1078) is not null then (SELECT OA1.CORE_IND FROM ORDER_ACTION OA1 WHERE OA1.ORDER_ID= ? AND OA1.ACTION_TYPE_CD=1078) else 0 end) OR OA.CORE_IND= NULL)) order by OA.ACTION_SEQUENCE, OD.DETAIL_SEQUENCE, OI.COMP_SEQUENCE

OrderHistoryValidations= select o.order_id, o.action_sequence, o.provider_id, to_char(o.review_dt_tm,'MM/DD/YYYY "at" HH24:MI') as Review_date, p.name_full_formatted as review_prsnl, case when o.provider_id = 0 then p1.name_full_formatted else p2.name_full_formatted end as Review_provider, o.review_reqd_ind, o.review_sequence, o.review_type_flag, o.reviewed_status_flag, get_cd_value(o.location_cd, 'display') as routed_to_location from order_review o left outer join prsnl p on (o.review_personnel_id = p.person_id) left outer join order_action oa on (o.order_id = oa.order_id and o.action_sequence=oa.action_sequence) left outer join prsnl p1 on (oa.order_provider_id = p1.person_id) left outer join prsnl p2 on (p2.person_id = o.provider_id) where o.order_id = ? and o.review_sequence in (select max(o1.review_sequence) from order_review o1 where o1.order_id=o.order_id and o1.review_type_flag=o.review_type_flag and o1.action_sequence=o.action_sequence) order by o.action_sequence

MAROPOrderAddInfo= SELECT PR.NAME_FULL_FORMATTED as ActionPrsnl, to_char(OA.ACTION_DT_TM, 'MM/DD/YYYY "at" HH24:MI') as ActionDate, to_char(oa.order_dt_tm, 'MM/DD/YYYY "at" HH24:MI') as order_dt_tm, get_cd_value(o.catalog_type_cd, 'display') as department, get_cd_value(oa.COMMUNICATION_TYPE_CD, 'display') as COMMUNICATION_TYPE, P.NAME_FULL_FORMATTED as OrderingPrsnl, case when O.ordered_as_mnemonic is not null then concat(O.hna_order_mnemonic, concat(' (', concat(O.ordered_as_mnemonic, ')'))) else O.hna_order_mnemonic end as orderMnemonic, O.ORDERED_AS_MNEMONIC as OrderedAs, to_char(O.CURRENT_START_DT_TM, 'MM/DD/YYYY HH24:MI') as Start_Date, to_char(O.PROJECTED_STOP_DT_TM, 'MM/DD/YYYY HH24:MI') as StopDate, O.ORDER_ID FROM ORDERS O join ORDER_ACTION OA on (oa.order_id = o.order_id) join PRSNL P on (p.person_id = OA.ORDER_PROVIDER_ID) join PRSNL PR on (pr.person_id = OA.ACTION_PERSONNEL_ID) WHERE o.order_id = ? and oa.action_type_cd= 1078 and oa.action_sequence = 1

MAROPOrderComments= SELECT get_cd_value(OC.COMMENT_TYPE_CD, 'display') as COMMENT_TYPE, oc.comment_type_cd, to_char(OC.UPDT_DT_TM, 'MM/DD/YYYY HH24:MI') as CommentDate, P.NAME_FULL_FORMATTED as CommentPrsnl, L.LONG_TEXT FROM ORDER_COMMENT OC join LONG_TEXT L on (L.LONG_TEXT_ID = OC.LONG_TEXT_ID) join PRSNL P on (P.PERSON_ID = OC.UPDT_ID) WHERE OC.ORDER_ID = ? order by oc.action_sequence desc

marIPReports= select case when o.hna_order_mnemonic = o.ordered_as_mnemonic then lower(trim(get_cd_value(o.catalog_cd, 'display'))) else lower(concat(concat(trim(o.hna_order_mnemonic),' ('), concat(trim(o.ordered_as_mnemonic),')'))) end as order_disp, case when o.hna_order_mnemonic = o.ordered_as_mnemonic then trim(get_cd_value(o.catalog_cd, 'display')) else  concat(concat(trim(o.hna_order_mnemonic),'('),concat(trim(o.ordered_as_mnemonic),')')) end as order_disp1, o.order_id,o.clinical_display_line, ce.event_id, ce.event_class_cd, case when (ce.event_class_cd in(525,529)) then ce.event_tag else case when (ce.result_status_cd = 1545) then ce.event_tag else concat(get_cd_value(ce.event_cd, 'display'),concat(': ',concat(ce.event_tag,concat(' ',get_cd_value(ce.result_units_cd, 'display')))))end end as event_tag,  to_char(ce.event_end_dt_tm, 'MM/DD/YYYY HH24:MI') as eventDate from orders o  left outer join(ce_event_order_link ceol join clinical_event ce on (ce.event_id = ceol.event_id and ce.event_end_dt_tm between to_date(?,'dd-mon-yyyy hh24:mi:ss') and to_date(?,'dd-mon-yyyy hh24:mi:ss') and ce.view_level = 1 and ce.event_reltn_cd != 582 and ce.result_status_cd != 606 and ce.valid_until_dt_tm >sysdate  and ce.entry_mode_cd in (53421967.00, 660790947.00, 105673428.00, 796770388.00, 53421963.00)))  on (ceol.parent_order_ident = o.order_id) where o.person_id=? and o.encntr_id in(select e.encntr_id from encounter e where e.person_id=? and e.end_effective_dt_tm>sysdate and e.active_ind = 1 and ((e.reg_dt_tm between to_date(?,'dd-mon-yyyy hh24:mi:ss') and to_date(?,'dd-mon-yyyy hh24:mi:ss')) or (e.disch_dt_tm between to_date(?,'dd-mon-yyyy hh24:mi:ss') and to_date(?,'dd-mon-yyyy hh24:mi:ss')) or (e.reg_dt_tm <=to_date(?,'dd-mon-yyyy') and e.disch_dt_tm >=to_date(?,'dd-mon-yyyy'))) and e.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id = ? and por.end_effective_dt_tm >sysdate and por.active_ind = 1)) and o.catalog_type_cd = 2605.00 and o.orig_ord_as_flag = 0 and o.template_order_id = 0 and o.order_status_cd != 1083.00 and o.projected_stop_dt_Tm >= to_date(?,'dd-mon-yyyy') order by order_disp, o.order_id, ce.event_end_dt_tm desc 

marIPReportsByEncntr= select case when o.hna_order_mnemonic = o.ordered_as_mnemonic then lower(trim(get_cd_value(o.catalog_cd, 'display'))) else lower(concat(concat(trim(o.hna_order_mnemonic),' ('), concat(trim(o.ordered_as_mnemonic),')'))) end as order_disp, case when (o.hna_order_mnemonic = o.ordered_as_mnemonic) then trim(get_cd_value(o.catalog_cd, 'display')) else concat(concat(trim(o.hna_order_mnemonic),'('),concat(trim(o.ordered_as_mnemonic),')')) end as order_disp1, o.order_id, o.clinical_display_line, ce.event_id, ce.event_class_cd, case when (ce.event_class_cd in(525,529)) then ce.event_tag else case when (ce.result_status_cd = 1545) then ce.event_tag else concat(get_cd_value(ce.event_cd, 'display') ,concat(': ',concat(ce.event_tag,concat(' ', get_cd_value(ce.result_units_cd, 'display')))))end end as event_tag, to_char(ce.event_end_dt_tm, 'MM/DD/YYYY HH24:MI') as eventDate from orders o left outer join (ce_event_order_link ceol join clinical_event ce on (ce.event_id = ceol.event_id and ce.encntr_id = ? and ce.view_level = 1 and ce.event_reltn_cd != 582 and ce.result_status_cd != 606 and ce.valid_until_dt_tm >sysdate  and ce.entry_mode_cd in (53421967.00, 660790947.00, 105673428.00, 796770388.00, 53421963.00))) on (ceol.parent_order_ident = o.order_id) where o.person_id = ? and o.encntr_id = ? and o.catalog_type_cd = 2605.00 and o.orig_ord_as_flag = 0 and o.template_order_id = 0 and o.order_status_cd != 1083.00 order by order_disp, o.order_id, ce.event_end_dt_tm desc

userPosition= select code_value as position_cd, display as position FROM CODE_VALUE WHERE CODE_SET=88 AND ACTIVE_IND=1 order by position

##manage.searchUser= select concat(e.name_last_key,concat(', ',concat(e.name_first_key,concat(' ', e.name_middle_key)))) as name_full_formatted, e.prsnl_id, e.employee_id, lower(e.username) as username, cv.display as position, e.position_cd, e.active_ind, e.name_first_key, e.name_last_key, e.name_middle_key, e.email, to_char(e.birth_dt_tm, 'MM/DD/YYYY') as birth_dt_tm, to_char(e.begin_dt_tm, 'MM/DD/YYYY') as begin_date, to_char(e.end_dt_tm, 'MM/DD/YYYY') as end_date, e.physician_ind, e.admin_ind, e.auditor_ind, e.him_ind, case when e.active_ind = 1 then 'Active' else 'Inactive' end as status, e.updt_cnt, e.reset_pswd, case when sysdate>e.end_dt_tm then 'Invalid' else 'Valid' end as userStatus from emrp_users e left outer join code_value cv on (cv.code_value=e.position_cd and cv.code_set=88) where

manage.searchUser= select concat(e.name_last_key,concat(', ',concat(e.name_first_key,concat(' ', e.name_middle_key)))) as name_full_formatted, e.prsnl_id, e.employee_id, lower(e.username) as username, cv.display as position, e.position_cd, e.active_ind, e.name_first_key, e.name_last_key, e.name_middle_key, e.email, to_char(e.birth_dt_tm, 'MM/DD/YYYY') as birth_dt_tm, to_char(e.begin_dt_tm, 'MM/DD/YYYY') as begin_date, to_char(e.end_dt_tm, 'MM/DD/YYYY') as end_date, e.physician_ind, e.admin_ind, e.auditor_ind, e.him_ind, case when e.active_ind = 1 then 'Active' else 'Inactive' end as status, e.updt_cnt, e.reset_pswd, case when sysdate>e.end_dt_tm then 'Invalid' else 'Valid' end as userStatus, case when e.auditor_ind=1 then (select count(*) as cnt from EMRP_AUDITOR_ENCNTR_RELTN aer where aer.prsnl_id=e.prsnl_id and aer.active_ind=1) else 0 end as auditorEncntrs from emrp_users e left outer join code_value cv on (cv.code_value=e.position_cd and cv.code_set=88) where

manage.searchUserRows= select count(e.prsnl_id) as rowcount from emrp_users e where 

manage.searchUserByPagination= select * from (select a.*, rownum rnum from (select concat(e.name_last_key,concat(', ',concat(e.name_first_key,concat(' ', e.name_middle_key)))) as name_full_formatted, e.prsnl_id, e.employee_id, lower(e.username) as username, cv.display as position, e.position_cd, e.active_ind, e.name_first_key, e.name_last_key, e.name_middle_key, e.email, to_char(e.birth_dt_tm, 'MM/DD/YYYY') as birth_dt_tm, to_char(e.begin_dt_tm, 'MM/DD/YYYY') as begin_date, to_char(e.end_dt_tm, 'MM/DD/YYYY') as end_date, e.physician_ind, e.admin_ind, e.auditor_ind, e.him_ind, case when e.active_ind = 1 then 'Active' else 'Inactive' end as status, e.updt_cnt, e.reset_pswd, case when sysdate>e.end_dt_tm then 'Invalid' else 'Valid' end as userStatus, case when e.auditor_ind=1 then (select count(*) as cnt from EMRP_AUDITOR_ENCNTR_RELTN aer where aer.prsnl_id=e.prsnl_id and aer.active_ind=1) else 0 end as auditorEncntrs from emrp_users e left outer join code_value cv on (cv.code_value=e.position_cd and cv.code_set=88) where

manage.searchUserCentric= select e.name_full_formatted, e.prsnl_id, e.username, e.position, e.position_cd, e.active_ind, e.status from emrp_users_view e where

manage.searchUserCentricRows= select count(e.prsnl_id) as rowcount from emrp_users_view e where 

manage.searchUserCentricByPagination= select * from (select a.*, rownum rnum from (select e.name_full_formatted, e.prsnl_id, e.username, e.position, e.position_cd, e.active_ind, e.status from emrp_users_view e where

manage.getCodeValueWithCDF= select code_value from code_value where active_ind=1 and code_set=? and cdf_meaning=?

manage.getCodeValueWithDisplay= select code_value from code_value where active_ind=1 and code_set=? and display=?

manage.getCodeValueWithDisplayKey= select code_value from code_value where active_ind=1 and code_set=? and display_key=?

manage.CheckIfExist= select e.username, e.email, e.employee_id as employeeId from emrp_users e where e.username=upper(?)

manage.CheckIfExistForUpdate= select e.username as username, e.employee_id as employeeId from emrp_users e where

manage.addUserInPerson= insert into person (PERSON_ID, CREATE_DT_TM, CREATE_PRSNL_ID, PERSON_TYPE_CD, NAME_LAST_KEY, NAME_FIRST_KEY , NAME_FULL_FORMATTED, AUTOPSY_CD, BIRTH_DT_CD, BIRTH_DT_TM, CONCEPTION_DT_TM, CAUSE_OF_DEATH, DECEASED_CD, DECEASED_DT_TM, ETHNIC_GRP_CD, LANGUAGE_CD, MARITAL_TYPE_CD, PURGE_OPTION_CD, RACE_CD, RELIGION_CD, SEX_CD, SEX_AGE_CHANGE_IND, CONTRIBUTOR_SYSTEM_CD, LANGUAGE_DIALECT_CD, NAME_LAST, NAME_FIRST, NAME_PHONETIC, LAST_ENCNTR_DT_TM, SPECIES_CD, CONFID_LEVEL_CD, VIP_CD, NAME_FIRST_SYNONYM_ID, CITIZENSHIP_CD, VET_MILITARY_STATUS_CD, MOTHER_MAIDEN_NAME, NATIONALITY_CD, FT_ENTITY_NAME, FT_ENTITY_ID, NAME_MIDDLE_KEY, NAME_MIDDLE, MILITARY_RANK_CD, MILITARY_SERVICE_CD, MILITARY_BASE_LOCATION, DECEASED_SOURCE_CD, DATA_STATUS_CD, DATA_STATUS_DT_TM, DATA_STATUS_PRSNL_ID, BEG_EFFECTIVE_DT_TM, END_EFFECTIVE_DT_TM, ACTIVE_IND, ACTIVE_STATUS_CD, ACTIVE_STATUS_PRSNL_ID, ACTIVE_STATUS_DT_TM, UPDT_CNT, LAST_ACCESSED_DT_TM, UPDT_DT_TM, UPDT_ID, UPDT_APPLCTX, UPDT_TASK, CAUSE_OF_DEATH_CD, NAME_FIRST_PHONETIC, NAME_LAST_PHONETIC, BIRTH_TZ, BIRTH_PREC_FLAG, ABS_BIRTH_DT_TM, DECEASED_ID_METHOD_CD, LOGICAL_DOMAIN_ID, ARCHIVE_ENV_ID, ARCHIVE_STATUS_CD, AGE_AT_DEATH, AGE_AT_DEATH_UNIT_CD, AGE_AT_DEATH_PREC_MOD_FLAG, DECEASED_TZ, DECEASED_DT_TM_PREC_FLAG, PERSON_STATUS_CD) values (seq_person.nextval,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SOUNDEX(?),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,SOUNDEX(?),SOUNDEX(?),?,?,?,?,?,?,?,?,?,?,?,?,?)

getGeneratedId= select seq_person.currval from dual

manage.addUserInPrsnl= insert into prsnl (PERSON_ID, PRSNL_TYPE_CD, NAME_LAST_KEY, NAME_FIRST_KEY, NAME_LAST, NAME_FIRST, NAME_FULL_FORMATTED, PASSWORD, EMAIL, POSITION_CD, USERNAME, PHYSICIAN_IND, ACTIVE_IND, ACTIVE_STATUS_CD, ACTIVE_STATUS_PRSNL_ID, ACTIVE_STATUS_DT_TM, DATA_STATUS_CD, DATA_STATUS_DT_TM, DATA_STATUS_PRSNL_ID, CREATE_PRSNL_ID, CREATE_DT_TM, BEG_EFFECTIVE_DT_TM, END_EFFECTIVE_DT_TM, PRIM_ASSIGN_LOC_CD, UPDT_DT_TM, UPDT_ID, UPDT_TASK, UPDT_APPLCTX, UPDT_CNT, LOGICAL_DOMAIN_ID, DEPARTMENT_CD, FREE_TEXT_IND, SECTION_CD, CONTRIBUTOR_SYSTEM_CD, FT_ENTITY_ID, PHYSICIAN_STATUS_CD, LOGICAL_DOMAIN_GRP_ID) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,?,?,?,?,?,?,?,?)

manage.checkForEmployeeId= select p.alias from prsnl_alias p where p.alias=? and p.active_ind=1 and p.prsnl_alias_type_cd=?

manage.addUserPrsnlAlias= insert into prsnl_alias (PRSNL_ALIAS_ID, PERSON_ID, ALIAS_POOL_CD, PRSNL_ALIAS_TYPE_CD, ALIAS, DATA_STATUS_CD, DATA_STATUS_DT_TM, DATA_STATUS_PRSNL_ID, ACTIVE_IND, BEG_EFFECTIVE_DT_TM, END_EFFECTIVE_DT_TM, ACTIVE_STATUS_CD, ACTIVE_STATUS_DT_TM, ACTIVE_STATUS_PRSNL_ID, UPDT_CNT, UPDT_TASK, UPDT_ID, UPDT_DT_TM, UPDT_APPLCTX, PRSNL_ALIAS_SUB_TYPE_CD, CHECK_DIGIT_METHOD_CD, CONTRIBUTOR_SYSTEM_CD) values (seq_prsnl_alias.nextval,?,?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?)

manage.addUserPersonName= insert into person_name (PERSON_NAME_ID, PERSON_ID, NAME_TYPE_CD, UPDT_CNT, UPDT_DT_TM, UPDT_ID, UPDT_TASK, UPDT_APPLCTX, ACTIVE_IND, ACTIVE_STATUS_CD, ACTIVE_STATUS_DT_TM, ACTIVE_STATUS_PRSNL_ID, BEG_EFFECTIVE_DT_TM, END_EFFECTIVE_DT_TM, NAME_ORIGINAL, NAME_FORMAT_CD, NAME_FULL, NAME_FIRST, NAME_MIDDLE, NAME_LAST, NAME_DEGREE, NAME_TITLE, NAME_PREFIX, NAME_SUFFIX, NAME_INITIALS, DATA_STATUS_CD, DATA_STATUS_DT_TM, DATA_STATUS_PRSNL_ID, CONTRIBUTOR_SYSTEM_CD, NAME_FIRST_KEY, NAME_FIRST_KEY_NLS, NAME_LAST_KEY, NAME_LAST_KEY_NLS, NAME_MIDDLE_KEY, NAME_MIDDLE_KEY_NLS, SOURCE_IDENTIFIER, NAME_TYPE_SEQ) values (seq_person_name.nextval,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,?,?,?,?,?,?)

manage.addUserPhone= insert into phone (PHONE_ID, PARENT_ENTITY_NAME, PARENT_ENTITY_ID, PHONE_TYPE_CD, UPDT_CNT, UPDT_DT_TM, UPDT_ID, UPDT_TASK, UPDT_APPLCTX, ACTIVE_IND, ACTIVE_STATUS_CD, ACTIVE_STATUS_DT_TM, ACTIVE_STATUS_PRSNL_ID, PHONE_FORMAT_CD, PHONE_NUM, PHONE_TYPE_SEQ, DESCRIPTION, CONTACT, CALL_INSTRUCTION, MODEM_CAPABILITY_CD, EXTENSION, PAGING_CODE, BEG_EFFECTIVE_DT_TM, END_EFFECTIVE_DT_TM, DATA_STATUS_CD, DATA_STATUS_DT_TM, DATA_STATUS_PRSNL_ID, BEG_EFFECTIVE_MM_DD, END_EFFECTIVE_MM_DD, CONTRIBUTOR_SYSTEM_CD, OPERATION_HOURS, LONG_TEXT_ID, SOURCE_IDENTIFIER, CONTACT_METHOD_CD) values (seq_phone.nextval,?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,?,?,?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,?,?,?,?)

manage.addUserPersonAlias= insert into person_alias (PERSON_ALIAS_ID, PERSON_ID, UPDT_CNT, UPDT_DT_TM, UPDT_ID, UPDT_TASK, UPDT_APPLCTX, ACTIVE_IND, ACTIVE_STATUS_CD, ACTIVE_STATUS_PRSNL_ID, ALIAS_POOL_CD, PERSON_ALIAS_TYPE_CD, ALIAS, PERSON_ALIAS_SUB_TYPE_CD, CHECK_DIGIT, CHECK_DIGIT_METHOD_CD, DATA_STATUS_CD, DATA_STATUS_PRSNL_ID, CONTRIBUTOR_SYSTEM_CD, VISIT_SEQ_NBR, HEALTH_CARD_PROVINCE, HEALTH_CARD_VER_CODE, ASSIGN_AUTHORITY_SYS_CD, HEALTH_CARD_TYPE, PERSON_ALIAS_STATUS_CD, ACTIVE_STATUS_DT_TM, BEG_EFFECTIVE_DT_TM, DATA_STATUS_DT_TM, END_EFFECTIVE_DT_TM, HEALTH_CARD_EXPIRY_DT_TM, HEALTH_CARD_ISSUE_DT_TM) values (seq_person_alias.nextval,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'))

manage.addUserEmrpUsers= insert into emrp_users (prsnl_id, username, password, name_first_key, name_last_key, name_middle_key, updt_cnt, admin_ind, physician_ind, login_status, active_ind, him_ind, auditor_ind, position_cd, updt_dt_tm, updt_id, employee_id, begin_dt_tm, end_dt_tm, email, birth_dt_tm, reset_pswd, acc_created_dt_tm) values (emrp_users_seq.nextval, upper(?), ?, upper(?), upper(?), upper(?), 0, ?, ?, 0, 1, ?, ?, ?, sysdate, ?, ?, to_date(?,'MM/dd/yyyy hh24:mi:ss'), to_date(?,'MM/dd/yyyy hh24:mi:ss'), ?, to_date(?,'MM/dd/yyyy'), 1, sysdate)

manage.getGeneratedUserId= select emrp_users_seq.currval from dual

manage.getUserName= select username from emrp_users where prsnl_id=?

manage.updateUserPerson= update person set

manage.updateUserPrsnl= update prsnl set

manage.updateUserPrsnlAlias= update prsnl_alias set

manage.updateUserPersonName= update person_name set

manage.updateUserPhone= update phone set

manage.updateUserPersonAlias= update person_alias set

manage.updateUserEmrpUsers= update emrp_users set

manage.assignOrgsInsert= insert into emrp_prsnl_org_reltn (PRSNL_ORG_RELTN_ID, PERSON_ID, ORGANIZATION_ID, UPDT_CNT, UPDT_DT_TM, UPDT_ID, UPDT_TASK, UPDT_APPLCTX, ACTIVE_IND, ACTIVE_STATUS_CD, ACTIVE_STATUS_DT_TM, ACTIVE_STATUS_PRSNL_ID, BEG_EFFECTIVE_DT_TM, END_EFFECTIVE_DT_TM, CONFID_LEVEL_CD) values (emrp_prsnl_org_reltn_seq.nextval,?,?,0,sysdate,?,1,1,1,?,sysdate,?,sysdate,to_date('12/31/2100 00:00:00','MM/DD/YYYY HH24:MI:SS'),0)

manage.assignOrgsUpdate= update emrp_prsnl_org_reltn set END_EFFECTIVE_DT_TM=sysdate, UPDT_CNT=UPDT_CNT+1, updt_id=? where PERSON_ID=? and ORGANIZATION_ID=? and end_effective_dt_tm>sysdate

manage.checkIfExistAssignOrg= select * from emrp_prsnl_org_reltn where person_id=? and organization_id=?

manage.assignOrgsUpdateIfExist= update emrp_prsnl_org_reltn set END_EFFECTIVE_DT_TM=to_date(?,'MM/DD/YYYY HH24:MI:SS'), UPDT_CNT=UPDT_CNT+1, updt_id=? where PERSON_ID=? and ORGANIZATION_ID=?

manage.assignedOrganizations= select o.organization_id as assignedId, o.org_name as assignedName from emrp_prsnl_org_reltn por join organization o on (o.organization_id = por.organization_id and o.active_ind = 1 and o.end_effective_dt_tm >sysdate) where por.person_id=? and por.end_effective_dt_tm >sysdate order by lower(o.org_name)

manage.availableOrganizations= select o.organization_id as availableId, o.org_name as availableName from org_type_reltn otr join organization o on (o.organization_id = otr.organization_id and o.active_ind = 1 and o.end_effective_dt_tm >sysdate and o.organization_id not in (select organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate)) where otr.org_type_cd = 254.00 and otr.end_effective_dt_tm >sysdate order by lower(o.org_name)

manage.availableOrgGroups= select o1.name as available_group_name, o1.org_set_id as available_group_id from org_set_type_r o, org_set o1 where o.org_set_type_cd in (176661921.00, 53421744.00) and o.active_ind = 1 and o1.org_set_id = o.org_set_id and o1.active_ind = 1 and o1.end_effective_dt_tm > sysdate and o1.org_set_id not in (Select o2.org_set_id from emrp_org_set_prsnl_r osp, org_set o2 where osp.prsnl_id = ? and osp.active_ind =1 and osp.end_effective_dt_tm > sysdate and o2.org_set_id = osp.org_set_id and o2.active_ind = 1 and o2.end_effective_dt_tm > sysdate) order by o1.name

manage.assignedOrgGroups= select o.org_set_id as assigned_group_id, o1.name as assigned_group_name from emrp_org_set_prsnl_r o, org_set o1 where o.prsnl_id = ? and o.active_ind =1	and o.end_effective_dt_tm > sysdate	and o1.org_set_id = o.org_set_id and o1.active_ind = 1 and o1.end_effective_dt_tm > sysdate order by o1.name

manage.assignOrgGroupUpdate= update emrp_org_set_prsnl_r set end_effective_dt_tm=sysdate, updt_cnt=updt_cnt+1, updt_id=?, updt_dt_tm=sysdate where ORG_SET_ID=? and prsnl_id=? and ACTIVE_IND=1 and END_EFFECTIVE_DT_TM>sysdate

manage.assignOrgGroupInsert= insert into emrp_org_set_prsnl_r (EMRP_ORG_SET_PRSNL_R_ID, ORG_SET_ID, PRSNL_ID, ORG_SET_TYPE_CD, ACTIVE_IND, ACTIVE_STATUS_CD, ACTIVE_STATUS_DT_TM, ACTIVE_STATUS_PRSNL_ID, BEG_EFFECTIVE_DT_TM, END_EFFECTIVE_DT_TM, UPDT_DT_TM, UPDT_APPLCTX, UPDT_ID, UPDT_CNT, UPDT_TASK) values (EMRP_ORG_SET_PRSNL_R_SEQ.nextval, ?, ?, 53421744.00, 1, 1623, sysdate, ?, sysdate, to_date('12/31/2100 00:00:00','MM/DD/YYYY HH24:MI:SS'), sysdate, 0, ?, 0, 0)

manage.assignOrgUpdateWithGroup= update emrp_prsnl_org_reltn set end_effective_dt_tm=sysdate, updt_cnt = updt_cnt+1, updt_id=?, updt_dt_tm=sysdate where person_id=? and active_ind=1 and end_effective_dt_tm>sysdate and organization_id in (select organization_id from org_set_org_r where org_set_id=? and active_ind=1 and end_effective_dt_tm>sysdate)

manage.assignOrgInsertWithGroup= insert into emrp_prsnl_org_reltn (PRSNL_ORG_RELTN_ID, PERSON_ID, ORGANIZATION_ID, UPDT_CNT, UPDT_DT_TM, UPDT_ID, UPDT_TASK, UPDT_APPLCTX, ACTIVE_IND, ACTIVE_STATUS_CD, ACTIVE_STATUS_DT_TM, ACTIVE_STATUS_PRSNL_ID, BEG_EFFECTIVE_DT_TM, END_EFFECTIVE_DT_TM, CONFID_LEVEL_CD) select (emrp_prsnl_org_reltn_seq.nextval), ?, organization_id, 0, sysdate, ?, 0, 0, 1, 1623, sysdate, ?, sysdate, to_date('12/31/2100 00:00:00','MM/DD/YYYY HH24:MI:SS'), 0 from org_set_org_r where org_set_id=? and active_ind=1 and end_effective_dt_tm>sysdate and organization_id not in (select e.organization_id from emrp_prsnl_org_reltn e where e.person_id=? and e.active_ind=1 and e.end_effective_dt_tm>sysdate)

manage.assignedRelationships= select e.reltn_cd as assignedId, get_cd_value(e.reltn_cd, 'display') as assignedName from emrp_pos_reltn_maint e where e.pos_cd=? and e.active_ind=1 order by assignedName asc

manage.availableRelationships= select c.code_value as availableId, c.display as availableName from code_value c where c.code_set = 333 and c.active_ind = 1 and c.code_value not in (select e.reltn_cd from emrp_pos_reltn_maint e where e.pos_cd=? and active_ind=1) order by c.display

manage.posReltnInsert= insert into emrp_pos_reltn_maint (emrp_pos_reltn_maint_id, pos_cd, reltn_cd, updt_cnt, updt_id, active_ind) values (emrp_pos_reltn_maint_seq.nextval, ?, ?, 0, ?, 1)

manage.posReltnUpdate= update emrp_pos_reltn_maint set active_ind=?, updt_cnt=updt_cnt+1, updt_id=? where pos_cd=? and reltn_cd=?

manage.checkIfExistPosReltn= select * from emrp_pos_reltn_maint where pos_cd=? and reltn_cd=?

manage.detailsUsingUserId= select name_first_key, name_last_key, employee_id, prsnl_id from emrp_users where prsnl_id=?

manage.resetPassword= update emrp_users set password=?, updt_cnt=updt_cnt+1, reset_pswd=1, updt_id=?, updt_dt_tm=sysdate where prsnl_id=?

phoneTypes= select code_value as phoneTypeCode, display as phoneType from code_value where code_set=43 and active_ind=1

flowsheet.dynamicTabList= select p.customer_id as clientid, p.customer_name as clientname, p.parent_tab_id as parentid, p.tab_sequence as parentSeq, p.parent_tab_name as parentname, p.tab_sequence as parentseq, p.event_set_cd as parentEventSetCode, p.event_set_name as parentEventSetName, p.status as status, c.child_tab_id as childId, c.child_tab_sequence as childTabSeq, c.child_tab_name as childName, c.child_tab_sequence as childSeq, c.child_event_set_cd as childEventSetCode, c.child_event_set_name as childEventSetName from parent_tabs p left outer join child_tabs c on (c.parent_tab_id=p.parent_tab_id) where p.status=1 order by p.tab_sequence, c.child_tab_sequence

flowsheet.parentTabList= select tab_id as tabid, tab_sequence as tabSeq, tab_name as tabname, event_set_name as eventsetname, event_set_cd as eventsetcode, parent_tab_id as parentTabId from emrp_dynamic_tabs_test where parent_tab_id=0 order by tabseq

flowsheet.childTabList= select tab_id as tabid, tab_sequence as tabSeq, tab_name as tabname, event_set_name as eventsetname, event_set_cd as eventsetcode, parent_tab_id as parentTabId from emrp_dynamic_tabs_test where parent_tab_id=? order by tabseq

getAllTabName= select * from dynamicpopup where PARENTTAB=? and status=1 ORDER BY SEQUENCE ASC

user.authentication= select prsnl_id as userId, concat(name_last_key,concat(', ',concat(name_first_key,concat(' ', name_middle_key)))) as name_full_formatted, username, password, name_first_key as firstname, name_last_key as lastname, name_middle_key as middlename, admin_ind as adminInd, physician_ind as physicianInd, active_ind as activeInd, updt_cnt as updtCnt, him_ind, auditor_ind, position_cd, get_cd_value(position_cd, 'display') as position, reset_pswd, case when sysdate>end_dt_tm then 'Invalid' else 'Valid' end as userStatus, employee_id from emrp_users where upper(username)=upper(?)

user.makeInactive= update emrp_users set active_ind=0, updt_cnt=updt_cnt+1, updt_dt_tm=sysdate, updt_id=? where prsnl_id=? 

user.checkCurrentPassword= select password, name_first_key, name_last_key, employee_id, reset_pswd, concat(concat(initcap(lower(substr(name_first_key,0,2))),lower(substr(name_last_key,0,2))),employee_id) as defaultPass from emrp_users where prsnl_id=?

#user.resetPassword= update emrp_users set password=?, updt_cnt=updt_cnt+1, reset_pswd=0 where prsnl_id=?

user.resetPassword= update emrp_users set password=?, updt_cnt=updt_cnt+1, reset_pswd=0, acc_start_dt_tm = case when (acc_start_dt_tm is not null and trim(acc_start_dt_tm)!='') then acc_start_dt_tm else sysdate end where prsnl_id=?

user.UpdateLastAccessed= update emrp_users set last_accessed_dt_tm = sysdate where prsnl_id=?

blobReport= select rr.addendum_ind , ce.event_title_text, ce.event_id, cb.blob_length, cb.blob_seq_num, cb.COMPRESSION_CD, cb.blob_contents from clinical_Event c join order_Radiology ord on (ord.order_id = c.order_id and ord.parent_order_id != 0) join rad_report rr on (rr.order_id = ord.parent_order_id) join rad_report_detail rrd on (rrd.rad_report_id = rr.rad_report_id)  join clinical_event ce on (ce.event_id = rrd.detail_event_id and ce.valid_until_dt_tm>sysdate) join ce_blob_result cbr on (cbr.event_id=ce.event_id and cbr.valid_until_dt_tm > sysdate) join ce_blob cb on (cb.event_id = cbr.event_id and cb.valid_until_dt_tm > sysdate) where c.event_id=? and c.valid_until_dt_tm > sysdate order by rrd.section_sequence, ce.event_id, cb.blob_seq_num

radiology.headerQuery= select ce.order_id, get_cd_value(ce.event_cd, 'display') as ResultType, to_char(ce.event_end_dt_tm, 'Month DD, YYYY HH24:MI') as ResultDate, get_cd_value(ce.result_status_cd, 'display') as ResultStatus, ce.result_status_cd as ResultStatusCD, ce.event_title_text as ResultTitle, ea.alias as FIN, ap.format_mask as FIN_format, get_cd_value(e.loc_facility_cd, 'display') as LOC, get_cd_value(e.encntr_type_cd, 'display') as EType, to_char(e.arrive_dt_tm, 'MM/DD/YYYY') as Arrive_dt_tm, to_char(e.reg_dt_tm, 'MM/DD/YYYY') as Reg_dt_tm, to_char(e.disch_dt_tm, 'MM/DD/YYYY') as Disch_dt_tm, lb.long_blob, get_cd_value(cen.note_type_cd, 'display') as Note_type,cen.compression_cd, cen.note_format_cd, to_char(cen.note_dt_tm, 'Month DD, YYYY HH24:MI') as NoteDateTime, pr.name_full_formatted as NotePrsnl from clinical_event ce  join encounter e on (e.encntr_id = ce.encntr_id and e.active_ind = 1) left outer join encntr_alias ea on (ea.encntr_id = e.encntr_id and ea.encntr_alias_type_cd = 91.00 and ea.active_ind = 1) left outer join alias_pool ap on(ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) left outer join ce_event_note cen on ( cen.event_id = ce.event_id and cen.note_type_cd in(5891, 5875) and cen.valid_until_dt_tm >sysdate) left outer join long_blob lb on (lb.parent_entity_id  = cen.ce_event_note_id and lb.active_ind = 1) left outer join prsnl pr on(pr.person_id = cen.note_prsnl_id) where ce.event_id = ? and ce.valid_until_dt_tm > sysdate

signatureQuery= SELECT CEN.CE_EVENT_NOTE_ID, CEN.COMPRESSION_CD, L.LONG_BLOB as Signature_line, L.PARENT_ENTITY_NAME FROM ce_event_note cen, long_blob l where cen.event_id = ? and cen.note_type_cd = 5895 and cen.valid_until_dt_tm > sysdate and l.parent_entity_id = cen.ce_event_note_id and l.active_ind = 1

emrpaudit.addAuditRecords= insert into EMRP_AUDIT(AUDIT_ID,PRSNL_ID, ACTION_DT_TIME, ACTION_PERFORMED, PATIENT_MRN, IP_ADDRESS, DEVICE, OUTCOME, PATIENT_NAME, EVENT_NAME, ACTION_PARAMS, POSITION_CD, RELTN_CD, FIN_NUMBER, PERSON_ID) VALUES(EMRP_AUDIT_SEQ.NEXTVAL,?, sysdate,?,?,?,?,?,?,?,?,?,?,?,?)

MdocBlobContent= select cb.BLOB_LENGTH, cb.BLOB_SEQ_NUM, cb.BLOB_CONTENTS, cb.COMPRESSION_CD from ce_blob cb where cb.event_id = ? and cb.valid_until_dt_tm >sysdate order by cb.BLOB_SEQ_NUM desc

MdocChildEventCodeQuery= select ce.event_title_text, ce.parent_event_id,ce.event_id, get_cd_value(cbr.format_cd, 'display') as format_cd, get_cd_value(cbr.storage_cd, 'display') as storage_cd, get_cd_value(ce.event_class_cd, 'display') as evnet_class_cd, get_cd_value(ce.event_reltn_cd, 'display') as event_reltn_cd,cbr.blob_handle, case when (trim(cbr.blob_handle) is not null) then ia.IMAGE_LOCATION else '' end as image_location, to_char(sysdate+3,'MM/DD/YYYY') as support_date from clinical_event ce join ce_blob_result cbr on (cbr.event_id = ce.event_id and cbr.valid_until_dt_tm >sysdate) left outer join INDEX_APPXTENDER ia on (ia.BLOB_HANDLE = (case when instr(trim(cbr.blob_handle),'#',1,1) > 0 then substr(trim(cbr.blob_handle),0,instr(trim(cbr.blob_handle),'#',1,1)-1)else cbr.blob_handle end)) where ce.parent_event_id = ? and ce.valid_until_dt_tm >sysdate order by ce.COLLATING_SEQ desc

DocChildEventQuery= select cbr.blob_handle, ce.event_id, ce.event_title_text, get_cd_value(cbr.format_cd, 'display') as format_cd, get_cd_value(cbr.storage_cd, 'display') as storage_cd, get_cd_value(ce.event_class_cd, 'display') as event_class_cd, get_cd_value(ce.event_reltn_cd, 'display') as event_reltn_cd from clinical_event ce join ce_blob_result cbr on (cbr.event_id = ce.event_id and cbr.valid_until_dt_tm >sysdate) where ce.event_id = ? and ce.valid_until_dt_tm >sysdate

getMicroChildEventId= select C1.ACCESSION_NBR, c.SERIES_REF_NBR, c.event_id ,c.parent_event_id ,c.event_class_cd , to_char(C.EVENT_END_DT_TM, 'MONTH DD , YYYY HH24:MI') as eventdatetm, cbr.STORAGE_CD, get_cd_value(cbr.STORAGE_CD, 'display') AS STORAGE, get_cd_value(C.EVENT_CD, 'display') AS EVENTCODE, P.NAME_FULL_FORMATTED from clinical_event c join ce_blob_result cbr on(cbr.event_id = c.event_id and cbr.VALID_UNTIL_DT_TM>sysdate) JOIN PRSNL P ON(P.PERSON_ID = C.PERFORMED_PRSNL_ID AND P.ACTIVE_IND =1) join clinical_event c1 on (c1.event_id = c.parent_event_id and c1.view_level = 1 and c1.valid_until_dt_tm >sysdate) where c.parent_event_id = ? and c.event_reltn_cd = 580.00 and c.valid_until_dt_tm >sysdate

susceptibilitiesQuery= select cm.organism_cd, cs.antibiotic_cd, get_cd_value(cs.antibiotic_cd, 'description') as Drug, get_cd_value(cs.result_cd, 'display') as value, cs.result_text_value, get_cd_value(cs.detail_susceptibility_cd, 'display') as DetailSusceptibility, get_cd_value(cs.susceptibility_status_cd, 'display') as SusStatus, get_cd_value(cm.organism_cd, 'description') as organism, cs.micro_seq_nbr as microsequenceNo, cm.micro_seq_nbr as microsequenceNo1 from clinical_event c join ce_microbiology cm on(cm.event_id = c.event_id and cm.valid_until_dt_tm > sysdate) left outer join ce_susceptibility cs on (cs.event_id = cm.event_id and cs.micro_seq_nbr = cm.micro_seq_nbr and cs.detail_susceptibility_cd in (39758,39759) and cs.valid_until_dt_tm > sysdate) where c.event_id = ? and c.valid_until_dt_tm > sysdate order by cm.micro_seq_nbr, Drug

history.allPersonNotes= select e.prsnl_id, e.note_txt as person_notes, concat(concat(eu.name_first_key, ' '),eu.name_last_key) as prsnl_name, to_char(e.note_dt_tm, 'HH24:MI MM-DD-YYYY') as note_dt_tm from emrp_person_notes e left outer join emrp_users eu on (eu.prsnl_id=e.prsnl_id) where e.person_id=? order by e.note_dt_tm desc

history.personNotesInsertion= insert into emrp_person_notes (prsnl_id, person_id, note_txt, note_dt_tm) values (?, ?, ?, sysdate)

getAppointments= SELECT get_cd_value(s1.APPT_LOCATION_CD, 'display') as LOCATION, get_cd_value(s1.sch_state_cd, 'display') as State, to_char (s1.BEG_DT_TM, 'MM/DD/YYYY hh24:MI') as BEGIN_DATE_TIME, s1.DURATION as Duration, to_char (S1.END_DT_TM, 'MM/DD/YYYY hh24:MI') as END_DATE_TIME, e1.disp_display as Appt_type, e2.disp_display as Resource_disp FROM SCH_APPT s1 join SCH_EVENT_DISP e1 on (e1.sch_event_id = s1.sch_event_id and e1.version_dt_tm = to_date('12/31/2100 00:00:00', 'MM/DD/YYYY hh24:mi:ss') and e1.disp_field_id = 6) join SCH_EVENT_DISP e2 on (e2.sch_event_id = s1.sch_event_id and e2.version_dt_tm = to_date('12/31/2100 00:00:00', 'MM/DD/YYYY hh24:mi:ss') and e2.disp_field_id = 5 and e2.schedule_id = s1.schedule_id) WHERE s1.person_id = ? and s1.role_meaning = 'PATIENT' and s1.version_dt_tm = to_date('12/31/2100 00:00:00', 'MM/DD/YYYY hh24:mi:ss') order by s1.beg_dt_tm DESC

getPreAdmitCancelled= select get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, to_char(e.reg_dt_tm,'MM/DD/YYYY HH24:MI') as Reg_dt_tm, to_char(e.disch_dt_tm,'MM/DD/YYYY HH24:MI') as Disch_dt_tm, get_cd_value(e.med_service_cd, 'display') as Medical_service, get_cd_value(e.loc_facility_cd, 'display') as Facility, case when e.loc_room_cd>0 then case when e.loc_bed_cd>0 then concat(concat(concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display')),';'),get_cd_value(e.loc_bed_cd, 'display')) else (concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display'))) end else get_cd_value(e.loc_nurse_unit_cd, 'display') end as location, ea.alias as Acct,ap.format_mask as FIN_format, e.encntr_id as Encntr_id from encounter e left outer join encntr_alias ea on (ea.encntr_id=e.encntr_id and ea.active_ind=1 and ea.encntr_alias_type_cd=91) left outer join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) join emrp_prsnl_org_reltn por on (por.organization_id=e.organization_id and por.active_ind =1 and por.end_effective_dt_tm >sysdate) where  por.person_id=? and e.person_id = ? and e.encntr_type_class_cd =7151 and e.encntr_status_cd =39696 order by e.reg_dt_tm DESC

resultHistoryHeader= select c.event_id, c.result_status_cd, c.event_class_cd as EventClassCd, c.parent_event_id, c.result_val as value, get_cd_value(c.RESULT_UNITS_CD, 'display') as ResultUnit,to_char(c.VALID_FROM_DT_TM, 'MM/DD/YYYY HH24:MI:SS') as validFrom, case when to_char(c.VALID_UNTIL_DT_TM, 'MM/DD/YYYY') = '12/31/2100' then 'Current' else to_char(c.VALID_UNTIL_DT_TM, 'MM/DD/YYYY HH24:MI:SS') end as validUntil, case when (c.event_class_cd = 5235) then (case when (c.result_val like '1:%') then concat(substr(c.result_val,7,2),concat('/', concat(substr(c.result_val,9,2),concat('/',substr(c.result_val,3,4))))) when (c.result_val like '0:%')then concat(substr(c.result_val,7,2),concat('/', concat(substr(c.result_val,9,2),concat('/', concat(substr(c.result_val,3,4),concat(' ', concat(substr(c.result_val,11,2),concat(':', substr(c.result_val,13,2))))))))) when(c.result_val like '2:%')then  concat(substr(c.result_val,11,2),concat(':', substr(c.result_val,13,2)))end) else (case when c.event_tag is null then c.result_val else c.event_tag end) end as Resultval from clinical_event c where c.event_id = ? and c.view_level = 1 order by c.valid_from_dt_tm desc

verified_By= select to_char(c.Action_dt_tm, 'Month DD, YYYY HH24:MI') as verify_date , case when p1.name_full is null then pr.name_full_formatted else p1.name_full end as verify_prsnl from ce_event_prsnl c left outer join prsnl pr on(pr.person_id =  c.action_prsnl_id) left outer join person_name p1 on (p1.person_id = c.action_prsnl_id and p1.name_type_cd = 16027279 and p1.beg_effective_dt_tm <=c.action_dt_tm and p1.end_effective_dt_tm >=c.action_dt_tm ) where c.event_id = ? and c.action_type_cd =  634 and c.valid_until_dt_tm > sysdate

performed_By= select to_char(c.Action_dt_tm, 'Month DD, YYYY HH24:MI') as perform_date , case when p1.name_full is null then pr.name_full_formatted else p1.name_full end as perform_prsnl from ce_event_prsnl c left outer join prsnl pr on(pr.person_id =  c.action_prsnl_id) left outer join person_name p1 on (p1.person_id = c.action_prsnl_id and p1.name_type_cd = 16027279 and p1.beg_effective_dt_tm <=c.action_dt_tm and p1.end_effective_dt_tm >=c.action_dt_tm ) where c.event_id = ? and c.action_type_cd =  626 and c.valid_until_dt_tm > sysdate

imagingOrderID = select ce.order_id from clinical_event ce where ce.event_id = ? and ce.valid_until_dt_tm > sysdate

reportEventId_Query= select r.report_event_id from rad_report r where r.order_id = ?

getOrgLocatorReport= select o.org_name as org_name, o.active_ind, get_cd_value(o.data_status_cd, 'display') as data_status, oa.alias as alias, oa.active_ind, o.organization_id from Organization_Alias OA, Organization O where oa.alias = upper(?) and o.organization_id = oa.organization_id order by alias,o.organization_id

patientLookUpGetNames= select p.name_full_formatted, p.person_id from person p where p.person_type_cd=222 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))

patientEncntrLookupHeader= select distinct p.name_full_formatted as patient_name,p.person_id, to_char(p.birth_dt_tm, 'MM/DD/YYYY') as birth_dt_tm, ph.phone_num,ad.street_addr as Address,ad.street_addr2 as ADDRESS2, ad.city as city, get_cd_value(ad.state_cd, 'display') as state, AD.ZIPCODE as zip from person p left outer join phone ph on(ph.parent_entity_id = p.person_id and ph.phone_type_cd = 3844 and ph.active_ind = 1) left outer join address ad on (ad.parent_entity_id = p.person_id and ad.address_type_cd = 288 and ad.active_ind = 1) where p.person_id = ? and p.active_ind = 1

patientEncntrLookupVisitInfo= SELECT ea.alias as fin_nbr, get_cd_value(e.loc_nurse_unit_cd, 'display') as encntr_loc, get_cd_value(e.encntr_status_cd, 'display') as encntr_status, get_cd_value(e.encntr_type_cd, 'display') as encntr_type, to_char(e.reg_dt_tm,'MM/DD/YYYY') as admit_date, to_char(e.disch_dt_tm,'MM/DD/YYYY') as disch_date, p2.name_full_formatted as attending_md FROM encounter e left outer join encntr_prsnl_reltn ep on(ep.encntr_id = e.encntr_id and ep.encntr_prsnl_r_cd = 3432 and ep.active_ind = 1 and ep.end_effective_dt_tm > sysdate) left outer join person p2 on (p2.person_id = ep.PRSNL_person_id and p2.active_ind = 1) left outer join encntr_alias ea on (ea.encntr_id = e.encntr_id and ea.encntr_alias_type_cd = 91 and ea.end_effective_dt_tm > sysdate and ea.active_ind = 1) where e.person_id = ? and e.beg_effective_dt_tm <= sysdate and e.active_ind = 1 ORDER by e.reg_dt_tm desc, encntr_loc

getFacilities= select ao.auro_org_id , cv.code_value as facility_cd, cv.display_key as facility_disp_key, cv.description as facility_description, o.organization_id, por.prsnl_org_reltn_id, case when cv.code_value in (31141965,31142124,363180911,589030827,589030827,752885621)then 1 else 0 end as child_ind from location l join code_value cv on (cv.code_value = l.location_cd and cv.data_status_cd = 601.00 and cv.begin_effective_dt_tm <= sysdate and cv.end_effective_dt_tm > sysdate and cv.active_ind = 1) join organization o on ( o.organization_id = l.organization_id and o.beg_effective_dt_tm <= sysdate and o.end_effective_dt_tm > sysdate and o.active_ind = 1) join auro_organizations ao on (ao.organization_id = o.organization_id and ao.clinic_ind = 0 and ao.active_ind = 1) join emrp_prsnl_org_reltn por on (por.person_id = ? and por.organization_id = o.organization_id and por.beg_effective_dt_tm <= sysdate and por.end_effective_dt_tm > sysdate and por.active_ind = 1) where l.location_type_cd = 1666.00 and l.location_cd != 0.00 and l.location_cd != 580084699.00 and l.location_cd != 29011403.00 and l.location_cd != 15869770.00 and l.location_cd != 28113994.00 and l.patcare_node_ind = 1 and l.beg_effective_dt_tm <= sysdate and l.end_effective_dt_tm > sysdate and l.active_ind = 1 order by cv.description

visitListPatientDetails= select distinct p.name_full_formatted as patient_name, pa.alias as mrn_nbr, p.person_id, to_char(p.birth_dt_tm, 'MM/DD/YYYY') as birth_dt_tm, ph.phone_num, ad.street_addr as Address, ad.street_addr2 as ADDRESS2, ad.city as city, get_cd_value(ad.state_cd, 'display') as state, AD.ZIPCODE as zip from person_alias pa join person p on (p.person_id = pa.person_id and p.name_last_key = upper(?) and p.active_ind = 1 ) left outer join phone ph on(ph.parent_entity_id = p.person_id and ph.phone_type_cd = 3844	and ph.active_ind = 1) left outer join address ad on(ad.parent_entity_id = p.person_id and ad.address_type_cd = 288 and ad.active_ind = 1) where pa.alias = (?) and pa.alias_pool_cd = ? and pa.active_ind = 1

visitListPatientFacilities= select ea.alias as fin_nbr, get_cd_value(e.loc_nurse_unit_cd, 'display') as encntr_loc, get_cd_value(e.encntr_status_cd, 'display') as encntr_status, get_cd_value(e.encntr_type_cd, 'display') as encntr_type, to_char(e.reg_dt_tm, 'MM/DD/YYYY') as admit_date,to_char( e.disch_dt_tm, 'MM/DD/YYYY') as disch_date, p2.name_full_formatted as attending_md FROM encounter e left outer join encntr_prsnl_reltn ep on (ep.encntr_id = e.encntr_id and ep.encntr_prsnl_r_cd = 3432 and ep.active_ind = 1 and ep.end_effective_dt_tm > sysdate) left outer join person p2 on (p2.person_id = ep.PRSNL_person_id and p2.active_ind = 1) left outer join encntr_alias ea on (ea.encntr_id = e.encntr_id and ea.encntr_alias_type_cd = 91 and ea.end_effective_dt_tm > sysdate and ea.active_ind = 1) where e.person_id = ? and e.beg_effective_dt_tm <= sysdate and e.loc_facility_cd in (?) and e.active_ind = 1 ORDER by e.reg_dt_tm desc, encntr_loc

getDuplicateMrns= select pa2.alias as add_mrn from person_alias pa2 where pa2.person_id = ? and pa2.alias_pool_cd = ? and pa2.alias != ? ORDER by pa2.beg_effective_dt_tm

facilityDispCnt= SELECT COUNT(CV1.ACTIVE_DT_TM) as cnt FROM CODE_VALUE CV1 where CV1.CODE_SET = 220 and CV1.CDF_MEANING = 'FACILITY' AND CV1.ACTIVE_IND = 1 AND CV1.BEGIN_EFFECTIVE_DT_TM < SYSDATE AND CV1.END_EFFECTIVE_DT_TM > SYSDATE AND CV1.DISPLAY_KEY like ?

bedHistoryReport= SELECT E.ALIAS_POOL_CD, E.ENCNTR_ALIAS_TYPE_CD, E.ACTIVE_IND, E.ENCNTR_ID, E.ALIAS, PE.NAME_FULL_FORMATTED, to_char(EL.BEG_EFFECTIVE_DT_TM,'DD-MON-YYYY HH24:MI:SS') as BEG_EFFECTIVE_DT_TM, to_char(EL.END_EFFECTIVE_DT_TM,'DD-MON-YYYY HH24:MI:SS') as END_EFFECTIVE_DT_TM, get_cd_value(EL.LOC_BUILDING_CD, 'display') as LOC_BUILDING_DISP, get_cd_value(EL.LOC_FACILITY_CD, 'display') as LOC_FACILITY_DISP, get_cd_value(EL.LOC_NURSE_UNIT_CD, 'display') as LOC_NURSE_UNIT_DISP, get_cd_value(EL.LOC_ROOM_CD, 'display') as LOC_ROOM_DISP, get_cd_value(EL.LOC_BED_CD, 'display') as LOC_BED_DISP, get_cd_value(EL.LOCATION_CD, 'display') as LOCATION_DISP, EL.ENCNTR_ID, get_cd_value(EL.ENCNTR_TYPE_CD, 'display') as ENCNTR_TYPE_DISP FROM ENCNTR_ALIAS E join ENCNTR_LOC_HIST EL on (EL.ENCNTR_ID = E.ENCNTR_ID AND EL.LOC_FACILITY_CD IN (?) AND EL.ACTIVE_IND = 1) join ENCOUNTER EN on (EN.ENCNTR_ID = E.ENCNTR_ID AND EN.ACTIVE_IND = 1 AND EN.DATA_STATUS_CD = 601) join PERSON PE on (PE.PERSON_ID = EN.PERSON_ID AND PE.ACTIVE_IND = 1) where E.ALIAS = ? AND E.ENCNTR_ALIAS_TYPE_CD = 91 AND E.ACTIVE_IND = 1 AND E.END_EFFECTIVE_DT_TM > sysdate AND E.ACTIVE_IND = 1 ORDER BY EL.BEG_EFFECTIVE_DT_TM

ccl5.locatePatientEmp= SELECT P.PERSON_ID, P.NAME_FULL_FORMATTED as NAME, to_char(P.BIRTH_DT_TM, 'MM/DD/YYYY') as birth_dt_tm FROM PERSON P WHERE P.PERSON_TYPE_CD=222 AND P.ACTIVE_IND=1 AND P.NAME_LAST_KEY= upper(?) AND P.NAME_FIRST_KEY= upper(?) ORDER BY P.BIRTH_DT_TM

audit.userCentricReports= select to_char(ea.action_dt_time, 'MM/DD/YYYY HH24:MI') as actionDate, ea.device, ea.event_name, ea.patient_name, ea.patient_mrn as mrn, get_cd_value(ea.position_cd, 'display') as role, get_cd_value(ea.reltn_cd, 'display') as reltn, case when ea.outcome=1 then 'Success' else 'Failure' end as outcome, ea.fin_number from audit_log_view ea where ea.prsnl_id = ? and ea.action_dt_time between to_date(?, 'dd-mon-yyyy hh24:mi:ss') and to_date(?, 'dd-mon-yyyy hh24:mi:ss') order by ea.action_dt_time desc

audit.patientCentricReports= select to_char(ea.action_dt_time, 'MM/DD/YYYY HH24:MI') as actionDate, ea.device, concat(eu.name_last_key,concat(', ',concat(eu.name_first_key,concat(' ', eu.name_middle_key)))) as name_full_formatted, upper(eu.username) as username, ea.event_name, get_cd_value(ea.position_cd, 'display') as role, get_cd_value(ea.reltn_cd, 'display') as reltn, case when ea.outcome=1 then 'Success' else 'Failure' end as outcome, ea.fin_number from audit_log_view ea join emrp_users eu on (ea.prsnl_id = eu.prsnl_id) where ea.person_id = ? and ea.action_dt_time between to_date(?, 'dd-mon-yyyy hh24:mi:ss') and to_date(?, 'dd-mon-yyyy hh24:mi:ss') order by ea.action_dt_time desc

ccl9.patientActivity= SELECT 	distinct   E.PERSON_ID,  LPAD( SUBSTR(PA.ALIAS,1,15),8,0) as MRN,  SUBSTR(P.NAME_FULL_FORMATTED,1,35) as fName FROM ENCOUNTER E join PERSON_ALIAS PA on (PA.PERSON_ID = E.PERSON_ID  AND PA.ALIAS_POOL_CD = ?  AND PA.ACTIVE_IND = 1    AND PA.END_EFFECTIVE_DT_TM > sysdate)  join PERSON P on (P.PERSON_ID = E.PERSON_ID   AND P.ACTIVE_IND = 1)  WHERE E.REG_DT_TM >= to_date(?,'dd-mon-yyyy hh24:mi:ss')     AND E.REG_DT_TM <= to_date(?,'dd-mon-yyyy hh24:mi:ss')    and e.encntr_type_cd != 15500324  AND NOT EXISTS (SELECT E1.PERSON_ID FROM ENCOUNTER E1 WHERE E1.PERSON_ID = E.PERSON_ID  AND E1.BEG_EFFECTIVE_DT_TM <= sysdate AND E1.LOC_FACILITY_CD = E.LOC_FACILITY_CD AND E1.REG_DT_TM >= to_date(?,'dd-mon-yyyy hh24:mi:ss'))  AND E.LOC_FACILITY_CD in (?)  ORDER by fName, MRN

ccl9.getFacility= select v1.description as facility_description, v2.description as clinic from code_value v1 left outer join  code_value v2 on (v2.code_value=?) WHERE   v1.display_key  =? and v1.code_value  in (?)

getClinics = select cv.code_value as facility_cd, cv.display_key as facility_disp_key,cv.description as facility_description, o.organization_id,por.prsnl_org_reltn_id from location l join code_value cv on (cv.code_value = l.location_cd and cv.data_status_cd = 601.00  and cv.begin_effective_dt_tm <= sysdate    and cv.end_effective_dt_tm > sysdate    and cv.active_ind = 1) join organization o on ( o.organization_id = l.organization_id and o.beg_effective_dt_tm <= sysdate    and o.end_effective_dt_tm > sysdate and o.active_ind = 1) join auro_organizations ao on (ao.organization_id = o.organization_id and ao.clinic_ind = 1 and ao.active_ind = 1) join prsnl_org_reltn por on (por.person_id = ? and por.organization_id = o.organization_id    and por.beg_effective_dt_tm <= sysdate and por.end_effective_dt_tm > sysdate and por.active_ind = 1) where l.location_type_cd = 1666.00 and l.location_cd != 0.00 and l.beg_effective_dt_tm <= sysdate and l.end_effective_dt_tm > sysdate and l.active_ind = 1 and l.data_status_cd = 601.00 order by cv.description

radiologyReport= SELECT ord.accession, ord.accession_id, ord.encntr_id, ord.order_id,ord.catalog_cd, ocs.mnemonic, get_cd_value(ord.exam_status_cd, 'display') as ExamStatus, get_cd_value(ord.report_status_cd, 'display') as ReportStatus, get_cd_value(o.order_status_cd, 'display') as Status, get_cd_value(e.loc_facility_cd, 'display') as Department, get_cd_value(ord.priority_cd, 'display') as Priority, case when (select distinct oc.order_id from  order_comment oc where (oc.order_id = o.order_id and oc.comment_type_cd in(5872,5873,5871)))>0 then 1 else 0 end as order_comment_ind ,ea.alias as FinNumber,ap.format_mask, to_char(ord.complete_dt_tm ,'MM/DD/YYYY HH24:MI') as ExamDate from order_radiology ord JOIN rad_exam re on  re.order_id  = ord.order_id  and re.exam_sequence = 1 JOIN orders o on  o.order_id = ord.order_id JOIN order_catalog_synonym ocs on (ocs.catalog_cd = o.catalog_cd and ocs.mnemonic_type_cd =1121.00) JOIN encounter e on (e.encntr_id= ord.encntr_id  and  e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id =   ? and por.end_effective_dt_tm >sysdate and por.active_ind = 1)) JOIN encntr_alias ea ON (ea.encntr_id = e.encntr_id  and ea.encntr_alias_type_cd =  91.00 and ea.end_effective_dt_tm >sysdate) left outer JOIN  alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.end_effective_dt_tm >sysdate) where ord.person_id = ? order by ocs.mnemonic

radiologyReportDesc= select rr.addendum_ind, ce.event_tag,ce.event_id, cb.blob_length, cb.blob_seq_num, cb.COMPRESSION_CD, cb.blob_contents from order_Radiology ord join rad_report rr on(rr.order_id = ord.parent_order_id) join rad_report_detail rrd on(rrd.rad_report_id = rr.rad_report_id) join clinical_event ce on(ce.event_id = rrd.detail_event_id and ce.valid_until_dt_tm>sysdate) join ce_blob_result cbr on(cbr.event_id=ce.event_id and cbr.valid_until_dt_tm > sysdate) join ce_blob cb on(cb.event_id = cbr.event_id and cb.valid_until_dt_tm > sysdate) where ord.order_id= ? and ord.parent_order_id != 0 order by rrd.section_sequence, ce.event_id, cb.blob_seq_num 

radiologyReportSign= SELECT CEN.CE_EVENT_NOTE_ID, CEN.COMPRESSION_CD, L.LONG_BLOB as Signature_line, L.PARENT_ENTITY_NAME FROM ce_event_note cen, long_blob l where cen.event_id = ? and cen.note_type_cd = 5895 and cen.valid_until_dt_tm > sysdate and l.parent_entity_id = cen.ce_event_note_id and l.active_ind = 1

radiologyReportExamDet= select r.rad_exam_id, dta.mnemonic, to_char(r.starting_dt_tm, 'MM/DD/YYYY HH24:MI') as StartedDatetime, to_char(r.complete_dt_tm, 'MM/DD/YYYY HH24:MI') as CompletedDatetime, rep.primary_prsnl_ind as PrimaryPersonnelInd, rep.exam_prsnl_id,  case when p1.name_full is null then p.name_full_formatted else p1.name_full end as PrsnlName, get_cd_value(rep.action_type_cd, 'display') as Actiontype, get_cd_value(r.service_resource_cd, 'display') as ExamRoom, rep.action_sequence,rep.action_type_cd from rad_exam r join discrete_task_assay dta on (dta.task_assay_cd = r.task_assay_cd and dta.default_result_type_cd = 267.00) left outer join rad_exam_prsnl rep on (rep.rad_exam_id = r.rad_exam_id) left outer join person_name p1 on (p1.person_id = rep.exam_prsnl_id and p1.name_type_cd = 16027279 and p1.beg_effective_dt_tm <= r.complete_dt_tm and p1.end_effective_dt_tm >= r.complete_dt_tm and p1.active_ind = 1) left outer join prsnl p on (p.person_id = rep.exam_prsnl_id) where r.order_id = ? order by r.rad_exam_id, rep.action_type_cd, rep.action_sequence

radiologyReportOrderDet= select ofm.label_text, od.oe_field_display_value from ORDER_DETAIL od join orders o on (o.order_id = od.order_id) join OE_FORMAT_FIELDS ofm on (ofm.oe_field_id = od.oe_field_id and OFm.OE_FORMAT_ID=O.OE_FORMAT_ID and ofm.action_type_cd = 1078) where od.order_id =?  and OD.OE_FIELD_MEANING_ID!=125  AND OD.OE_FIELD_MEANING_ID!=2071 AND OD.OE_FIELD_MEANING_ID!=2094 and od.action_sequence = (select max(od1.action_sequence) from order_detail od1 where od1.order_id = od.order_id  and od1.oe_field_meaning_id = od.oe_field_meaning_id) order by ofm.oe_field_id

radiologyReportTechDet= select rtf.field_desc, rtcd.field_id as FieldId, rtcd.parent_field_id as ParentFieldId, case when(rtcd.field_id = rtcd.parent_field_id) then  1 else 0 end as ParentRowInd, case when (rtf.field_type_flag = 0)	then 'Header'   when (rtf.field_type_flag =1	) then 'Number'   when (rtf.field_type_flag =2	)	then 'Text'   when (rtf.field_type_flag =3	)	then 'Date'   when (rtf.field_type_flag =4	)	then 'Single Choice'   when (rtf.field_type_flag =5	) then 'Multi Choice' end as FieldType,    rtcd.data_text as Textresult,rtcd.data_nbr as NbrResult,   to_char(rtcd.data_dt_tm,'MM/DD/YYYY HH24:MI') as DateResult, rtcd.data_choice_ind as ChoiceResultInd,   rtcd.required_ind as RequiredInd,rtcd.chartable_ind as ChartableInd,   case when (p1.name_full is null) then p.name_full_formatted else p1.name_full end as LastUpdatedPrsnl,   to_char(rtcd.prsnl_updt_dt_tm ,'MM/DD/YYYY HH24:MI') as UpdatedDtTm ,rtcd.min_nbr as MinNbr ,rtcd.max_nbr as MaxNbr  from rad_tech_cmt_data rtcd  join rad_tech_field rtf on(rtf.field_id = rtcd.field_id)  left outer join prsnl p on(p.person_id = rtcd.prsnl_updt_id)  left outer join person_name p1 on (p1.person_id = rtcd.prsnl_updt_id and p1.name_type_cd = 16027279  and p1.beg_effective_dt_tm <=rtcd.prsnl_updt_dt_tm and p1.end_effective_dt_tm >=rtcd.prsnl_updt_dt_tm  and p1.active_ind = 1)  where rtcd.order_id = ?  order by rtcd.sequence

radiologyReportMedication= SELECT P.NAME_FULL_FORMATTED , RM.RAD_MED_ID, ao.accession as ACC, OCS.MNEMONIC as Administered_Med,to_char( RM.ADMIN_DT_TM,'MM/DD/YYYY') as Administration_Date,rmf.field_meaning, 	case when (rmf.field_meaning = 'ADMINPRSNL') then pr1.name_full_formatted		else ''  end as Administration_Personnel, case when (rmf.field_meaning = 'COMMENTS') then RMD.VALUE_TXT else '' end as COMMENTS,	case when (rmf.field_meaning = 'APPROVEPRSNL') then pr1.name_full_formatted		else ''  end as Approving_Personnel, 	case when (rmf.field_meaning = 'CONSENTIND') then  (case when(rmd.value_nbr=1) then 'Yes'     when(rmd.value_nbr=2) then 'No' else '' end)  else '' end Consent_Ind, 	case when (rmf.field_meaning = 'DOSE') then rmd.value_nbr	else 0  end as Dose, 	case when (rmf.field_meaning = 'DOSEUNIT') then  get_cd_value(rmd.value_nbr, 'display') 	else ''  end as Dose_unit, to_char( RMD.VALUE_DT_TM,'MM/DD/YYYY') 	 as Expiration_Date, 	case when (rmf.field_meaning = 'LOTNUM') then RMD.VALUE_TXT 	else ''  end as Lot_Num, 	case when (rmf.field_meaning = 'ROUTEADMIN') then get_cd_value(rmd.value_nbr, 'display') 	else ''  end as Route_of_Administration, 	case when (rmf.field_meaning = 'SITEADMIN') then get_cd_value(rmd.value_nbr, 'display') 	else ''  end as Siteof_Administration 	from RAD_MEDS RM LEFT OUTER JOIn  RAD_MED_DETAILS RMD on RMD.RAD_MED_ID=RM.RAD_MED_ID  join ORD_ENTITY_RELTN OER on RM.RAD_MED_ID=OER.PARENT_ENTITY_ID AND OER.PARENT_ENTITY_NAME='RAD_MEDS'   join RAD_MED_FIELDS RMF on RMF.RAD_MED_FIELD_ID=RMD.RAD_MED_FIELD_ID   join ORDER_CATALOG_SYNONYM OCS on (OCS.SYNONYM_ID=RM.SYNONYM_ID) 	left outer  join  PRSNL PR1 on rmd.value_nbr = pr1.person_id  join  PERSON P on p.person_id = (rm.person_id)  join ACCESSION_ORDER_R AO on ao.order_id = oer.order_id  WHERE ao.order_id = ? ORDER BY 	RM.RAD_MED_ID,RMD.RAD_MED_FIELD_ID 
 
radilogyReportDet= select case when (p1.name_full is null) then p.name_full_formatted else p1.name_full end as SigningPrsnl, to_char(rrph.action_dt_tm, 'MM/DD/YYYY HH24:MI') as ActionDateTime, get_cd_value(rrph.action_cd, 'display') as Status, case when (pr1.name_full is null) then pr.name_full_formatted else pr1.name_full end as ProxyForPrsnl from order_radiology orad join rad_report rr on(rr.order_id = orad.parent_order_id) join rad_rpt_prsnl_hist rrph on(rrph.rad_report_id = rr.rad_report_id) join prsnl p on(p.person_id  = rrph.report_prsnl_id) left outer join person_name p1 on (p1.person_id = rrph.report_prsnl_id and p1.name_type_cd = 16027279 and p1.beg_effective_dt_tm <=rrph.action_dt_tm and p1.end_effective_dt_tm >=rrph.action_dt_tm  and p1.active_ind = 1) left outer join prsnl pr on (pr.person_id = rrph.proxied_for_id) left outer join person_name pr1 on(pr1.person_id = rrph.proxied_for_id and pr1.name_type_cd = 16027279 and pr1.beg_effective_dt_tm <=rrph.action_dt_tm and pr1.end_effective_dt_tm >=rrph.action_dt_tm  and pr1.active_ind = 1) where orad.order_id = ? and orad.parent_order_id !=0 order by rrph.action_dt_tm

radilogyReportDetAcc= select rr.rad_report_id, get_cd_value(orad.report_status_cd, 'display') as ReportStatus, to_char(rr.dictated_dt_tm,'MM/DD/YYYY HH24:MI') as DictatedDateTime, to_char(rr.original_trans_dt_tm,'MM/DD/YYYY HH24:MI') as OriginalTransDtTm, get_cd_value(rr.report_creation_mthd_cd, 'display') as ReportingMethod, orad1.order_id as OrderId, orad1.Accession as Accession,ocs.mnemonic as OrderProcedure from order_radiology orad join rad_report rr on(rr.order_id = orad.parent_order_id) and rr.addendum_ind = 0 join order_radiology orad1 on(orad1.parent_order_id = rr.order_id) join order_catalog_synonym ocs on(ocs.catalog_cd = orad1.catalog_cd and ocs.mnemonic_type_cd =1121.00) where orad.order_id = ? and orad.parent_order_id !=0

radiologyReportComment= select get_cd_value(oc.comment_type_cd, 'display') as CommentType,lt.long_text as Commenttext from order_radiology orad join order_comment oc on(oc.order_id = orad.order_id and oc.comment_type_cd in(5871.00,5872.00,5873.00)) join long_text lt on(lt.long_text_id = oc.long_text_id) where orad.order_id =? order by orad.order_id, oc.comment_type_cd, oc.action_sequence desc

radiologyHistory=select ocs.MNEMONIC ,to_char(ed.complete_dt_tm , 'MM/DD/YYYY HH24:MI') as ExamDate  from exam_data ed JOIN encounter e on (e.encntr_id= ed.encntr_id  and  e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id =  ? and por.end_effective_dt_tm >sysdate and por.active_ind = 1)) join order_catalog_synonym ocs on (ocs.catalog_cd = ed.catalog_cd and ocs.mnemonic_type_cd =1121.00) where ed.person_id =  ? and ed.order_id not in (select Order_id from order_radiology where person_id = ?)

actionListVerify= select 'VERIFY' as Action, to_char( c.verified_dt_tm, 'MM/DD/YYYY HH24:MI:SS') as ACTION_DT_TM ,case when p1.name_full is null then pr.name_full_formatted else p1.name_full end as performedBy from clinical_event c left outer join prsnl pr on(pr.person_id =  c.verified_prsnl_id) left outer join person_name p1 on (p1.person_id = pr.person_id and p1.name_type_cd = 16027279  and p1.beg_effective_dt_tm <=c.verified_dt_tm and p1.end_effective_dt_tm >=c.verified_dt_tm and p1.active_ind = 1 ) where c.event_id = ? and c.valid_from_dt_tm < = to_date(?,'MM/dd/yyyy hh24:mi:ss') and c.valid_until_dt_tm >= to_date(?, 'MM/dd/yyyy hh24:mi:ss')

actionListPerform= select 'Perform' as Action,to_char( c.performed_dt_tm, 'MM/DD/YYYY HH24:MI:SS') as ACTION_DT_TM  ,case when p1.name_full is null then pr.name_full_formatted else p1.name_full end as performedBy from clinical_event c left outer join prsnl pr on(pr.person_id =  c.performed_prsnl_id) left outer join person_name p1 on (p1.person_id = pr.person_id and p1.name_type_cd = 16027279 and p1.beg_effective_dt_tm <=c.performed_dt_tm and p1.end_effective_dt_tm >=c.performed_dt_tm and p1.active_ind = 1 )  where c.event_id = ? and c.valid_from_dt_tm < = to_date(?,'MM/dd/yyyy hh24:mi:ss') and c.valid_until_dt_tm >= to_date(?, 'MM/dd/yyyy hh24:mi:ss')

actionListPerformWithoutDate= select 'Perform' as Action,to_char( c.performed_dt_tm, 'MM/DD/YYYY HH24:MI:SS') as ACTION_DT_TM  ,case when p1.name_full is null then pr.name_full_formatted else p1.name_full end as performedBy from clinical_event c left outer join prsnl pr on(pr.person_id =  c.performed_prsnl_id) left outer join person_name p1 on (p1.person_id = pr.person_id and p1.name_type_cd = 16027279 and p1.beg_effective_dt_tm <=c.performed_dt_tm and p1.end_effective_dt_tm >=c.performed_dt_tm and p1.active_ind = 1 )  where c.event_id = ? 

actionListVerifyWithoutDate= select 'VERIFY' as Action,to_char( c.verified_dt_tm, 'MM/DD/YYYY HH24:MI:SS') as ACTION_DT_TM ,case when p1.name_full is null then pr.name_full_formatted else p1.name_full end as performedBy from clinical_event c left outer join prsnl pr on(pr.person_id =  c.verified_prsnl_id) left outer join person_name p1 on (p1.person_id = pr.person_id and p1.name_type_cd = 16027279  and p1.beg_effective_dt_tm <=c.verified_dt_tm and p1.end_effective_dt_tm >=c.verified_dt_tm and p1.active_ind = 1 ) where c.event_id = ?

demographics= select p.name_full_formatted, p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy HH:MI:SS') as birth_dt_tm, get_cd_value(p.SEX_CD, 'display') AS SEX, get_cd_value(p.MARITAL_TYPE_CD, 'display') as marital_status, get_cd_value(p.race_cd, 'display') as race, get_cd_value(p.RELIGION_CD, 'display') as religion, get_cd_value(p.ETHNIC_GRP_CD, 'display') as ethnic_grp, get_cd_value(p.deceased_cd, 'display') as deceased, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, get_cd_value(p.language_cd, 'display') as language_value, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Street_Address, a.STREET_ADDR2 as Street_Address2, ph.phone_num, get_cd_value(pp.process_alert_cd, 'display') as ProcessAlert, get_cd_value(pp.disease_alert_cd, 'display') as DiseaseAlert, pa.alias AS SSN, ap.format_mask as SSN_format, get_cd_value(pa1.person_alias_type_cd, 'display') as alias_type, pa1.alias as Alias, ap1.format_mask as alias_format, get_cd_value(pa1.alias_pool_cd, 'display') as Alias_pool from person p LEFT OUTER JOIN Address a ON (a.parent_entity_id=p.person_id and a.parent_entity_name='PERSON' and a.active_ind=1 and a.end_effective_dt_tm>sysdate and a.address_type_cd = 288) left outer join Phone ph on (ph.parent_entity_id = p.person_id and ph.parent_entity_name = 'PERSON' AND ph.active_ind = 1 and ph.end_effective_dt_tm > sysdate and  ph.phone_type_cd = 3844) left outer join person_patient pp on(pp.person_id =  p.person_id and pp.end_effective_dt_tm > sysdate) LEFT OUTER join person_alias pa ON (pa.person_id=p.person_id and pa.active_ind=1 and pa.person_alias_type_cd=2334 and pa.alias_pool_cd=7091) LEFT OUTER JOIN alias_pool ap ON (ap.alias_pool_cd = pa.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) left outer join person_alias pa1 on(pa1.person_id = p.person_id and pa1.active_ind = 1 and pa1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = pa1.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) where p.active_ind=1 and p.end_effective_dt_tm>sysdate and p.person_type_cd=222 and p.person_id=?

search.getAllActiveOrgs= select o.organization_id ,o.org_name from org_type_reltn otr join organization o on(o.organization_id = otr.organization_id and o.active_ind = 1 and o.end_effective_dt_tm >sysdate) where otr.org_type_cd = 254.00 and otr.end_effective_dt_tm >sysdate order by lower(o.org_name )

reltn.CheckIfExist= select PPR_CD from EMRP_PERSON_PRSNL_ACTIVITY where PRSNL_ID=? and PERSON_ID=?

reltn.InsertRelation= insert into emrp_person_prsnl_activity (ppa_id, prsnl_id, person_id, ppr_cd) values (EMRP_PERSON_PRSNL_ACTIVITY_SEQ.nextval, ?, ?, ?)

chartsoft= select distinct a.ARCDOC_ID, a.ARCHIVE_DATE, a.DOCTYPE, a.VISIT_ID, a.BILLING_NUMBER, a.MRN,  a.FILE_NAME as FILENAME, b.docType as doctype1, b.Folder as folder,  c.docTitle as doctitle , get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, e.reg_dt_tm sortOredr,  to_char(e.reg_dt_tm,'MM/DD/YYYY') as Reg_dt_tm, ap.format_mask  from index_softmed a left join softmed_folders b on  a.docType=b.docType  and b.viewName='Coder View' left join softmed_doctitle  c  on c.doctype=a.doctype   join encounter e on e.person_id=? join  encntr_alias ea  on e.encntr_id =ea.encntr_id left outer join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate)  where MRN in (select alias from person_alias where person_id=?) and BILLING_NUMBER=ea.alias  order by sortOredr desc , b.Folder, c.DocTitle

chartsoft.flename= select FILE_NAME as FILENAME from index_softmed WHERE ARCDOC_ID=? and mrn=? and billing_number=?

patient.VisitList= select get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, case when to_char(e.reg_dt_tm,'HH24:MI') = '00:00' then to_char(e.reg_dt_tm,'MM/DD/YYYY') else to_char(e.reg_dt_tm,'MM/DD/YYYY HH24:MI:SS') end as Reg_dt_tm, case when to_char(e.disch_dt_tm,'HH24:MI') = '00:00' then to_char(e.disch_dt_tm,'MM/DD/YYYY') else to_char(e.disch_dt_tm,'MM/DD/YYYY HH24:MI:SS') end as Disch_dt_tm, get_cd_value(e.med_service_cd, 'display') as Medical_service, get_cd_value(e.loc_facility_cd, 'display') as Facility, case when e.loc_room_cd>0 then case when e.loc_bed_cd>0 then concat(concat(concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display')),';'),get_cd_value(e.loc_bed_cd, 'display')) else (concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display'))) end else get_cd_value(e.loc_nurse_unit_cd, 'display') end as location, ea.alias as Acct,ap.format_mask as FIN_format, e.encntr_id as Encntr_id, e.reason_for_visit, get_cd_value(e.admit_src_cd, 'display') as AdmitSource, get_cd_value(e.financial_class_cd, 'display') as FinancialClass, get_cd_value(e.disch_disposition_cd, 'display') as DischDisposition, get_cd_value(e.accommodation_cd, 'display') as Accomadation, p.name_full_formatted as ProviderName from encounter e join encntr_alias ea on (ea.encntr_id=e.encntr_id and ea.active_ind=1 and ea.encntr_alias_type_cd=91) left outer join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) left outer join encntr_prsnl_reltn epr on(epr.encntr_id = e.encntr_id and epr.encntr_prsnl_r_cd = 3430 and epr.end_effective_dt_tm >sysdate) left outer join prsnl p on(p.person_id = epr.prsnl_person_id) where e.active_ind=1 and e.end_effective_dt_tm>sysdate and  e.person_id=? and e.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where  por.person_id=? and  por.active_ind =1 and por.end_effective_dt_tm >sysdate) order by e.reg_dt_tm desc, e.encntr_id

patient.VisitListReltn= select epr.encntr_person_reltn_id as EncntrPersonReltnId, get_cd_value(epr.person_reltn_type_cd, 'display') as Type,p.name_full_formatted as Name, get_cd_value(epr.person_reltn_cd, 'display') as relation, get_cd_value(ph.phone_type_cd, 'display') as PhoneType, ph.phone_num as PhoneNumber,a.street_addr as StreetAddress ,a.city as City, a.state as State ,a.zipcode as Zipcode, case when a.street_addr is not null then concat(a.street_addr, concat(' <br/> ', concat(a.city, concat(', ', concat(a.state, concat(' ', a.zipcode)))))) else '' end as home_addr from encntr_person_reltn epr left outer join person p on(p.person_id = epr.related_person_id and p.active_ind = 1) left outer join address a on(a.parent_entity_id = p.person_id and  a.parent_entity_name = 'PERSON' and a.address_type_cd = 288.00 and a.end_effective_dt_tm >sysdate and a.active_ind = 1) left outer join phone ph on(ph.parent_entity_id = p.person_id and ph.parent_entity_name = 'PERSON' and  ph.active_ind = 1 and ph.phone_type_cd  in(3844,3836) and ph.end_effective_dt_tm >sysdate) where epr.encntr_id = ? and epr.active_ind =1 and epr.end_effective_dt_tm> sysdate order by epr.priority_seq, epr.encntr_person_reltn_id, a.address_type_seq desc,ph.phone_type_seq desc

ioReportPerPatient= SELECT  DISTINCT E.PERSON_ID, E.ENCNTR_ID, get_cd_value(E.LOC_FACILITY_CD, 'description') as FAC, get_cd_value(E.LOC_NURSE_UNIT_CD, 'display') as UNIT, get_cd_value(E.LOC_ROOM_CD, 'display') as ROOM, get_cd_value(E.LOC_BED_CD, 'display') as BED, to_char(E.REG_DT_TM, 'mm/dd/yyyy') as REG_DT_TM, EP.PRSNL_PERSON_ID, to_char(P.BIRTH_DT_TM,'mm/dd/yyyy') as BIRTH_DT_TM, P.SEX_CD, SUBSTR(EA1.ALIAS,1,15) as FIN, to_char(case when p.DECEASED_DT_TM is null then sysdate else p.DECEASED_DT_TM end,'mm/dd/yyyy') as DECEASED_DT_TM, SUBSTR(EA2.ALIAS,1,15) as MRN, SUBSTR(P.NAME_FULL_FORMATTED, 1,40) as PATIENT_NAME, SUBSTR(PR.NAME_FULL_FORMATTED,1,40) as ATTEND_DOC, case when A.CITY is null then get_cd_value(A.CITY_CD, 'display') else A.CITY end as city, case when A.STATE is null or A.STATE = ' ' then get_cd_value(A.STATE_CD, 'display') else A.STATE end as state, CONCAT(concat(TRIM(get_cd_value(E.LOC_NURSE_UNIT_CD, 'display')), ' '),CONCAT(TRIM(get_cd_value(E.LOC_ROOM_CD, 'display')), CONCAT('-', get_cd_value(E.LOC_BED_CD, 'display')))) as LOCATION FROM  ENCNTR_ALIAS EA1 join ENCOUNTER E on (E.ENCNTR_ID = ea1.encntr_id and e.loc_nurse_unit_cd > 0 and e.loc_room_cd > 0 and e.loc_bed_cd > 0 AND E.ENCNTR_TYPE_CD != 7444) join ENCNTR_PRSNL_RELTN EP on (EP.ENCNTR_ID = E.ENCNTR_ID AND EP.ENCNTR_PRSNL_R_CD = 3432 AND EP.ACTIVE_IND = 1 and ep.end_effective_dt_tm > sysdate) left outer join ENCNTR_ALIAS EA2 on (EA2.ENCNTR_ID = E.ENCNTR_ID and EA2.ENCNTR_ALIAS_TYPE_CD = 93 and ea2.active_ind = 1 and ea2.end_effective_dt_tm > sysdate) left outer join ADDRESS A on (A.PARENT_ENTITY_ID = E.ORGANIZATION_ID and a.parent_entity_name = 'ORGANIZATION') join PERSON P on (P.PERSON_ID = E.PERSON_ID) join PRSNL PR on (PR.PERSON_ID = EP.PRSNL_PERSON_ID) where ea1.alias = ? and ea1.encntr_alias_type_cd = 91 and ea1.alias_pool_cd = ? ORDER by E.ENCNTR_ID

ioReportPerPatientTable= SELECT to_char(CE.EVENT_END_DT_TM,'MM/DD/YYYY') as event_date,  to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) as event_time, case when (to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) >= 0 AND to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) < 700) then 1	ELSE  case when (to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) >= 700 AND to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) < 1500) then 2 else  case when (to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) >= 1500 AND to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) <= 2359) then 3 END END END as category, case when (to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) >= 0 AND to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) < 700) then  CONCAT(to_char(CE.EVENT_END_DT_TM,'MM/DD/YYYY'),concat(' ','0000-0659')) else case when (to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) >= 700 AND to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) < 1500) then  CONCAT(to_char(CE.EVENT_END_DT_TM,'MM/DD/YYYY'),concat(' ','0700-1459')) else case when (to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) >= 1500 AND to_number(to_char(CE.EVENT_END_DT_TM,'HH24MI')) <= 2359) then  CONCAT(to_char(CE.EVENT_END_DT_TM,'MM/DD/YYYY'),concat(' ','1500-2359')) end end end as EVENT_DT_CATEGORY, round(to_number(CE.RESULT_VAL)) as result_value, case when (ES.EVENT_SET_NAME IN('ORAL','ICE CHIPS', 'SUPPLEMENT INTAKE','TUBE FEED INTAKE', 'IV FLUIDS','IV DRIPS','BLOOD PRODUCTS','GI INTAKE','GU INTAKE','Administration Information','IV Parenteral')) then 1 ELSE case when (ES.EVENT_SET_NAME IN('OSTOMY','FOLEY','LIQUID STOOL','OSTOMY STOOL','VOIDED','EMESIS VOL','NG DRAINAGE', 'GASTRIC OTHER','DRAINS/TUBES','BLOOD OUTPUT','OUTPUT OTHER'))then 2 end end as seq_flag, case when (ES.EVENT_SET_NAME IN( 'ORAL','ICE CHIPS','SUPPLEMENT INTAKE')) then 'Oral Intake' else case when (ES.EVENT_SET_NAME =	'TUBE FEED INTAKE') then 'Tube Feedings' else case when (ES.EVENT_SET_NAME in ('IV FLUIDS','IV Parenteral'	)) then 'IV Parenteral' else case when (ES.EVENT_SET_NAME =	'Administration Information') then 'Continuous Infusions' else case when (ES.EVENT_SET_NAME =	'IV DRIPS') then 'IV Drips' else case when (ES.EVENT_SET_NAME =	'BLOOD PRODUCTS') then 'Blood Products' else case when (ES.EVENT_SET_NAME =	'GI INTAKE') then 'GI Intake' else case when (ES.EVENT_SET_NAME = 'GU INTAKE') then 'GU Intake' else case when (ES.EVENT_SET_NAME IN ('OSTOMY','FOLEY','VOIDED')) then 'Urine' else case when (ES.EVENT_SET_NAME IN ('LIQUID STOOL','OSTOMY STOOL')) then 'Stool' else case when (ES.EVENT_SET_NAME in ('EMESIS VOL')) then 'Emesis' else case when (ES.EVENT_SET_NAME IN( 'NG DRAINAGE','GASTRIC OTHER')) then 'NG Gastric' else case when (ES.EVENT_SET_NAME = 	'DRAINS/TUBES') then 'Drains Tubes' else case when (ES.EVENT_SET_NAME = 	'BLOOD OUTPUT') then 'Blood Output' else case when (ES.EVENT_SET_NAME = 	'OUTPUT OTHER') then 'Output Other' end end end end end end end end end end end end end end end as event_set, case when (ES.EVENT_SET_NAME IN( 'ORAL','ICE CHIPS','SUPPLEMENT INTAKE')) then 1 else case when (ES.EVENT_SET_NAME = 'TUBE FEED INTAKE') then 2 else case when (ES.EVENT_SET_NAME in ('IV FLUIDS','IV Parenteral')) then 3 else case when (ES.EVENT_SET_NAME = 	'Administration Information') then 4 else case when (ES.EVENT_SET_NAME = 	'IV DRIPS') then 5 else case when (ES.EVENT_SET_NAME = 	'BLOOD PRODUCTS') then 6 else case when (ES.EVENT_SET_NAME = 	'GI INTAKE') then 7 else case when (ES.EVENT_SET_NAME = 	'GU INTAKE') then 8 else case when (ES.EVENT_SET_NAME IN( 	'OSTOMY','FOLEY','VOIDED')) then 1 else case when (ES.EVENT_SET_NAME IN( 	'LIQUID STOOL','OSTOMY STOOL')) then 2 else case when (ES.EVENT_SET_NAME in(	'EMESIS VOL')) then 3 else case when (ES.EVENT_SET_NAME IN( 'NG DRAINAGE','GASTRIC OTHER')) then 4 else case when (ES.EVENT_SET_NAME = 	'DRAINS/TUBES') then 5 else case when (ES.EVENT_SET_NAME = 	'BLOOD OUTPUT') then 6 else case when (ES.EVENT_SET_NAME = 	'OUTPUT OTHER') then 7 end end end end end end end end end end end end end end end as sub_seq_flag FROM V500_EVENT_SET_CODE ES  join V500_EVENT_SET_EXPLODE ESE on (es.event_set_cd = ese.event_set_cd)  join V500_EVENT_CODE EC on (ese.event_cd = ec.event_cd and ec.event_cd not in (56755, 57305)) join CLINICAL_EVENT CE on (ce.encntr_id = ? and ec.event_cd = ce.event_cd and ce.result_val > ' ' and  ce.valid_until_dt_tm > sysdate and ce.result_status_cd != 606) where es.event_set_name in('ORAL','ICE CHIPS','SUPPLEMENT INTAKE','TUBE FEED INTAKE','IV FLUIDS','IV DRIPS','BLOOD PRODUCTS', 'GI INTAKE','GU INTAKE','DRAINS/TUBES','BLOOD OUTPUT','OUTPUT OTHER','OSTOMY','FOLEY','LIQUID STOOL','OSTOMY STOOL','VOIDED', 'EMESIS VOL','NG DRAINAGE','GASTRIC OTHER','Administration Information','IV Parenteral') AND  ES.EVENT_SET_CD != 24135639 AND ES.CODE_STATUS_CD = 1623 ORDER BY to_date(event_date,'MM/DD/YYYY') DESC, EVENT_DT_CATEGORY DESC, seq_flag, sub_seq_flag

CCL7.Demographics= SELECT DISTINCT E.PERSON_ID, E.ENCNTR_ID, get_cd_value(E.loc_building_cd, 'description') as MainLoc, get_cd_value(E.LOC_FACILITY_CD, 'description') as FAC, get_cd_value(E.LOC_NURSE_UNIT_CD, 'display') as UNIT, get_cd_value(E.LOC_ROOM_CD, 'display') as ROOM, get_cd_value(E.LOC_BED_CD, 'display') as BED, to_char(E.REG_DT_TM,'MM/DD/YY HH24:MI:SS') as Admit_dt, to_char(E.DISCH_DT_TM, 'MM/DD/YY HH24:MI:SS') as Disch_dt, EP.PRSNL_PERSON_ID, to_char(P.BIRTH_DT_TM, 'MM/DD/YY') as birth_dt_tm, to_char(P.BIRTH_DT_TM, 'MM/DD/YYYY') as dob_full, to_char(E.REG_DT_TM, 'MM/DD/YYYY') as reg_dt_tm, to_char(case when p.deceased_dt_tm is null then sysdate else p.deceased_dt_tm end, 'MM/DD/YYYY') as deceased_dt_tm, P.SEX_CD, get_cd_value(p.sex_cd, 'display') as gender, SUBSTR(ea1.ALIAS,1,15) as FIN, SUBSTR(EA2.ALIAS,1,15) as MRN, ea1.alias_pool_cd as Pt_SITE, SUBSTR(P.NAME_FULL_FORMATTED,1,40) as PATIENT_NAME, SUBSTR(PR.NAME_FULL_FORMATTED,1,40) as ATTEND_DOC, case when A.CITY is null then get_cd_value(a.city_cd, 'display') else a.city end as city, case when A.STATE is null or A.STATE = ' ' then get_cd_value(a.state_cd, 'display') else a.state end as state FROM ENCNTR_ALIAS ea1 join ENCOUNTER E on (E.ENCNTR_ID = ea1.ENCNTR_ID AND E.ENCNTR_TYPE_CD != 7444 and e.loc_facility_cd in (?)) join ENCNTR_PRSNL_RELTN EP on (EP.ENCNTR_ID = E.ENCNTR_ID AND EP.ENCNTR_PRSNL_R_CD = 3432 AND EP.ACTIVE_IND = 1 and ep.end_effective_dt_tm > sysdate) left outer join ENCNTR_ALIAS EA2 on (EA2.ENCNTR_ID = E.ENCNTR_ID and EA2.ENCNTR_ALIAS_TYPE_CD = 93) left outer join ADDRESS A on (A.PARENT_ENTITY_ID = E.ORGANIZATION_ID and A.ADDRESS_TYPE_CD = 286 and A.PARENT_ENTITY_NAME = 'ORGANIZATION' and A.end_effective_dt_tm > sysdate) join PERSON P on (P.PERSON_ID = E.PERSON_ID) join PRSNL PR on (PR.PERSON_ID = EP.PRSNL_PERSON_ID) where ea1.alias = ? and ea1.encntr_alias_type_cd = 91 and ea1.alias_pool_cd = ?

CCL7.OrderSummary= SELECT Distinct O.ORDER_ID, o.current_start_dt_tm, to_char(O.ORIG_ORDER_DT_TM,'MM/DD/YY HH24:MI:SS') as Org_order_dt, O.ordered_as_mnemonic, case when (o.catalog_type_cd = 2605) then O.order_mnemonic else o.hna_order_mnemonic end as Order_name, o.clinical_display_line, length(o.clinical_display_line) as clinical_disp_length, o.catalog_type_cd, O.template_order_flag, O.template_order_id, get_cd_value(o.order_status_cd, 'display') as ORDER_STATUS, get_cd_value(o.catalog_type_cd, 'display') as ORD_CAT_TYPE, get_cd_value(O.ACTIVITY_TYPE_CD, 'display') as O_ACTIVITY_TYPE_DISP, get_cd_value(OA.action_type_cd, 'display') as Order_action, get_cd_value(oa.communication_type_cd, 'display') as COMM_TYPE, oa.communication_type_cd, PR.NAME_FULL_FORMATTED as Ordering_PHYSICIAN, to_char(OA.order_dt_tm,'MM/DD/YY HH24:MI:SS') as Ordered_dt_tm, PR.person_id as Ordering_Physician_id, substr(trim(PR1.NAME_FULL_FORMATTED),1,30) as ENTERED_BY, to_char(OA.action_dt_tm,'MM/DD/YY HH24:MI:SS') as Entered_dt_tm, PW.pathway_id, PW.description as PowerPlan_Name, 'PowerPlan:' as PowerPlan_label FROM ORDERS O join ORDER_ACTION OA on (OA.order_id = O.order_id and OA.action_type_cd = 1078.00 and oa.action_personnel_id != 21) join PRSNL PR on (PR.person_id = OA.order_provider_id) join PRSNL PR1 on (PR1.Person_id = OA.action_personnel_id) left outer join Act_PW_COMP APC on (APC.parent_entity_id = O.order_id and APC.parent_entity_name = 'ORDERS') left outer join Pathway PW on (PW.pathway_id = APC.pathway_id) where O.encntr_id = ? and O.template_order_flag IN (0,1) and o.ORDERABLE_TYPE_FLAG not in (2,6) and O.orig_ord_as_flag not in (4) order by O.CURRENT_START_DT_TM, Order_name

CCL7.NurseReview= Select Distinct to_char(ore.review_dt_tm, 'MM/DD/YY HH24:MI:SS') as nurse_date_time, 'Nurse Review: ' as nurse_review_label, pr2.name_full_formatted as nurse_prsnl, ore.action_sequence, ore.review_sequence From order_review ore join prsnl pr2 on (PR2.person_id = ore.review_personnel_id) Where ORE.order_id = ? and ore.review_type_flag = 1 and ore.reviewed_status_flag = 1 and ore.action_sequence = (select max(ore1.action_sequence) from order_review ore1 where ore1.order_id = ore.order_id and ore1.review_type_flag = 1 and ore1.reviewed_status_flag = 1) and ore.review_sequence = (select max(ore2.review_sequence) from order_review ore2 where ore2.order_id = ore.order_id and ore2.review_type_flag = 1 and ore2.reviewed_status_flag = 1 and ore2.action_sequence = ore.ACTION_SEQUENCE) order by ore.action_sequence desc

CCL7.CDReason= Select Distinct od.oe_field_display_value as cancel_discontinue_reason From order_detail od Where od.order_id = ? and od.action_sequence = 2 and od.oe_field_id in (6305, 14875062)

CCL7.OrderDetail= SELECT distinct o.order_id, od.detail_sequence, oef.label_text, oef.clin_line_label, oef.group_seq, oef.field_seq, od.oe_field_id, od.action_sequence, ef.field_type_flag, ',' as Space1, od.OE_FIELD_DISPLAY_VALUE, length(OD.OE_FIELD_DISPLAY_VALUE) as OD_TextLen, concat(trim(oef.label_text),concat(': ', trim(od.OE_FIELD_DISPLAY_VALUE))) as d_line from orders o join order_action oa on (oa.order_id = o.order_id and oa.action_sequence = o.last_action_sequence) join order_detail od on (od.order_id = o.order_id) join oe_format_fields oef on (oef.oe_format_id = o.oe_format_id and oef.oe_field_id = od.oe_field_id and oef.clin_line_ind = 1 and (oef.action_type_cd = oa.action_type_cd or oef.action_type_cd = 1078)) join order_entry_fields ef on (ef.oe_field_id = oef.oe_field_id) WHERE O.order_id= ? order by O.order_id, od.detail_sequence

CCL7.OrderComments= Select O.order_id, O.order_comment_ind, oc.display_mask, get_cd_value(oc.comment_type_cd, 'display') as Com_type, l.long_text as order_comment From Orders O join order_comment oc on (oc.order_id = O.order_id and oc.comment_type_cd IN(5871, 5873)) join long_text l on (l.long_text_id = oc.long_text_id and l.active_ind = 1 and l.active_status_cd = 1623) where O.order_id = ? and O.template_order_flag IN(0,1) and o.ORDERABLE_TYPE_FLAG not in (2,6) order by oc.action_sequence desc, oc.comment_dt_tm desc

CCL8.CarePlanQ2= (select P.PERSON_ID, P.ENCNTR_ID, P.PATHWAY_ID, P.PW_GROUP_NBR, P.PW_CAT_GROUP_ID, P.PATHWAY_TYPE_CD, P.PATHWAY_CATALOG_ID, P.ACTIVE_IND, apc.SEQuence as seq, P.DESCRIPTION, get_cd_value(P.PW_STATUS_CD, 'display') as P_PW_STATUS_DISP, get_cd_value(P.PATHWAY_TYPE_CD, 'display') as P_PATHWAY_TYPE_DISP, to_char(P.start_dt_tm, 'DD/MON/YYYY HH24:MI:SS') as PW_Start_dt_tm, case when P.discontinued_dt_tm is not null then to_char(sysdate, 'DD/MON/YYYY "23:59:59"') else to_char(P.discontinued_dt_tm, 'DD/MON/YYYY HH24:MI:SS') end as PW_discontinue_dt_tm, PL2.name_full_formatted as Entered_By, get_cd_value(PA1.communication_type_cd, 'display') as Communication_Type, get_cd_value(PA1.action_type_cd, 'display') as Action_type, PA1.provider_id, PL3.name_full_formatted as Ordering_Provider, to_char(PA1.action_dt_tm,'DD-MON-YYYY HH24:MI:SS') as PA_Stop_Action_dt_tm, APC.ACT_PW_COMP_ID, get_cd_value(APC.DCP_CLIN_CAT_CD, 'display') as CLIN_CAT_DISP, get_cd_value(apc.dcp_clin_sub_cat_cd, 'display') as CLIN_SUB_CAT_DISP, APC.COMP_LABEL, APC.parent_entity_id, APC.parent_entity_name, APC.ACTIVE_IND, lt.long_text as long_text From PATHWAY P join Act_PW_COMP  APC on (APC.PATHWAY_ID =  P.Pathway_id and APC.active_ind >0 and APC.comp_status_cd IN(14860296, 14860299) and APC.parent_entity_id > 0 and APC.parent_entity_name NOT IN('PATHWAY')) join Pathway_action PA1 on (PA1.pathway_id = P.pathway_id and PA1.action_type_cd IN(14860303)) left outer join PRSNL PL2 on (PL2.person_id = PA1.action_prsnl_id) left outer join PRSNL PL3 on (PL3.person_id = PA1.provider_id) left outer join LONG_TEXT lt on (lt.long_text_id = APC.parent_entity_id) where P.ENCNTR_ID = ? and P.pw_status_cd NOT IN(14860295, 176658523, 53407010) and P.pathway_type_cd NOT IN(105673705)) union all (SELECT P.PERSON_ID, P.ENCNTR_ID, P.PATHWAY_ID, P.PW_GROUP_NBR, P.PW_CAT_GROUP_ID, p.pathway_type_cd, P.PATHWAY_CATALOG_ID, P.ACTIVE_IND, PC.SEQUENCE as seq, P.DESCRIPTION, get_cd_value(P.PW_STATUS_CD, 'display') as P_PW_STATUS_DISP, get_cd_value(p.pathway_type_cd, 'display') as p_pathway_type_disp, to_char(P.start_dt_tm, 'DD/MON/YYYY HH24:MI:SS') as PW_Start_dt_tm, to_char(P.discontinued_dt_tm, 'DD/MON/YYYY HH24:MI:SS') as pw_discontinue_dt_tm, PL2.name_full_formatted as Entered_By, get_cd_value(PAA.communication_type_cd, 'display') as Communication_Type, get_cd_value(PAA.action_type_cd, 'display') as Action_type, PAA.provider_id, PL3.name_full_formatted as Ordering_Provider, to_char(PAA.action_dt_tm,'DD/MON/YY HH24:MI:SS') as PA_Stop_Action_dt_tm, PC.pathway_comp_id as act_pw_comp_id, get_cd_value(PC.dcp_clin_cat_cd, 'display') as Clin_cat_DISP, get_cd_value(PC.dcp_clin_sub_cat_cd, 'display') as Clin_sub_cat_DISP, PC.COMP_LABEL, PC.PARENT_ENTITY_ID, 'NOTES' as PARENT_ENTITY_NAME, APC.ACTIVE_IND, l.long_text as long_text FROM Pathway P join ACT_PW_COMP APC on (APC.pathway_id = P.pathway_id and APC.active_ind >0 and APC.comp_type_cd = 14860285) join PATHWAY_COMP PC on (PC.pathway_comp_id = APC.pathway_comp_id and PC.COMP_TYPE_CD = 14860285 and PC.active_ind = 1 and PC.persistent_ind = 1) join LONG_TEXT  L on (L.long_text_id = APC.parent_entity_id) left outer join Pathway_action PAA on (PAA.pathway_id = P.pathway_id and PAA.action_type_cd = 14860303.00) left outer join PRSNL PL2 on (PL2.person_id = PAA.action_prsnl_id) left outer join PRSNL PL3 on (PL3.person_id = PAA.provider_id) where P.ENCNTR_ID = ? and P.pw_status_cd NOT IN(14860295, 176658523, 53407010) and P.pathway_type_cd NOT IN(105673705) and P.start_dt_tm < sysdate) order by PERSON_ID, pathway_id, Clin_cat_DISP, Clin_sub_cat_DISP, seq, parent_entity_name desc

CCL8.CarePlanQ3= SELECT P.PATHWAY_ID, P.PW_GROUP_NBR, p.pathway_type_cd, get_cd_value(p.pathway_type_cd, 'display') as p_pathway_type_disp, P.PATHWAY_CATALOG_ID, P.ACTIVE_IND, P.DESCRIPTION, get_cd_value(P.PW_STATUS_CD, 'display') as P_PW_STATUS_DISP, PL2.name_full_formatted as Entered_By, get_cd_value(PAA.communication_type_cd, 'display') as Communication_Type, get_cd_value(PAA.action_type_cd, 'display') as Action_type, PAA.provider_id, to_char(PAA.action_dt_tm,'DD/MON/YY HH24:MI:SS') as PA_Stop_Action_dt_tm, PC.pathway_comp_id as act_pw_comp_id, to_char(P.start_dt_tm, 'DD/MON/YYYY HH24:MI:SS') as PW_Start_dt_tm, to_char(P.discontinued_dt_tm, 'DD/MON/YYYY HH24:MI:SS') as pw_discontinue_dt_tm, PL3.name_full_formatted as Ordering_Provider, PC.ACTIVE_IND, PC.COMP_LABEL, get_cd_value(PC.COMP_TYPE_CD, 'display') as PC_COMP_TYPE_DISP, PC.persistent_ind, PC.SEQUENCE, PC.PARENT_ENTITY_ID, PC.PARENT_ENTITY_NAME, get_cd_value(PC.dcp_clin_cat_cd, 'display') as PC_Clin_cat_DISP, get_cd_value(PC.dcp_clin_sub_cat_cd, 'display') as PC_Clin_cat_sub_DISP, L.LONG_TEXT_ID, l.long_text FROM Pathway P join ACT_PW_COMP APC on (APC.pathway_id = P.pathway_id and APC.active_ind >0 and APC.comp_type_cd = 14860285) join PATHWAY_COMP PC on (PC.pathway_comp_id = APC.pathway_comp_id and PC.COMP_TYPE_CD = 14860285 and PC.active_ind = 1 and PC.persistent_ind = 1) join LONG_TEXT  L on (L.long_text_id = APC.parent_entity_id) left outer join Pathway_action PAA on (PAA.pathway_id = P.pathway_id and PAA.action_type_cd = 14860303.00) left outer join PRSNL PL2 on (PL2.person_id = PAA.action_prsnl_id) left outer join PRSNL PL3 on (PL3.person_id = PAA.provider_id) where P.ENCNTR_ID = ? and P.pw_status_cd NOT IN(14860295, 176658523, 53407010) and P.pathway_type_cd NOT IN(105673705) and P.start_dt_tm < sysdate order by P.PATHWAY_ID, P.pw_group_nbr, P.PW_CAT_GROUP_ID, PC.SEQUENCE

CCL8.CarePlanQ4= Select distinct OA.outcome_activity_id, Trim(OA.description) as OA_Description, ot.dcp_forms_ref_id, get_cd_value(OA.event_cd, 'display') as Event_CD_Desc, get_cd_value(OA.task_assay_cd, 'display') as Task_Assay_CD_Desc, OA.event_cd, OA.task_assay_cd, OA.expectation, get_cd_value(OA.target_type_cd, 'display') as Target_type, dfr.description as dfr_description, case when trim(get_cd_value(OA.target_type_cd, 'display')) is not null then get_cd_value(OA.target_type_cd, 'display') else 'By Phase End' end as APC_Outcome_target_type, get_cd_value(OA.outcome_status_cd, 'display') as Outcome_status, to_char(OA.outcome_status_dt_tm, 'DD/MON/YY HH24:MI:SS') as Status_dt_tm, get_cd_value(OAA.outcome_status_cd, 'display') as Outcome_action_status, to_char(OAA.outcome_status_dt_tm,'DD/MON/YY HH24:MI:SS') as Outcome_status_date, OAA.action_seq From Outcome_Activity OA left outer join Outcome_Action OAA on (OAA.outcome_activity_id = OA.outcome_activity_id) left outer join OUTCOME_CATALOG OTC on (OTC.outcome_catalog_id = OA.outcome_catalog_id and OTC.active_ind = 1) left outer join ORDER_TASK OT on (OT.reference_task_id = OTC.reference_task_id and OT.reference_task_id > 0 and OT.active_ind = 1) left outer join DCP_forms_ref DFR on (DFR.dcp_forms_ref_id = OT.dcp_forms_ref_id and DFR.active_ind = 1 and DFR.BEG_EFFECTIVE_DT_TM <= sysdate+1 AND DFR.END_EFFECTIVE_DT_TM >= sysdate) WHERE OA.outcome_activity_id in (select APC.parent_entity_id From PATHWAY P join Act_PW_COMP APC on (APC.PATHWAY_ID = P.Pathway_id and APC.active_ind >0 and APC.comp_status_cd IN(14860296, 14860299) and APC.parent_entity_id > 0 and APC.parent_entity_name NOT IN('PATHWAY') and apc.parent_entity_name = 'OUTCOME_ACTIVITY') join Pathway_action PA1 on (PA1.pathway_id = P.pathway_id and PA1.action_type_cd IN(14860303)) where P.ENCNTR_ID = ? and P.pw_status_cd NOT IN(14860295, 176658523, 53407010) and P.pathway_type_cd NOT IN(105673705)) Order by OA.outcome_activity_id, OAA.action_seq

CCL8.CarePlanQ5= Select O.order_id, O.hna_order_mnemonic, O.order_detail_display_line, get_cd_value(O.order_status_cd, 'display') as Order_status, OA.action_type_cd, PR.name_full_formatted as Ordered_By, PR2.name_full_formatted as Entered_By, to_char(OA.effective_dt_tm, 'DD/MON/YYYY HH24:MI:SS') as effective_dt_tm, to_char(OA.effective_dt_tm, 'DD-MON-YYYY HH24:MI:SS') as effective_dt_tm2, o.order_comment_ind,O.hna_order_mnemonic,O.clinical_display_line, l.long_text, concat(trim(O.hna_order_mnemonic), concat(': ', trim(O.clinical_display_line))) as APC_parent_entity_result From Orders O join Order_Action OA on (OA.order_id = O.order_id and OA.action_type_cd = 1078) join PRSNL PR on (PR.person_id = OA.order_provider_id) join PRSNL PR2 on (PR2.person_id = OA.action_personnel_id) left outer join order_comment oc on (oc.order_id = o.order_id) left outer join long_text l on (l.long_text_id = oc.long_text_id and l.active_ind = 1 and l.active_status_cd = 1623) Where O.order_id in (select APC.parent_entity_id From PATHWAY P join Act_PW_COMP APC on (APC.PATHWAY_ID =  P.Pathway_id and APC.active_ind >0 and APC.comp_status_cd IN(14860296, 14860299) and APC.parent_entity_id > 0 and APC.parent_entity_name NOT IN('PATHWAY') and apc.parent_entity_name = 'ORDERS') join Pathway_action PA1 on (PA1.pathway_id = P.pathway_id and PA1.action_type_cd IN(14860303)) where P.ENCNTR_ID = ? and P.pw_status_cd NOT IN(14860295, 176658523, 53407010) and P.pathway_type_cd NOT IN(105673705))

CCL8.CarePlanQ6= SELECT C.CLINICAL_EVENT_ID, C.event_id, to_char(C.CLINSIG_UPDT_DT_TM,'MM/DD/YY HH24:MI:SS') as ClinSig_dt, C.ENCNTR_ID, get_cd_value(C.ENTRY_MODE_CD, 'display') as C_ENTRY_MODE_DISP, get_cd_value(C.EVENT_CD, 'display') as C_EVENT_DISP, C.EVENT_CD, get_cd_value(C.EVENT_CLASS_CD, 'display') as C_EVENT_CLASS_DISP, c.event_end_dt_tm as event_end_dt_tm, get_cd_value(C.EVENT_RELTN_CD, 'display') as C_EVENT_RELTN_DISP, to_char(C.EVENT_START_DT_TM, 'DD/MON/YY HH24:MI:SS') as Event_start_dt, C.EVENT_TAG, C.EVENT_TAG_SET_FLAG, C.EVENT_TITLE_TEXT, to_char(C.EXPIRATION_DT_TM,'DD/MON/YY HH24:MI:SS') as Expire_dt, C.PARENT_EVENT_ID, to_char(C.PERFORMED_DT_TM, 'DD/MON/YY HH24:MI:SS') as Performed_dt, to_char(C.PERFORMED_DT_TM, 'DD-MON-YYYY HH24:MI:SS') as Performed_dt2, to_char(C.VERIFIED_DT_TM,'DD/MON/YY HH24:MI:SS') as Verified_dt, to_char(C.VALID_FROM_DT_TM,'DD/MON/YY HH24:MI:SS') as Valid_from, to_char(C.VALID_UNTIL_DT_TM,'DD/MON/YY HH24:MI:SS') as Valid_until, C.PERFORMED_PRSNL_ID, P1.name_full_formatted as Perfomed_by, C.PERSON_ID, C.PUBLISH_FLAG, get_cd_value(C.QC_REVIEW_CD, 'display') as C_QC_REVIEW_DISP, get_cd_value(C.RECORD_STATUS_CD, 'display') as C_RECORD_STATUS_DISP, get_cd_value(C.RESULT_TIME_UNITS_CD, 'display') as C_RESULT_TIME_UNITS_DISP, get_cd_value(C.RESULT_UNITS_CD, 'display') as C_RESULT_UNITS_DISP, C.RESULT_VAL, C.SERIES_REF_NBR, get_cd_value(C.SOURCE_CD, 'display') as C_SOURCE_DISP, C.VERIFIED_PRSNL_ID, C.VIEW_LEVEL, P.pw_variance_reltn_id, P.PARENT_ENTITY_ID as Variance_Parent_entityid, P.PARENT_ENTITY_NAME as Variance_Parent_entityname, get_cd_value(P.variance_type_cd, 'display') as Var_Type, get_cd_value(P.ACTION_CD, 'display') as Action_Var, P.action_text_id as Action_freetx, get_cd_value(P.REASON_CD, 'display') as Reason_Var, P.reason_text_id as Reason_freetx, P.note_text_id, P.REASON_CD, P.ACTION_CD, lt.long_text as lt_long_text, lt1.long_text as lt1_long_text, lt2.long_text as lt2_long_text FROM CLINICAL_EVENT C join PRSNL P1 on (C.performed_prsnl_id = P1.person_id) left outer join PW_VARIANCE_RELTN P on (P.event_id = C.event_id) left outer join Long_Text lt on (Lt.long_text_id = P.note_text_id) left outer join Long_Text lt1 on (lt1.long_text_id = P.action_text_id) left outer join Long_Text lt2 on (lt2.long_text_id = P.reason_text_id) Where C.ENCNTR_ID = ? and C.event_cd = ? and c.event_end_dt_tm between to_date(?, 'DD/MON/YYYY HH24:MI:SS') and to_date(?, 'DD/MON/YYYY HH24:MI:SS') and C.view_level = 1 and C.event_tag != 'In Error' and c.result_status_cd in (601,607) order by C.PERFORMED_DT_TM

ccl10.resourceGroup= SELECT s.description as resName, S.RES_GROUP_ID as resId FROM CODE_VALUE CV_FAC join SCH_RES_GROUP  S  on (S.MNEMONIC_KEY like ? AND S.BEG_EFFECTIVE_DT_TM<= sysdate AND S.END_EFFECTIVE_DT_TM> sysdate AND S.ACTIVE_IND=1) WHERE CV_FAC.CODE_SET=220 AND CV_FAC.display_key = ? AND CV_FAC.CDF_MEANING='FACILITY' AND CV_FAC.DATA_STATUS_CD=601.00 AND CV_FAC.BEGIN_EFFECTIVE_DT_TM<=sysdate AND CV_FAC.END_EFFECTIVE_DT_TM> sysdate AND CV_FAC.ACTIVE_IND=1 ORDER BY S.MNEMONIC

ccl10.getFacRes= SELECT S.MNEMONIC , get_cd_value(?, 'description') as FAC from SCH_RES_GROUP S   where res_group_id=? 

ccl10.emergencyCaseSchedule= SELECT S.MNEMONIC, get_cd_value(E.LOC_FACILITY_CD, 'description') as FAC, sc.person_id, get_cd_value(SC.SCHED_PAT_TYPE_CD, 'display') as PAT_TYPE,  case when e.loc_room_cd > 0 then trim(concat(concat(trim(sed6.oe_field_display_value),' / '),concat(concat(trim(get_cd_value(e.loc_room_cd,'description')),',  '),trim(get_cd_value(e.loc_bed_cd, 'description'))))) else trim(sed6.oe_field_display_value) end as pat_data, lt.long_text as Public_Comment, SUBSTR(SED8.OE_FIELD_DISPLAY_VALUE,1,3) as LATEX, get_cd_value(SC.SCHED_OP_LOC_CD,'display') as RESOURCE_DISP, get_cd_value(SC.SCHED_OP_LOC_CD, 'description') as RES_DESC, SUBSTR(SED.OE_FIELD_DISPLAY_VALUE,1,60) as VISIT_REASON, to_char(SC.SCHED_START_DT_TM,  'hh24:Mi') as Scheduled_hr, to_char(SC.SCHED_START_DT_TM,  'MM/DD/YYYY') as Scheduled_Date_Time, SC.SCHED_DUR as Duration, SC.SCH_EVENT_ID , get_cd_value(e.encntr_type_cd, 'description') as encntr_type, get_cd_value(e.loc_room_cd, 'description') as room, get_cd_value(e.loc_bed_cd, 'description') as bed, SC.SCHED_SURG_AREA_CD ,SC.SURG_CASE_ID as CASE_ID,SC.PERSON_ID as PERSON_ID, SED7.OE_FIELD_DISPLAY_VALUE as REFER_MD,SC.SCHED_ANESTH_PRSNL_ID as ANESTH_ID,P.NAME_FULL_FORMATTED as ANESTH_MD,SCP.ORDER_ID   ,SCP.PRIMARY_PROC_IND as Primary_ind, get_cd_value(SCP.SCHED_SURG_PROC_CD, 'description') as PROCEDURE, case when scp.sched_surg_proc_cd > 0 then get_cd_value(SCP.SCHED_SURG_PROC_CD, 'description') else get_cd_value(SCP.SURG_PROC_CD, 'description') end as sch_order, SUBSTR(SCP.PROC_TEXT,1,95) AS PROC_TEXT, SCP.SURG_CASE_ID  as SURG_CASE_ID, case when scp.sched_primary_surgeon_id > 0 then P1.NAME_FULL_FORMATTED else P2.NAME_FULL_FORMATTED end as PRIMARY_MD, SUBSTR(SCP.SCHED_MODIFIER,1,50) as MODIFIER,	 get_cd_value(SCP.SCHED_ANESTH_TYPE_CD, 'display') as ANESTHESIA , scp.surg_case_proc_id, substr(OD2.OE_FIELD_DISPLAY_VALUE,1,20) as icu_req, od2.action_sequence as icu_req_action_seq, od2.oe_field_id, substr(OD1.OE_FIELD_DISPLAY_VALUE,1,25) as ass_phys, od1.action_sequence as ass_phys_action_seq, od1.oe_field_id,to_char( p3.birth_dt_tm , 'MM/DD/YYYY')as Birth_date, SUBSTR(P3.NAME_FULL_FORMATTED,1,35) as Name, get_cd_value(p3.sex_cd,'display') as Gender, pa.alias as MRN, ph.phone_num as Phone FROM SURGICAL_CASE SC  left outer join SCH_EVENT_DETAIL SED on (SED.SCH_EVENT_ID= SC.SCH_EVENT_ID AND SED.SCH_ACTION_ID >= 0 AND  SED.OE_FIELD_MEANING = 'REASONFOREXAM' AND SED.VERSION_DT_TM =  to_date('31-DEC-2100 00:00:00', 'DD-MON-YYYY HH24:MI:SS')) left outer join SCH_EVENT_DETAIL SED7 on (SED7.SCH_EVENT_ID = SC.SCH_EVENT_ID AND SED7.OE_FIELD_ID = 6282 AND  SED7.VERSION_DT_TM = to_date('31-DEC-2100 00:00:00','DD-MON-YYYY HH24:MI:SS')) left outer join SCH_EVENT_DETAIL SED8 on (SED8.SCH_EVENT_ID = SC.SCH_EVENT_ID AND SED8.OE_FIELD_ID = 15502344 AND  SED8.VERSION_DT_TM = to_date('31-DEC-2100 00:00:00','DD-MON-YYYY HH24:MI:SS')) left outer join sch_event_detail sed6 on (SED6.SCH_EVENT_ID = Sc.SCH_EVENT_ID AND SED6.OE_FIELD_ID = 14875055	AND  SED6.VERSION_DT_TM = to_date('31-DEC-2100 00:00:00','DD-MON-YYYY HH24:MI:SS')) left outer join SCH_EVENT_COMM SEC on (SEC.SCH_EVENT_ID = SC.SCH_EVENT_ID AND SEC.SCH_ACTION_ID = 0.00 AND SEC.TEXT_TYPE_CD = 5160 AND  SEC.SUB_TEXT_CD = 14860204   AND SEC.VERSION_DT_TM = to_date('31-DEC-2100 00:00:00','DD-MON-YYYY HH24:MI:SS')) left outer join LONG_TEXT LT on (LT.LONG_TEXT_ID = SEC.TEXT_ID AND LT.ACTIVE_IND = 1)  left outer join PERSON P on (P.PERSON_ID = SC.SCHED_ANESTH_PRSNL_ID AND P.ACTIVE_IND = 1) left outer join encounter e on (e.encntr_id = sc.encntr_id)  left outer join SURG_CASE_PROCEDURE SCP on(SCP.SURG_CASE_ID = SC.SURG_CASE_ID  and SCP.ACTIVE_IND = 1    ) left outer join person p1 on (P1.PERSON_ID = SCP.SCHED_PRIMARY_SURGEON_ID)  left outer join person p2 on (p2.person_id = scp.primary_surgeon_id) left outer join order_detail od1 on (OD1.ORDER_ID = scp.order_id  AND OD1.OE_FIELD_ID = 17656078 )  left outer join order_detail od2 on (OD2.ORDER_ID = scp.order_id  AND OD2.OE_FIELD_ID = 577829880)  left outer join person p3 on (p3.person_id = sc.person_id) left outer join person_alias pa on (PA.PERSON_ID = P3.PERSON_ID  AND  PA.PERSON_ALIAS_TYPE_CD= 2328  AND  PA.ACTIVE_IND = 1 AND  PA.ALIAS_POOL_CD =  ? AND  PA.END_EFFECTIVE_DT_TM > sysdate) left outer join phone ph on (ph.parent_entity_id = p3.person_id and ph.phone_type_cd = 3844 and ph.parent_entity_name = 'PERSON' and ph.active_ind = 1 and ph.active_status_cd = 1623 and Ph.END_EFFECTIVE_DT_TM > sysdate and ph.phone_type_seq = 1) left outer join SCH_RES_GROUP S on res_group_id=?  WHERE sc.sched_start_dt_tm between to_date(?, 'dd-mon-yyyy HH24:MI:SS') and  to_date(?,'dd-mon-yyyy HH24:MI:SS') AND SC.CANCEL_REASON_CD = 0 AND SC.ACTIVE_IND = 1 

print.PrintWhat= select c.category_name as parent_category, c.chart_category_id as parent_cat_id, c1.category_name as child_category, c1.chart_category_id as child_cat_id from emrp_chart_category c left outer join emrp_chart_category c1 on (c1.parent_category_id = c.chart_category_id and c1.active_ind = 1 and c1.end_effective_dt_tm > sysdate) where c.parent_category_id = 0 and c.chart_category_id != 0 and c.active_ind = 1 and c.end_effective_dt_tm > sysdate order by c.category_seq , c1.category_seq

print.destinations= select ppr.person_prsnl_reltn_id, get_cd_value(ppr.person_prsnl_r_cd, 'display'),ppr.prsnl_person_id, p.name_full_formatted, ppr.end_effective_dt_tm, concat(p.name_full_formatted, concat(' (', concat(get_cd_value(ppr.person_prsnl_r_cd, 'display'), ')'))) as disp from person_prsnl_reltn ppr join prsnl p on (p.person_id = ppr.prsnl_person_id) where ppr.person_id = ? and ppr.active_ind = 1 and ppr.end_effective_dt_tm = (select max(ppr1.end_effective_dt_tm) from person_prsnl_reltn ppr1 where ppr1.person_id = ppr.person_id and ppr1.prsnl_person_id = p.person_id) order by p.name_full_formatted, ppr.end_effective_dt_tm desc

print.EncntrWithDates= select get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, case when to_char(e.reg_dt_tm,'HH24:MI') = '00:00' then to_char(e.reg_dt_tm,'MM/DD/YYYY') else to_char(e.reg_dt_tm,'MM/DD/YYYY HH24:MI') end as Reg_dt_tm, case when to_char(e.disch_dt_tm,'HH24:MI') = '00:00' then to_char(e.disch_dt_tm,'MM/DD/YYYY') else to_char(e.disch_dt_tm,'MM/DD/YYYY HH24:MI') end as Disch_dt_tm, get_cd_value(e.med_service_cd, 'display') as Medical_service, get_cd_value(e.loc_facility_cd, 'display') as Facility, case when e.loc_room_cd>0 then case when e.loc_bed_cd>0 then concat(concat(concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display')),';'),get_cd_value(e.loc_bed_cd, 'display')) else (concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display'))) end else get_cd_value(e.loc_nurse_unit_cd, 'display') end as location, ea.alias as Acct,ap.format_mask as FIN_format, e.encntr_id as Encntr_id, get_cd_value(e.encntr_status_cd, 'display') as EncntrStatus, ea1.alias as ChartNum, eppa.PPR_CD as relation_cd from encounter e join encntr_alias ea on (ea.encntr_id=e.encntr_id and ea.active_ind=1 and ea.encntr_alias_type_cd=91) left outer join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) left outer join encntr_alias ea1 on(ea1.encntr_id=e.encntr_id and ea1.active_ind =1 and ea1.encntr_alias_type_cd= 14865492 and ea1.end_effective_dt_tm >sysdate) left outer join EMRP_PERSON_PRSNL_ACTIVITY eppa on (eppa.person_id = e.person_id and eppa.prsnl_id = ?) where e.person_id=? and e.active_ind =1 and e.end_effective_dt_tm >sysdate and e.reg_dt_tm between to_date(?,'dd-mon-yyyy hh24:mi:ss') and to_date(?,'dd-mon-yyyy hh24:mi:ss') and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id= ? and por.active_ind=1 and por.end_effective_dt_tm >sysdate) order by e.reg_dt_tm desc

print.OrgSearch= select o.org_name, o.organization_id from organization o where o.active_ind = 1 and o.end_effective_dt_tm > sysdate and o.beg_effective_dt_tm < sysdate	and o.org_class_cd != 962 and o.organization_id > 0 and o.data_status_cd = 601

print.OrgSearchWithAlias= select o.org_name as org_name, o.organization_id from Organization_Alias OA, Organization O where oa.active_ind = 1 and o.organization_id = oa.organization_id and o.active_ind = 1

print.demographicsWithEncntr= SELECT DISTINCT E.PERSON_ID, get_cd_value(e.encntr_type_cd, 'display') as enc_type, E.ENCNTR_ID, get_cd_value(E.loc_building_cd,'description') as MainLoc, get_cd_value(E.LOC_FACILITY_CD,'description') as FAC, get_cd_value(E.LOC_NURSE_UNIT_CD,'display') as UNIT, get_cd_value(E.LOC_ROOM_CD, 'display') as ROOM, get_cd_value(E.LOC_BED_CD,'display') as BED, to_char(E.REG_DT_TM,'MM/DD/YY HH24:MI:SS') as Admit_dt_tm, to_char(E.REG_DT_TM,'MM/DD/YYYY') as Admit_dt, to_char(E.DISCH_DT_TM, 'MM/DD/YY HH24:MI:SS') as Disch_dt_tm, to_char(E.DISCH_DT_TM, 'MM/DD/YYYY') as Disch_dt, EP.PRSNL_PERSON_ID, to_char(P.BIRTH_DT_TM, 'MM/DD/YY') as birth_dt_tm, to_char(P.BIRTH_DT_TM, 'MM/DD/YYYY') as dob_full, to_char(E.REG_DT_TM, 'MM/DD/YYYY') as reg_dt_tm, e.reg_dt_tm, to_char(case when p.deceased_dt_tm is null then sysdate else p.deceased_dt_tm end, 'MM/DD/YYYY') as deceased_dt_tm, P.SEX_CD, get_cd_value(p.sex_cd,'display') as gender, SUBSTR(ea1.ALIAS,1,15) as FIN,ap1.format_mask as FIN_format, SUBSTR(EA2.ALIAS,1,15) as MRN, ap2.format_mask as MRN_format, ea1.alias_pool_cd as Pt_SITE, SUBSTR(P.NAME_FULL_FORMATTED,1,40) as PATIENT_NAME, SUBSTR(PR.NAME_FULL_FORMATTED,1,40) as ATTEND_DOC, case when A.CITY is null or a.city = ' ' then get_cd_value(a.city_cd,'display') else a.city end as city, case when A.STATE is null or a.state = ' ' then get_cd_value(a.state_cd,'display') else a.state end as state , a.address_type_cd FROM ENCOUNTER E left outer join ENCNTR_ALIAS EA1 on (EA1.ENCNTR_ID = E.ENCNTR_ID and EA1.ENCNTR_ALIAS_TYPE_CD = 91 and ea1.active_ind = 1) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = ea1.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) left outer join ENCNTR_PRSNL_RELTN EP on (EP.ENCNTR_ID = E.ENCNTR_ID AND EP.ENCNTR_PRSNL_R_CD = 3432 AND EP.ACTIVE_IND = 1 and ep.end_effective_dt_tm > sysdate) left outer join ENCNTR_ALIAS EA2 on (EA2.ENCNTR_ID = E.ENCNTR_ID and EA2.ENCNTR_ALIAS_TYPE_CD = 93 and ea2.active_ind = 1) LEFT OUTER JOIN alias_pool ap2 ON (ap2.alias_pool_cd = ea2.alias_pool_cd and ap2.active_ind = 1 and ap2.end_effective_dt_tm > sysdate) left outer join ADDRESS A on (A.PARENT_ENTITY_ID = E.ORGANIZATION_ID and a.active_ind = 1 and a.end_effective_dt_tm > sysdate and a.address_type_cd = 286) join PERSON P on (P.PERSON_ID = E.PERSON_ID) left outer join PRSNL PR on (PR.PERSON_ID = EP.PRSNL_PERSON_ID) where e.encntr_id = ? and e.active_ind = 1 order by e.reg_dt_tm desc

print.CategorySorting= select csr.CHART_SECTION_ID, csr.chart_category_id,c.cs_sequence_num from category_sect_reltn csr ,chart_form_sects c where csr.CHART_CATEGORY_ID in (?) and csr.end_effective_dt_tm > sysdate and csr.chart_format_id = 305602614 and c.chart_section_id = csr.chart_section_id and c.chart_format_id = 305602614 and c.active_ind = 1 order by c.cs_sequence_num

print.getStoredData= select e2.updated_by, to_char(e2.updated_on, 'MM/DD/YY HH12:MI am') as updated_on, lb.long_blob as blob_contents, cen.compression_cd, e.sl_no, e.title, e.event_text, e.performed_by, to_char(e.performed_on, 'MM/DD/YYYY HH12:MI am') as performedOn, e.entered_by, case when e.result_status_cd in (607,39659) then to_char(e2.entered_on, 'MM/DD/YYYY HH12:MI am') else to_char(e.entered_on, 'MM/DD/YYYY HH12:MI am') end as entered_on, e.prnt_value, e.high_val, e.low_val, e.unit, e.rpt_level, e.event_id, e.parent_event_id, e2.long_text, e.event_class_code, e.prnt_ref_id, e.event_reltn_cd, e.event_tag, e.order_id, e.chart_section_id, e.category_id, e.order_text, e2.order_mnemonics, to_char(e2.exam_date, 'MM/DD/YYYY HH24:MI:SS') as exam_date, e2.accession, e2.ord_provider, case when e.event_class_code = 5235 then DATE_TIME_FORMATTING(e.result_val) else e.result_val end as result_val, e.event_cd, e.seq_no, e.doc_event_id, get_cd_value(cen.compression_cd,'display') as blob_compression, cen.compression_cd, e.storage_cd, e.format_cd, e.doc_storage_type, e.doc_format, e.result_status_cd, e1.blob_contents as note_blob, e1.compression_cd as note_compression_cd, e1.blob_seq_num from emrp_print_pdf e left outer join ce_blob e1 on (e1.event_id = e.event_id and e1.valid_until_dt_tm > sysdate) left outer join emrp_print_extra_details e2 on (e2.event_id = e.event_id and e2.prnt_ref_id=e.prnt_ref_id) left outer join ce_event_note cen on (cen.event_id=e.event_id and cen.note_type_cd = 5875 and cen.VALID_UNTIL_DT_TM > sysdate) left outer join long_blob lb on(lb.parent_entity_id = cen.ce_event_note_id and lb.parent_entity_name = 'CE_EVENT_NOTE' and lb.active_ind = 1) where e.prnt_ref_id=? order by e.event_id, e.parent_event_id

print.deleteStoredData= delete from emrp_print_pdf where prnt_ref_id=?

print.getMARData= select E.order_display, E.order_id, E.clinical_line, E.scheduled_at, E1.order_comment, E.entered_by, E1.nurse_review, E1.pharmacist_review, e1.doctor_review, E.event_action, E.order_action, E.charted_at, E.event_action_time, E.order_action_time, E.admin_details, E.event_perf_by, E.action_perf_by, E.mar_category, E.sort_order, E.event_id, E.iv_site, case when (E.dosage is not null and E.dosage != 0) then concat(E.dosage, concat(' ', E.dosage_unit)) else null end as dosage, case when (E.rate is not null and E.rate != 0) then concat(E.rate, concat(' ', E.rate_unit)) else null end as rate, case when (E.volume is not null and E.volume != 0) then concat(E.volume, concat(' ', E.volume_unit)) else null end as volume, E.subs_lot_nbr, E.print_ref_id ,LB.LONG_BLOB, cen.compression_cd, GET_CD_VALUE(CEN.NOTE_TYPE_CD,'display') as Note_type ,e1.modified_by, pn.long_text as product_notes, e1.Proxy_prsnl from EMRP_MAR_PRINT_PDF E LEFT OUTER JOIN CE_EVENT_NOTE CEN ON ( CEN.EVENT_ID = E.EVENT_ID AND CEN.VALID_UNTIL_DT_TM > SYSDATE) LEFT OUTER JOIN LONG_BLOB LB ON (lb.parent_entity_id = cEN.ce_event_note_id and lb.parent_entity_name = 'CE_EVENT_NOTE') left outer join emrp_print_extra_details e1 on(e1.order_id = e.order_id and e1.event_id = e.event_id and e1.prnt_ref_id = e.print_ref_id) left outer join emrp_mar_product_notes pn on (e.print_ref_id=pn.print_ref_id and e.order_id=pn.order_id) where E.print_ref_id=? order by E.sort_order,upper(E.order_display), E.order_id, E.EVENT_ACTION_TIME

print.getLabData= select lb.long_blob as comments_blob, cen.compression_cd as comments_compression_cd, a.event_id, get_cd_value(cen.compression_cd,'display') as comments_blob_compression, c.blob_contents, c.compression_cd, to_char(a.min_date,'MM/DD/YYYY hh24:mi:ss') as order_min_dt, e.order_mnemonics, e.long_text, a.sl_no, a.event_class_code, a.title, a.event_text, to_char(a.performed_on, 'MM/DD/YYYY HH12:MI:SS AM') as performed_on_for_comment, to_char(a.performed_on, 'MM/DD/YYYY"<br/>"HH12:MI:SS AM') as performedOn, case when a.result_status_cd in (607,39659) then e.entered_on else a.entered_on end as entered_on, case when (a.high_val is not null and a.high_val!=' ' and a.low_val is not null and a.low_val!=' ') then concat('[', concat(a.low_val, concat('-', concat(a.high_val, ']')))) else case when a.high_val is not null and a.high_val!=' ' and (a.low_val is null or a.low_val=' ') then concat('[',concat(a.high_val,']')) else case when (a.high_val is null or a.high_val=' ') and a.low_val is not null and a.low_val!=' ' then concat('[',concat(a.low_val,']')) else '' end end end as ref_range, case when a.unit is null then '' else a.unit end unit, a.prnt_ref_id, a.event_tag, a.event_cd, a.category_id, a.result_status_cd, e.updated_by, to_char(e.updated_on, 'MM/DD/YYYY HH12:MI:SS AM') as updated_on, e.previous_res_val from (select e.*, min(e.performed_on) over (partition by e.order_id) min_date from emrp_print_pdf e) a left outer join (select distinct d.compression_cd , d.blob_compression, d.print_ref_id, d.event_id from emrp_print_blob_data d) b on (a.prnt_ref_id = b.print_ref_id and a.event_id=b.event_id) left outer join ce_blob c on (a.event_id = c.event_id and c.valid_until_dt_tm > sysdate) left outer join emrp_print_extra_details e on(a.event_id = e.event_id and a.chart_group_id = e.chart_group_id and a.prnt_ref_id=e.prnt_ref_id) left outer join ce_event_note cen on (cen.event_id=a.event_id and cen.note_type_cd = 5875 and cen.VALID_UNTIL_DT_TM > sysdate) left outer join long_blob lb on(lb.parent_entity_id = cen.ce_event_note_id and lb.parent_entity_name = 'CE_EVENT_NOTE' and lb.active_ind = 1) where a.prnt_ref_id=? order by a.chart_group_id, a.performed_on desc, a.event_set_seq, a.event_cd

print.getComments= select distinct event_id from emrp_print_pdf where prnt_ref_id=? and sl_no>1 and event_class_code=523

print.getCLassCode= select event_class_code from emrp_print_pdf where prnt_ref_id=? and sl_no=2

print.getEventIDForBlob= select event_id, event_class_code, prnt_ref_id from emrp_print_pdf where prnt_ref_id=? and sl_no=2 and event_id>0 and event_class_code>0

#print.getBlobData= select b.event_title_text, b.event_id, p.sl_no, p.title, b.doc_event_id, b.RAD_EVENT_TAG, b.print_ref_id, c.blob_length, c.blob_contents, c.blob_seq_num, b.event_id, b.event_class_code, b.blob_compression, b.doc_storage_type, b.doc_format, b.compression_cd, b.storage_cd, b.format_cd, n.note_type, n.note_contents, n.compression_type as note_compression_type, n.format as note_format, s.sig_line, s.compression_type as sig_compression_type, s.format as sig_format, b.source_display, b.free_text_source, to_char(b.verified_dt_tm,'MM/DD/YYYY HH24:MI') as verified_on, b.body_site, to_char(b.collect_dt_tm, 'MM/DD/YYYY HH24:MI') as collected_on, p1.title as sub_title, p1.event_text as procedure, to_char(p1.performed_on,'MM/DD/YYYY HH24:MI') as started_on, p1.ORDER_TEXT, p1.RESULT_VAL, p1.event_text, e2.order_mnemonics, to_char(e2.exam_date, 'MM/DD/YYYY HH24:MI:SS') as exam_date, case when e2.accession is not null then e2.accession else case when b.accession is not null then b.accession else '' end end as accession, e2.ord_provider, p1.event_text as ResultType, to_char(p1.performed_on, 'Month DD, YYYY HH24:MI') as ResultDate, get_cd_value(p1.RESULT_STATUS_CD,'display') as ResultStatus,p1.title as ResultTitle, to_char(cep.Action_dt_tm, 'Month DD, YYYY HH24:MI') as perform_date, case when pr1.name_full is null then pr.name_full_formatted else pr1.name_full end as perform_prsnl, to_char(cep2.Action_dt_tm, 'Month DD, YYYY HH24:MI') as verify_date, case when pr3.name_full is null then pr2.name_full_formatted else pr3.name_full end as verify_prsnl from emrp_print_blob_data b left outer join emrp_print_pdf p on (b.print_ref_id = p.prnt_ref_id and p.sl_no=1) left outer join emrp_print_pdf p1 on (b.print_ref_id = p1.prnt_ref_id and p1.sl_no=2 and p1.event_id = b.event_id) left outer join emrp_rad_notes n on (b.event_id = n.event_id) left outer join emrp_rad_sig_line s on (b.event_id = s.event_id and b.doc_event_id = s.doc_event_id) left outer join ce_blob c on (b.doc_event_id = c.event_id and b.blob_seq_num = c.blob_seq_num and c.valid_until_dt_tm > sysdate) left outer join emrp_print_extra_details e2 on (e2.event_id = b.event_id and e2.prnt_ref_id=b.print_ref_id) left outer join ce_event_prsnl cep on (cep.event_id = b.event_id and cep.action_type_cd = 626 and cep.valid_until_dt_tm > sysdate) left outer join prsnl pr on(pr.person_id = cep.action_prsnl_id) left outer join person_name pr1 on (pr1.person_id = cep.action_prsnl_id and pr1.name_type_cd = 16027279 and pr1.beg_effective_dt_tm <=cep.action_dt_tm and pr1.end_effective_dt_tm >=cep.action_dt_tm) left outer join ce_event_prsnl cep2 on (cep2.event_id = b.event_id and cep2.action_type_cd = 634 and cep2.valid_until_dt_tm > sysdate) left outer join prsnl pr2 on(pr2.person_id = cep2.action_prsnl_id) left outer join person_name pr3 on (pr3.person_id = cep2.action_prsnl_id and pr3.name_type_cd = 16027279 and pr3.beg_effective_dt_tm <=cep2.action_dt_tm and pr3.end_effective_dt_tm >=cep2.action_dt_tm) where b.print_ref_id=? order by b.event_id desc, b.doc_event_id desc, b.blob_seq_num desc

print.getBlobData= select b.event_title_text, b.event_id, p.sl_no, p.title, b.doc_event_id, b.RAD_EVENT_TAG, b.print_ref_id, c.blob_length, c.blob_contents, c.blob_seq_num, b.event_id, b.event_class_code, b.blob_compression, b.doc_storage_type, b.doc_format, b.compression_cd, b.storage_cd, b.format_cd, n.note_type, n.note_contents, n.compression_type as note_compression_type, n.format as note_format, s.sig_line, s.compression_type as sig_compression_type, s.format as sig_format, b.source_display, b.free_text_source, to_char(b.verified_dt_tm,'MM/DD/YYYY HH24:MI') as verified_on, b.body_site, to_char(b.collect_dt_tm, 'MM/DD/YYYY HH24:MI') as collected_on, p1.title as sub_title, p1.event_text as procedure, to_char(p1.performed_on,'MM/DD/YYYY HH24:MI') as started_on, p1.ORDER_TEXT, p1.RESULT_VAL, p1.event_text, e2.order_mnemonics, to_char(e2.exam_date, 'MM/DD/YYYY HH24:MI:SS') as exam_date, case when e2.accession is not null then e2.accession else case when b.accession is not null then b.accession else '' end end as accession, e2.ord_provider, p1.event_text as ResultType, to_char(p1.performed_on, 'Month DD, YYYY HH24:MI') as ResultDate, get_cd_value(p1.RESULT_STATUS_CD,'display') as ResultStatus,p1.title as ResultTitle, to_char(cep.Action_dt_tm, 'Month DD, YYYY HH24:MI') as perform_date, pr.name_full_formatted as perform_prsnl, to_char(cep2.Action_dt_tm, 'Month DD, YYYY HH24:MI') as verify_date, pr2.name_full_formatted as verify_prsnl from emrp_print_blob_data b left outer join emrp_print_pdf p on (b.print_ref_id = p.prnt_ref_id and p.sl_no=1) left outer join emrp_print_pdf p1 on (b.print_ref_id = p1.prnt_ref_id and p1.sl_no=2 and p1.event_id = b.event_id) left outer join emrp_rad_notes n on (b.event_id = n.event_id) left outer join emrp_rad_sig_line s on (b.event_id = s.event_id and b.doc_event_id = s.doc_event_id) left outer join ce_blob c on (b.doc_event_id = c.event_id and b.blob_seq_num = c.blob_seq_num and c.valid_until_dt_tm > sysdate) left outer join emrp_print_extra_details e2 on (e2.event_id = b.event_id and e2.prnt_ref_id=b.print_ref_id) left outer join ce_event_prsnl cep on (cep.event_id = b.event_id and cep.action_type_cd = 626 and cep.valid_until_dt_tm > sysdate) left outer join prsnl pr on(pr.person_id = cep.action_prsnl_id) left outer join ce_event_prsnl cep2 on (cep2.event_id = b.event_id and cep2.action_type_cd = 634 and cep2.valid_until_dt_tm > sysdate) left outer join prsnl pr2 on(pr2.person_id = cep2.action_prsnl_id) where b.print_ref_id=? order by b.event_id desc, b.doc_event_id desc, b.blob_seq_num desc

print.AllergyUpdate= select case when n.SOURCE_STRING is null or n.source_string = ' ' then a.substance_ftdesc else n.source_string end as SubstanceString, case when n1.SOURCE_STRING is null or n1.source_string = ' ' then r.REACTION_FTDESC else n1.source_string end as ReactionSourceString, a.allergy_id,AC.ALLERGY_COMMENT as comment_text,ac.ALLERGY_COMMENT_ID from allergy a left outer join nomenclature n on( n.nomenclature_id = a.substance_nom_id) left outer join REACTION r on(r.allergy_id =a.allergy_id and r.active_ind =1 and r.end_effective_dt_tm >sysdate) left outer join nomenclature n1 on( n1.nomenclature_id = r.REACTION_NOM_ID) left outer join allergy_comment ac on (AC.ALLERGY_ID=A.ALLERGY_Id AND AC.BEG_EFFECTIVE_DT_TM <= sysdate AND AC.END_EFFECTIVE_DT_TM>sysdate) where a.person_id=? and a.active_ind = 1 and a .reaction_status_cd =1392 order by lower(SubstanceString)

print.medList= select  o1.hna_order_mnemonic as order_disp, get_cd_value(o1.ORDER_STATUS_CD, 'display') as orderstatus, to_char(o1.current_start_dt_tm,'MM/DD/YY HH12:MI am') as OrderDate, o1.simplified_display_line as SIG from orders o1 where o1.person_id = ?  and o1.catalog_type_cd = 2605 and o1.activity_type_cd =5059 and o1.template_order_id = 0.0  and o1.active_ind=1 and o1.prescription_order_id = 0.0 and o1.cs_flag !=1 and o1.orig_ord_as_flag in(1,2)  and o1.order_status_cd = 1088 order by o1.current_start_dt_tm desc 

print.problem=select distinct case when n.SOURCE_STRING is null then pb.PROBLEM_FTDESC else n.SOURCE_STRING end as source_string, get_cd_value(pb.LIFE_CYCLE_STATUS_CD, 'display') as status ,  get_cd_value(pb.confirmation_status_cd, 'display') as confirmation, to_char(pb.ONSET_DT_TM, 'MM/DD/YY HH12:MI am') as Onset_date, p.name_full_formatted as Recorded_by from problem pb  left OUTER JOIN nomenclature n on(n.nomenclature_id = pb.nomenclature_id)  left outer join problem_prsnl_r ppr on(ppr.problem_id = pb.problem_id and ppr.problem_reltn_cd = 1414  and ppr.active_ind = 1 and ppr.end_effective_dt_tm > sysdate)  left outer join prsnl p on(p.person_id = ppr.problem_reltn_prsnl_id ) where pb.PERSON_ID=? and pb.ACTIVE_IND=1 and pb.LIFE_CYCLE_STATUS_CD in(1394,1397) and pb.end_effective_dt_tm > sysdate  order by lower(source_string)

print.diagnosis= select case when n.source_string is null then di.diag_ftdesc else n.source_string end sourceString,  di.diagnosis_id as diagnosisId, to_char(di.diag_dt_tm, 'MM/DD/YY HH12:MI am') as StatusDate,  get_cd_value(di.CONFIRMATION_STATUS_CD, 'display') as confirmation,  get_cd_value(di.diag_type_cd, 'display') as Diag_type  from diagnosis di  join nomenclature n on (n.nomenclature_id=di.nomenclature_id)  where di.person_id=?  and di.encntr_id =? and di.active_ind=1 and di.active_status_cd=1623  and di.beg_effective_dt_tm<=sysdate and ((di.end_effective_dt_tm>=sysdate) or (di.end_effective_dt_tm=null))  order by di.diag_dt_tm desc 

micro.encntr= SELECT DISTINCT E.PERSON_ID, get_cd_value(e.encntr_type_cd, 'display') as enc_type, E.ENCNTR_ID, get_cd_value(E.loc_building_cd,'description') as MainLoc, get_cd_value(E.LOC_FACILITY_CD,'description') as FAC, get_cd_value(E.LOC_NURSE_UNIT_CD,'display') as UNIT, get_cd_value(E.LOC_ROOM_CD, 'display') as ROOM, get_cd_value(E.LOC_BED_CD,'display') as BED, to_char(E.REG_DT_TM,'MM/DD/YY HH24:MI:SS') as Admit_dt_tm, to_char(E.REG_DT_TM,'MM/DD/YYYY') as Admit_dt, to_char(E.DISCH_DT_TM, 'MM/DD/YY HH24:MI:SS') as Disch_dt_tm, to_char(E.DISCH_DT_TM, 'MM/DD/YYYY') as Disch_dt, EP.PRSNL_PERSON_ID, to_char(P.BIRTH_DT_TM, 'MM/DD/YY') as birth_dt_tm, to_char(P.BIRTH_DT_TM, 'MM/DD/YYYY') as dob_full, to_char(E.REG_DT_TM, 'MM/DD/YYYY') as reg_dt_tm, to_char(case when p.deceased_dt_tm is null then sysdate else p.deceased_dt_tm end, 'MM/DD/YYYY') as deceased_dt_tm, P.SEX_CD, get_cd_value(p.sex_cd,'display') as gender, SUBSTR(ea1.ALIAS,1,15) as FIN,ap1.format_mask as FIN_format, SUBSTR(EA2.ALIAS,1,15) as MRN, ap2.format_mask as MRN_format, ea1.alias_pool_cd as Pt_SITE, SUBSTR(P.NAME_FULL_FORMATTED,1,40) as PATIENT_NAME, SUBSTR(PR.NAME_FULL_FORMATTED,1,40) as ATTEND_DOC, case when A.CITY is null then get_cd_value(a.city_cd,'display') else a.city end as city, case when A.STATE is null or A.STATE = ' ' then get_cd_value(a.state_cd,'display') else a.state end as state , a.address_type_cd FROM ENCOUNTER E left outer join ENCNTR_ALIAS EA1 on (EA1.ENCNTR_ID = E.ENCNTR_ID and EA1.ENCNTR_ALIAS_TYPE_CD = 91 and ea1.active_ind = 1) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = ea1.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) left outer join ENCNTR_PRSNL_RELTN EP on (EP.ENCNTR_ID = E.ENCNTR_ID AND EP.ENCNTR_PRSNL_R_CD = 3432 AND EP.ACTIVE_IND = 1 and ep.end_effective_dt_tm > sysdate) left outer join ENCNTR_ALIAS EA2 on (EA2.ENCNTR_ID = E.ENCNTR_ID and EA2.ENCNTR_ALIAS_TYPE_CD = 93 and ea2.active_ind = 1) LEFT OUTER JOIN alias_pool ap2 ON (ap2.alias_pool_cd = ea2.alias_pool_cd and ap2.active_ind = 1 and ap2.end_effective_dt_tm > sysdate) left outer join ADDRESS A on (A.PARENT_ENTITY_ID = E.ORGANIZATION_ID and a.active_ind = 1 and a.end_effective_dt_tm > sysdate and a.address_type_cd = 286) join PERSON P on (P.PERSON_ID = E.PERSON_ID) left outer join PRSNL PR on (PR.PERSON_ID = EP.PRSNL_PERSON_ID) where e.encntr_id in (select ce.encntr_id from clinical_event ce where ce.event_id = ? and ce.valid_until_dt_tm > sysdate) and e.active_ind = 1

assign.UpdateEncntrs= update emrp_auditor_encntr_reltn eaer set eaer.active_ind = 0, eaer.updt_id = ?, eaer.updt_dt_tm = sysdate where eaer.active_ind = 1 and eaer.prsnl_id = ? and eaer.person_id = ? and eaer.encntr_id = ?

assign.DeAssignEncntrs= update emrp_auditor_encntr_reltn eaer set eaer.active_ind = 0, eaer.updt_id = ?, eaer.updt_dt_tm = sysdate where eaer.active_ind = 1 and eaer.prsnl_id = ? and eaer.person_id = ?

assign.InsertEncntrs= insert into emrp_auditor_encntr_reltn (EMRP_AUDITOR_ENCNTR_RELTN_ID, PRSNL_ID, PERSON_ID, ENCNTR_ID, UPDT_ID, UPDT_DT_TM, ACTIVE_IND) values (EMRP_AUDITOR_ENCNTR_RELTN_SEQ.nextval, ?, ?, ?, ?, sysdate, 1)

assign.AssignedEncntrs= select get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, case when to_char(e.reg_dt_tm,'HH24:MI') = '00:00' then to_char(e.reg_dt_tm,'MM/DD/YYYY') else to_char(e.reg_dt_tm,'MM/DD/YYYY HH24:MI') end as Reg_dt_tm, case when to_char(e.disch_dt_tm,'HH24:MI') = '00:00' then to_char(e.disch_dt_tm,'MM/DD/YYYY') else to_char(e.disch_dt_tm,'MM/DD/YYYY HH24:MI') end as Disch_dt_tm, get_cd_value(e.med_service_cd, 'display') as Medical_service, get_cd_value(e.loc_facility_cd, 'display') as Facility, case when e.loc_room_cd>0 then case when e.loc_bed_cd>0 then concat(concat(concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display')),';'),get_cd_value(e.loc_bed_cd, 'display')) else (concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display'))) end else get_cd_value(e.loc_nurse_unit_cd, 'display') end as location, ea.alias as Acct,ap.format_mask as FIN_format, e.encntr_id as Encntr_id, get_cd_value(e.encntr_status_cd, 'display') as EncntrStatus, ea1.alias as ChartNum, eppa.PPR_CD as relation_cd, eaer.EMRP_AUDITOR_ENCNTR_RELTN_ID from encounter e join encntr_alias ea on (ea.encntr_id=e.encntr_id and ea.active_ind=1 and ea.encntr_alias_type_cd=91) left outer join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) left outer join encntr_alias ea1 on(ea1.encntr_id=e.encntr_id and ea1.active_ind =1 and ea1.encntr_alias_type_cd= 14865492 and ea1.end_effective_dt_tm >sysdate) left outer join EMRP_PERSON_PRSNL_ACTIVITY eppa on (eppa.person_id = e.person_id and eppa.prsnl_id = ?) join EMRP_AUDITOR_ENCNTR_RELTN eaer on (eaer.person_id=e.person_id and eaer.encntr_id = e.encntr_id and eaer.prsnl_id = ? and eaer.active_ind=1) where e.person_id=? and e.active_ind =1 and e.end_effective_dt_tm >sysdate and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.active_ind=1 and por.end_effective_dt_tm >sysdate) order by e.reg_dt_tm desc

assign.AssignedEncntrsWithOrgDisch= select get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, case when to_char(e.reg_dt_tm,'HH24:MI') = '00:00' then to_char(e.reg_dt_tm,'MM/DD/YYYY') else to_char(e.reg_dt_tm,'MM/DD/YYYY HH24:MI') end as Reg_dt_tm, case when to_char(e.disch_dt_tm,'HH24:MI') = '00:00' then to_char(e.disch_dt_tm,'MM/DD/YYYY') else to_char(e.disch_dt_tm,'MM/DD/YYYY HH24:MI') end as Disch_dt_tm, get_cd_value(e.med_service_cd,'display') as Medical_service, get_cd_value(e.loc_facility_cd, 'display') as Facility, case when e.loc_room_cd>0 then case when e.loc_bed_cd>0 then concat(concat(concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display')),';'),get_cd_value(e.loc_bed_cd, 'display')) else (concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display'))) end else get_cd_value(e.loc_nurse_unit_cd, 'display') end as location, ea.alias as Acct,ap.format_mask as FIN_format, e.encntr_id as Encntr_id, get_cd_value(e.encntr_status_cd, 'display') as EncntrStatus, ea1.alias as ChartNum, eppa.PPR_CD as relation_cd, eaer.EMRP_AUDITOR_ENCNTR_RELTN_ID from encounter e join encntr_alias ea on (ea.encntr_id=e.encntr_id and ea.active_ind=1 and ea.encntr_alias_type_cd=91) left outer join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) left outer join encntr_alias ea1 on(ea1.encntr_id=e.encntr_id and ea1.active_ind =1 and ea1.encntr_alias_type_cd= 14865492 and ea1.end_effective_dt_tm >sysdate) left outer join EMRP_PERSON_PRSNL_ACTIVITY eppa on (eppa.person_id = e.person_id and eppa.prsnl_id = ?) join EMRP_AUDITOR_ENCNTR_RELTN eaer on (eaer.person_id=e.person_id and eaer.encntr_id = e.encntr_id and eaer.prsnl_id = ? and eaer.active_ind=1) where e.person_id=? and e.active_ind =1 and e.end_effective_dt_tm >sysdate and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.active_ind=1 and por.end_effective_dt_tm >sysdate)

assign.UserAssignedEncntrs= select get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, case when to_char(e.reg_dt_tm,'HH24:MI') = '00:00' then to_char(e.reg_dt_tm,'MM/DD/YYYY') else to_char(e.reg_dt_tm,'MM/DD/YYYY HH24:MI') end as Reg_dt_tm, case when to_char(e.disch_dt_tm,'HH24:MI') = '00:00' then to_char(e.disch_dt_tm,'MM/DD/YYYY') else to_char(e.disch_dt_tm,'MM/DD/YYYY HH24:MI') end as Disch_dt_tm, get_cd_value(e.med_service_cd, 'display') as Medical_service, get_cd_value(e.loc_facility_cd, 'display') as Facility, case when e.loc_room_cd>0 then case when e.loc_bed_cd>0 then concat(concat(concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display')),';'),get_cd_value(e.loc_bed_cd, 'display')) else (concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display'))) end else get_cd_value(e.loc_nurse_unit_cd, 'display') end as location, ea.alias as Acct,ap.format_mask as FIN_format, e.encntr_id as Encntr_id, get_cd_value(e.encntr_status_cd, 'display') as EncntrStatus, ea1.alias as ChartNum, eppa.PPR_CD as relation_cd, eaer.EMRP_AUDITOR_ENCNTR_RELTN_ID from encounter e join encntr_alias ea on (ea.encntr_id=e.encntr_id and ea.active_ind=1 and ea.encntr_alias_type_cd=91) left outer join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) left outer join encntr_alias ea1 on(ea1.encntr_id=e.encntr_id and ea1.active_ind =1 and ea1.encntr_alias_type_cd= 14865492 and ea1.end_effective_dt_tm >sysdate) left outer join EMRP_PERSON_PRSNL_ACTIVITY eppa on (eppa.person_id = e.person_id and eppa.prsnl_id = ?) left outer join EMRP_AUDITOR_ENCNTR_RELTN eaer on (eaer.person_id=e.person_id and eaer.encntr_id = e.encntr_id and eaer.prsnl_id = ? and eaer.active_ind=1) where e.person_id=? and e.active_ind =1 and e.end_effective_dt_tm >sysdate and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.active_ind=1 and por.end_effective_dt_tm >sysdate) order by e.reg_dt_tm desc

assign.UserAssignedEncntrsWithOrgDisch= select get_cd_value(e.encntr_type_cd, 'display') AS Enc_type, case when to_char(e.reg_dt_tm,'HH24:MI') = '00:00' then to_char(e.reg_dt_tm,'MM/DD/YYYY') else to_char(e.reg_dt_tm,'MM/DD/YYYY HH24:MI') end as Reg_dt_tm, case when to_char(e.disch_dt_tm,'HH24:MI') = '00:00' then to_char(e.disch_dt_tm,'MM/DD/YYYY') else to_char(e.disch_dt_tm,'MM/DD/YYYY HH24:MI') end as Disch_dt_tm, get_cd_value(e.med_service_cd,'display') as Medical_service, get_cd_value(e.loc_facility_cd, 'display') as Facility, case when e.loc_room_cd>0 then case when e.loc_bed_cd>0 then concat(concat(concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display')),';'),get_cd_value(e.loc_bed_cd, 'display')) else (concat(concat(get_cd_value(e.loc_nurse_unit_cd, 'display'),';'),get_cd_value(e.loc_room_cd, 'display'))) end else get_cd_value(e.loc_nurse_unit_cd, 'display') end as location, ea.alias as Acct,ap.format_mask as FIN_format, e.encntr_id as Encntr_id, get_cd_value(e.encntr_status_cd, 'display') as EncntrStatus, ea1.alias as ChartNum, eppa.PPR_CD as relation_cd, eaer.EMRP_AUDITOR_ENCNTR_RELTN_ID from encounter e join encntr_alias ea on (ea.encntr_id=e.encntr_id and ea.active_ind=1 and ea.encntr_alias_type_cd=91) left outer join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) left outer join encntr_alias ea1 on(ea1.encntr_id=e.encntr_id and ea1.active_ind =1 and ea1.encntr_alias_type_cd= 14865492 and ea1.end_effective_dt_tm >sysdate) left outer join EMRP_PERSON_PRSNL_ACTIVITY eppa on (eppa.person_id = e.person_id and eppa.prsnl_id = ?) left outer join EMRP_AUDITOR_ENCNTR_RELTN eaer on (eaer.person_id=e.person_id and eaer.encntr_id = e.encntr_id and eaer.prsnl_id = ? and eaer.active_ind=1) where e.person_id=? and e.active_ind =1 and e.end_effective_dt_tm >sysdate and e.organization_id in(select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.active_ind=1 and por.end_effective_dt_tm >sysdate)

actionListForDoc= select pr.person_id,cp1.ce_event_prsnl_id ,cp1.event_prsnl_id,cp1.event_id,case when(cp1.action_type_cd in (634, 626)) then 1 when(cp1.action_type_cd = 625)then 3 else 4 end as sortorder,  get_cd_value(cp1.ACTION_TYPE_CD, 'display') as action, to_char(cp1.ACTION_DT_TM, 'MM/DD/YYYY HH24:MI:SS') as ACTION_DT_TM, to_char (cp1.valid_from_dt_tm, 'MM/DD/YYYY HH24:MI:SS') as valid_from_dt_tm,  case when p1.name_full is null then pr.name_full_formatted else p1.name_full end as performedBy,  pr.name_full_formatted as AlernatePerformedby, cp1.action_comment from clinical_event c join ce_event_prsnl cp1 on (((cp1.event_id = c.parent_event_id and cp1.action_type_cd in (625.00, 624)) or (cp1.event_id = c.event_id))) left outer join prsnl pr on(pr.person_id =  cp1.action_prsnl_id) left outer join person_name p1 on (p1.person_id = pr.person_id and p1.name_type_cd = 16027279 and p1.beg_effective_dt_tm <=cp1.action_dt_tm and p1.end_effective_dt_tm >=cp1.action_dt_tm and p1.active_ind = 1) where c.event_id=? and c.view_level=1 and c.valid_until_dt_tm >sysdate order by cp1.action_dt_tm, sortorder, cp1.valid_from_dt_tm desc

chartAccessReportPrsnl= (select PPA.ppa_id as PPA_ID,'-' as Person_Position, pr.person_id as PRSNL_ID, 	pr.name_full_formatted as prsnl_name, a1.org_id as prsnl_org_num, a1.area_no as prsnl_area_no,a1.area_name as prsnl_area_name,  get_cd_value(ppa.ppr_cd,'display') as PRSNL_ROLE,to_char(PPA.ppa_last_DT_TM, 'MM/DD/YYYY HH:MM') as ACCESS_DATE ,pe.person_id as PID,pe.name_full_formatted as person_name,to_char(pe.birth_dt_tm,'MM/DD/YYYY') as Person_DOB,pr1.area_no as person_area_no,pr1.area_name as person_area_name,pr1.JOB_DESC as person_job,pr1.ORG_ID as person_org_num,'Cerner Data' as Action_performed,get_cd_value(ppa.ppa_type_cd,'display') as Event_name,'-' as FIN from auro_prsnl a join prsnl_alias pra on ((pra.alias = to_char(a.empl_id) OR PRA.ALIAS = LPAD(to_char(A.EMPL_ID), 6, '0'))	and pra.alias_pool_cd = 15354334  and pra.prsnl_alias_type_cd = 102	and pra.active_ind = 1 and pra.data_status_cd = 601	and pra.end_effective_dt_tm > sysdate) join prsnl pr on (pra.person_id = pr.person_id and pr.active_ind = 1 and pr.data_status_cd = 601 and pr.end_effective_dt_tm > sysdate) join person_prsnl_activity ppa on (ppa.prsnl_id = pra.person_id and ppa.ppa_type_cd = 352	and PPA.ppa_last_DT_TM >= to_date(?, 'MM/dd/yyyy hh24:mi:ss') and PPA.ppa_last_DT_TM <= to_date(?, 'MM/dd/yyyy hh24:mi:ss') and ppa.active_ind = 1) join person pe on (ppa.person_id = pe.person_id and pe.active_ind = 1 and pe.end_effective_dt_tm > sysdate) join auro_prsnl pr1 on (pe.name_last_key = pr1.aur_name_last_key and to_char(pe.birth_dt_tm,'MMDDYYYY') = pr1.dob) left outer join prsnl_alias pra1 on (pra1.person_id = pr.person_id and pra1.alias_pool_cd = 15354334	AND pra1.prsnl_alias_type_cd = 102 AND PRA1.active_ind = 1 and pra1.data_status_cd = 601 and pra1.end_effective_dt_tm > sysdate) left outer JOIN auro_prsnl a1 on ((to_char(a1.empl_id) = pra1.alias) OR LPAD(to_char(A1.EMPL_ID), 6, '0') = PRA1.ALIAS) where a.org_id in (?) AND A.term_indicator != 'T') union (Select e.audit_id as PPA_ID, get_cd_value(eu2.position_cd,'display') as Person_Position,eu1.prsnl_id as PRSNL_ID, concat(eu1.name_last_key,concat(', ',concat(eu1.name_first_key,concat(' ',eu1.name_middle_key)))) as Prsnl_name ,'-' as prsnl_org_num,'-' as prsnl_area_no,'-' as prsnl_area_name, get_cd_value(e.reltn_cd,'display') as PRSNL_ROLE, to_char(e.action_dt_time,'MM/DD/YYYY HH24:MI') as ACCESS_DATE, e.person_id as PID,concat(eu2.name_last_key,concat(', ',concat(eu2.name_first_key,concat(' ',eu2.name_middle_key)))) as Person_name, to_char(eu2.birth_dt_tm,'MM/DD/YYYY HH24:MI') as Person_DOB,'-' as person_area_no,'-' as person_area_name,'-' as person_job,  '-' as person_org_num,e.action_performed,e.event_name,e.FIN_Number as FIN  from emrp_audit e join auro_organizations ao on (ao.auro_org_id in (?)) join emrp_prsnl_org_reltn epor on (epor.person_id = e.prsnl_id and epor.active_ind = 1 and epor.organization_id = ao.organization_id ) join EMRP_USERS eu1 on (eu1.prsnl_id =  e.prsnl_id) join person p on (p.person_id = e.PERSON_ID) join EMRP_USERS eu2 on( eu2.name_last_key = p.name_last_key and eu2.birth_dt_tm = p.birth_dt_tm ) where e.action_dt_time >= to_date(?, 'MM/dd/yyyy hh24:mi:ss') and e.action_dt_time <= to_date(?, 'MM/dd/yyyy hh24:mi:ss')) ORDER BY PRSNL_ID, ACCESS_DATE, PID, PPA_ID

chartAccessReportFamily= (select distinct PPA.ppa_id as PPA_ID, pr.person_id as PRSNL_ID, pr.name_full_formatted as prsnl_name, a1.org_id as prsnl_org_num, a1.area_no as prsnl_area_no,a1.area_name as prsnl_area_name, get_cd_value(ppa.ppr_cd,'display') as PRSNL_ROLE, to_char(PPA.ppa_last_DT_TM, 'MM/DD/YYYY HH:MM') as ACCESS_DATE ,pe.person_id as PID,pe.name_full_formatted as person_name, to_char(pe.birth_dt_tm,'MM/DD/YYYY') as Person_DOB,'Cerner Data' as Action_performed, p1.name_full_formatted as related_person,get_cd_value(epr.person_reltn_cd,'display') as encntr_person_reltn, get_cd_value(epr.person_reltn_type_cd,'display') as encntr_person_reltn_type, get_cd_value(ppa.ppa_type_cd,'display') as Event_name,'-' as FIN from auro_prsnl a join prsnl_alias pra on ((pra.alias = to_char(a.empl_id) OR PRA.ALIAS = LPAD(to_char(A.EMPL_ID), 6, '0')) and pra.alias_pool_cd = 15354334  and pra.prsnl_alias_type_cd = 102	and pra.active_ind = 1 and pra.data_status_cd = 601	and pra.end_effective_dt_tm > sysdate) join prsnl pr on (pra.person_id = pr.person_id and pr.active_ind = 1 and pr.data_status_cd = 601 and pr.end_effective_dt_tm > sysdate) join person_prsnl_activity ppa on (ppa.prsnl_id = pra.person_id and ppa.ppa_type_cd = 352 and PPA.ppa_last_DT_TM >= to_date(?, 'MM/dd/yyyy hh24:mi:ss') and PPA.ppa_last_DT_TM <= to_date(?, 'MM/dd/yyyy hh24:mi:ss') and ppa.active_ind = 1) join person pe on (ppa.person_id = pe.person_id and pe.name_last_key = Pr.name_last_key and pe.person_type_cd = 222 and pe.person_id != pr.person_id and pe.active_ind = 1 and pe.end_effective_dt_tm > sysdate) left outer join prsnl_alias pra1 on (pra1.person_id = pr.person_id and pra1.alias_pool_cd = 15354334 AND pra1.prsnl_alias_type_cd = 102 AND PRA1.active_ind = 1 and pra1.data_status_cd = 601 and pra1.end_effective_dt_tm > sysdate) left outer JOIN auro_prsnl a1 on ((to_char(a1.empl_id) = pra1.alias) OR LPAD(to_char(A1.EMPL_ID), 6, '0') = PRA1.ALIAS) left outer join encounter entr on(entr.person_id = pe.person_id and entr.active_ind = 1 and entr.end_effective_dt_tm > sysdate) left outer join ENCNTR_PERSON_RELTN EPR on ( epr.encntr_id = entr.encntr_id	and epr.person_reltn_cd != 3806	and epr.person_reltn_type_cd != 4492 and epr.active_ind = 1 and epr.end_effective_dt_tm >= sysdate) left outer join person p1 on (p1.person_id = epr.related_person_id and p1.active_ind = 1 and p1.end_effective_dt_tm >= sysdate) where a.org_id in (?) AND A.term_indicator != 'T') UNION (Select distinct e.audit_id as PPA_ID,eu1.prsnl_id as PRSNL_ID, concat(eu1.name_last_key,concat(', ',concat(eu1.name_first_key,concat(' ',eu1.name_middle_key)))) as Prsnl_name ,'-' as prsnl_org_num,'-' as prsnl_area_no,'-' as prsnl_area_name, get_cd_value(e.reltn_cd,'display') as PRSNL_ROLE, to_char(e.action_dt_time,'MM/DD/YYYY HH24:MI') as ACCESS_DATE, e.person_id as PID,p.name_full_formatted as person_name, to_char(p.birth_dt_tm,'MM/DD/YYYY') as person_DOB,e.action_performed, p1.name_full_formatted as related_person, get_cd_value(epr.person_reltn_cd,'display') as encntr_person_reltn, get_cd_value(epr.person_reltn_type_cd,'display') as encntr_person_reltn_type, e.event_name as Event_name, e.FIN_Number as FIN from emrp_audit e join auro_organizations ao on (ao.auro_org_id in (?)) join emrp_prsnl_org_reltn epor on (epor.person_id = e.prsnl_id and epor.active_ind = 1 and epor.organization_id = ao.organization_id ) join EMRP_USERS eu1 on (eu1.prsnl_id = e.prsnl_id) join person p on (p.person_id = e.PERSON_ID and p.name_last_key = eu1.name_last_key and p.person_type_cd = 222 and p.person_id != eu1.prsnl_id and p.active_ind = 1 and p.end_effective_dt_tm > sysdate) left outer join encounter entr on(entr.person_id = p.person_id and entr.active_ind = 1 and entr.end_effective_dt_tm > sysdate) left outer join ENCNTR_PERSON_RELTN EPR on (epr.encntr_id = entr.encntr_id and epr.person_reltn_cd != 3806	and epr.person_reltn_type_cd != 4492 and epr.active_ind = 1 and epr.end_effective_dt_tm >= sysdate) left outer join person p1 on (p1.person_id = epr.related_person_id and p1.active_ind = 1 and p1.end_effective_dt_tm >= sysdate) where e.action_dt_time >= to_date(?, 'MM/dd/yyyy hh24:mi:ss') and e.action_dt_time <= to_date(?, 'MM/dd/yyyy hh24:mi:ss')) order by prsnl_id,ACCESS_DATE desc,PID,ppa_id

ccl.multipleProduct= select distinct mi1.item_id, mi1.value, concat('+ ', mi2.value) as value1, mi2.value as value2, mi1.med_product_id, mi1.sequence, mi3.item_id as child_id, concat('     ', mi3.value) as child_desc, mi2.med_product_id, mi2.sequence as sequence1, mis.sequence as sequence2 from med_identifier mi1 join med_identifier mi2 on (mi2.item_id = mi1.item_id and mi2.med_identifier_type_cd = 1209 and mi2.med_product_id = 0 and mi2.active_ind = 1 and mi2.primary_ind = 1) join medication_definition md on (md.item_id = mi1.item_id and md.med_type_flag in (4,3)) join med_def_flex mdf on (mdf.item_id = mi1.item_id) join med_flex_object_idx mfoi on (mfoi.med_def_flex_id = mdf.med_def_flex_id and mfoi.active_ind = 1 and mfoi.parent_entity_id in (?) and mfoi.flex_object_type_cd = 53405372.00) join med_ingred_set mis on (mis.parent_item_id = mi2.item_id) join med_identifier mi3 on (mi3.item_id = mis.child_item_id and mi3.med_identifier_type_cd = 1209 and mi3.med_product_id = 0 and mi3.active_ind = 1 and mi3.primary_ind = 1) where mi1.pharmacy_type_cd = 17677985.00 and mi1.value_key like upper(?) and mi1.med_identifier_type_cd = ? and mi1.med_product_id = 0 and mi1.active_ind = 1 and mi1.primary_ind = 1 order by mi1.value, mi1.item_id, value2, sequence2

ccl.singleProduct= select distinct mi1.item_id, mi1.value, mi2.value as value2, mi1.med_product_id, mi1.sequence from med_identifier mi1 join med_identifier mi2 on (mi2.item_id = mi1.item_id and mi2.med_identifier_type_cd = 1209 and mi2.med_product_id = 0 and mi2.active_ind = 1 and mi2.primary_ind = 1) join medication_definition md on (md.item_id = mi1.item_id and md.med_type_flag = 0) join med_def_flex mdf on (mdf.item_id = mi1.item_id) join med_flex_object_idx mfoi on (mfoi.med_def_flex_id = mdf.med_def_flex_id and mfoi.active_ind = 1 and mfoi.parent_entity_id in (?) and mfoi.flex_object_type_cd = 53405372.00) where mi1.pharmacy_type_cd = 17677985 and mi1.value_key like upper(?) and mi1.med_identifier_type_cd = ? and mi1.med_product_id = 0 and mi1.active_ind = 1 and mi1.primary_ind = 1 order by mi1.value, value2

ccl.drugInqHistorical= select get_cd_value(e.loc_facility_cd, 'display') as Facility, get_cd_value(e.loc_nurse_unit_cd, 'display') as Nursing_Unit, get_cd_value(e.loc_bed_cd, 'display') as Bed, get_cd_value(e.loc_room_cd, 'display') as Room, ea.alias as Fin, ap.format_mask as FIN_format, p.name_full_formatted as Patient_Name, o.dept_misc_line as Order_Sentence, to_char(o.current_start_dt_tm, 'MON-dd-yyyy hh24:mi') as Order_Start_Date_Time, to_char(o.projected_stop_dt_tm, 'MON-dd-yyyy hh24:mi') as Order_Stop_Date_Time, case when (o.order_status_cd = 1088) then 'Active' else get_cd_value(o.order_status_cd, 'display') end as Order_Status, pdh.charge_qty, pdh.credit_qty, dh.doses, pdh.charge_qty, dh.dispense_hx_id, o.order_id as Order_Id from orders o join order_product op on (op.order_id = o.order_id and op.action_sequence = o.last_ingred_action_sequence and op.item_id = ?) join encntr_loc_hist e on (  e.encntr_id = o.encntr_id and e.beg_effective_dt_tm <= o.current_start_dt_tm and e.loc_facility_cd in(?) and e.end_effective_dt_tm = (select max(e1.end_effective_dt_tm) from encntr_loc_hist e1 where e1.encntr_id = e.encntr_id and e1.beg_effective_dt_tm <= o.current_start_dt_tm and e1.loc_facility_cd in(?))) join encntr_alias ea on (ea.encntr_id = e.encntr_id and ea.encntr_alias_type_cd = 91 and ea.active_ind = 1 and ea.end_effective_dt_tm > sysdate) join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) join person p on (p.person_id = o.person_id) left outer join dispense_hx dh on (dh.order_id = o.order_id and dh.dispense_dt_tm between to_date(?,'MM/DD/YYYY HH24:MI:SS') and to_date(?, 'MM/DD/YYYY HH24:MI:SS')) left outer join prod_dispense_hx pdh on (pdh.dispense_hx_id = dh.dispense_hx_id and pdh.ingred_sequence = 1) where o.template_order_id = 0.0 and o.current_start_dt_tm between to_date(?, 'MM/DD/YYYY HH24:MI:SS') and to_date(?,'MM/DD/YYYY HH24:MI:SS') and o.orig_ord_as_flag in (0, 4) and o.catalog_type_cd = 2605 and 1 = 1 order by Order_Start_Date_Time,o.encntr_id, o.order_id, e.end_effective_dt_tm,dh.dispense_hx_id

ccl.reserachReportSingleProduct= select distinct mi1.item_id, mi1.value, mi2.value as value2, mi1.med_product_id, mi1.sequence from med_identifier mi1  join med_identifier mi2 on (mi2.item_id = mi1.item_id and mi2.med_identifier_type_cd = 1209 and mi2.med_product_id = 0 and mi2.active_ind = 1 and mi2.primary_ind+0 = 1)  join medication_definition md on (md.item_id = mi1.item_id and md.med_type_flag = 0)  where mi1.value_key  like upper(?) and mi1.med_identifier_type_cd = ? and mi1.med_product_id = 0 and mi1.active_ind = 1 and mi1.primary_ind = 1 order by mi1.value, value2

ccl.reserachReportMultileProduct= select distinct mi1.item_id, mi1.value, concat('+ ', mi2.value) as value1, mi2.value as value2, mi1.med_product_id, mi1.sequence,  mi3.item_id as child_id,  concat('     ', mi3.value) as child_desc, mi2.med_product_id, mi2.sequence as sequence1, mis.sequence as sequence2 from med_identifier mi1  join med_identifier mi2 on (mi2.item_id = mi1.item_id and mi2.med_identifier_type_cd = 1209 and mi2.med_product_id = 0  and mi2.active_ind = 1 and mi2.primary_ind = 1)  join medication_definition md on (md.item_id = mi1.item_id and md.med_type_flag in (4,3))   join med_ingred_set mis on (mis.parent_item_id = mi2.item_id)  join med_identifier mi3 on (mi3.item_id = mis.child_item_id and mi3.med_identifier_type_cd = 1209 and mi3.med_product_id = 0  and mi3.active_ind = 1 and mi3.primary_ind = 1)  where mi1.value_key like upper(?) and mi1.med_identifier_type_cd = ? and mi1.med_product_id = 0 and mi1.active_ind = 1 and mi1.primary_ind = 1   order by mi1.value, mi1.item_id, value2, sequence2 

ccl.reserachReport= select CEN.COMPRESSION_CD, o.person_id,ea1.alias as MRN,ap1.format_mask as MRN_format_mask,p.name_full_formatted as Patient_Name,p.birth_dt_tm as DOB,pa2.alias as SSN, o.encntr_id,get_cd_value(e.encntr_type_cd,'display') as Encntr_type,to_char(e.reg_dt_tm, 'MM/DD/YYYY HH24:MI') as Reg_dt_tm, to_char(e.disch_dt_tm, 'MM/DD/YYYY HH24:MI') as Disch_dt_tm,  ea.alias as Fin, ap.format_mask as FIN_format,   o.dept_misc_line as Order_Sentence, to_char(o.current_start_dt_tm, 'MON-dd-yyyy hh24:mi') as Order_Start_Date_Time,  to_char(o.projected_stop_dt_tm, 'MON-dd-yyyy hh24:mi') as Order_Stop_Date_Time, case when (o.order_status_cd = 1088) then 'Active' else  get_cd_value(o.order_status_cd, 'display') end as Order_Status, o.order_id as Order_Id ,Concat(concat(trim(o.order_mnemonic),'('),     concat(trim(o.ordered_as_mnemonic),')')) as order_disp,o.simplified_display_line as Medication_SIG,mi.value as Medication_name,mi2.value as NDC,     case when(mi.med_type_flag = 0) then 'Product' else case when (mi.med_type_flag = 1) then 'Repackaged Item' else case when (mi.med_type_flag = 2) then     'Compound' else case when (mi.med_type_flag = 3) then 'IV Set' else case when (mi.med_type_flag = 4) then 'Order Set' end end end end end as Medication_type,     mi3.value as Ingredients,ce.event_id, concat(concat(concat(concat(get_cd_value(ce.event_cd,'display'),' '),ce.event_tag),' '),get_cd_value(cmr.ADMIN_ROUTE_CD,'display')) as event_disp, case when (o.med_order_type_cd =    14860399.00) then get_cd_value(cmr.iv_event_cd,'display') else case when (ce.result_status_cd = 1545) then 'Not Given'      else case when (ce.encntr_id is null) then null     else 'Med Given' end end end as Event_action, to_char(ce.event_end_dt_tm, 'MM/DD/YYYY HH24:MI') as Admin_time, to_char(ce.performed_dt_tm, 'MM/DD/YYYY HH24:MI') as charted_at, to_char(o1.current_start_dt_tm ,'MM/DD/YYYY HH24:MI') as Schedule_on, get_cd_value(cmr.ADMIN_SITE_CD,'display') as IV_site,     cmr.INITIAL_dosage,     get_cd_value(cmr.dosage_unit_cd,'display') as dosage_unit,     cmr1.infusion_rate,     get_cd_value(cmr1.infusion_unit_cd,'display') as infusion_unit,      cmr.initial_volume,     get_cd_value(cmr.infused_volume_unit_cd,'display') as volume_unit,      cmr.admin_strength,     get_cd_value(cmr.admin_strength_unit_cd,'display') as strength_unit,     cmr.substance_lot_number,      LB.LONG_BLOB as result_comment, GET_CD_VALUE(CEN.NOTE_TYPE_CD,'display') as Note_type      from orders o  join order_product op on (op.order_id = o.order_id and op.action_sequence = o.last_ingred_action_sequence and op.item_id in( ?))   join encounter e on (e.encntr_id = o.encntr_id and e.active_ind = 1 and e.encntr_status_cd in (14857115,4119198,39697,39701,248,39700,39698,39699)) join encntr_alias ea on (ea.encntr_id = e.encntr_id and ea.encntr_alias_type_cd = 91 and ea.active_ind = 1 and ea.end_effective_dt_tm > sysdate)  join alias_pool ap on (ap.alias_pool_cd = ea.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) join person p on (p.person_id = o.person_id) join encntr_alias ea1 on (EA1.ENCNTR_ID = E.ENCNTR_ID and EA1.ENCNTR_ALIAS_TYPE_CD = 93 and ea1.active_ind = 1 and ea1.end_effective_dt_tm > sysdate) join alias_pool ap1 on (ap1.alias_pool_cd = ea1.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER join person_alias pa2 ON (pa2.person_id=p.person_id and pa2.active_ind=1 and pa2.person_alias_type_cd=2334 and pa2.alias_pool_cd=7091) left outer join (ce_event_order_link ceol  join clinical_event ce on (ce.event_id = ceol.event_id and ce.event_end_dt_tm between to_date(?, 'MM/DD/YYYY HH24:MI:SS') and  to_date(?,'MM/DD/YYYY HH24:MI:SS')  and ce.view_level = 1 and ce.event_reltn_cd != 582 and ce.result_status_cd != 606 and ce.valid_until_dt_tm >sysdate  and ce.entry_mode_cd in(   53421967.00, 660790947.00,  105673428.00,  796770388.00,   53421963.00)))  on (ceol.parent_order_ident = o.order_id)  left outer join ce_med_result cmr on ( cmr.event_id = ce.event_id and cmr.valid_until_dt_tm > sysdate) left outer join ce_med_result cmr1 on (cmr1.event_id = ce.parent_event_id and cmr1.valid_until_dt_tm > sysdate)  left outer join orders o1 on ( o1.order_id = ce.order_id)  left outer join med_identifier mi  on( mi.item_id = op.item_id  and mi.med_product_id = 0     and MI.MED_IDENTIFIER_TYPE_CD = 1209      and mi.active_ind=1) left outer join dispense_hx dh on (dh.order_id = o.order_id and dh.dispense_dt_tm between to_date(?,'MM/DD/YYYY HH24:MI:SS') and to_date(?, 'MM/DD/YYYY HH24:MI:SS'))  left outer join prod_dispense_hx pdh on (pdh.dispense_hx_id = dh.dispense_hx_id and pdh.ingred_sequence = 1)  left outer join med_identifier mi2  on( mi2.item_id = pdh.item_id  and mi2.med_product_id = pdh.med_product_id     and MI2.MED_IDENTIFIER_TYPE_CD = 1218     and mi2.active_ind=1)     LEFT OUTER join med_ingred_set mis on (mis.parent_item_id = op.item_id)  LEFT OUTER join med_identifier mi3 on (mi3.item_id = mis.child_item_id and mi3.med_identifier_type_cd = 1209 and mi3.med_product_id = 0  and mi3.active_ind = 1 and mi3.primary_ind = 1)      LEFT OUTER JOIN CE_EVENT_NOTE CEN ON ( CEN.EVENT_ID = cE.EVENT_ID AND CEN.VALID_UNTIL_DT_TM > SYSDATE) LEFT OUTER JOIN LONG_BLOB LB ON (lb.parent_entity_id = cEN.ce_event_note_id and lb.parent_entity_name = 'CE_EVENT_NOTE') where o.template_order_id = 0.0 and o.current_start_dt_tm between to_date(?, 'MM/DD/YYYY HH24:MI:SS') and  to_date(?,'MM/DD/YYYY HH24:MI:SS') and o.orig_ord_as_flag  in(0, 4) and o.catalog_type_cd  = 2605 and 1 = 1 order by Order_Start_Date_Time,o.encntr_id, o.order_id,Admin_time

ccl.codingPersonCombine= SELECT distinct PC.PERSON_COMBINE_ID,PR.NAME_FULL_FORMATTED as PATIENT_NAME, PA.ALIAS as MRN, ap.FORMAT_MASK as mrn_format, O.ORG_NAME as FACILITY,oa.beg_effective_dt_tm, to_char(PCD.UPDT_DT_TM, 'DD-MON-YYYY HH24:MI:SS".00"') as COMBINED_DATE, P.NAME_FULL_FORMATTED as USER1, case when (PR.SEX_CD!=PR2.SEX_CD) then 'YES' ELSE 'NO' END as SEX_UPDATE, to_char(PR.BIRTH_DT_TM,'MM/DD/YYYY HH24:MI') as current_dob,  to_char(case when PR.DECEASED_DT_TM is not null then PR.DECEASED_DT_TM else sysdate end, 'MM/DD/YYYY HH24:MI') as current_deceased_dt_tm, to_char(PR2.BIRTH_DT_TM,'MM/DD/YYYY HH24:MI') as previous_dob,  to_char(case when PR2.DECEASED_DT_TM is not null then PR2.DECEASED_DT_TM else sysdate end, 'MM/DD/YYYY HH24:MI') as previous_deceased_dt_tm  FROM PERSON_COMBINE PC join PERSON_COMBINE_DET PCD on (PCD.PERSON_COMBINE_ID=PC.PERSON_COMBINE_ID AND PCD.ENTITY_NAME='CODING') join PRSNL P on (P.PERSON_ID=PCD.UPDT_ID) join CODING C on (C.CODING_ID=PCD.ENTITY_ID AND C.ACTIVE_IND=1) join PERSON PR on (PR.PERSON_ID=C.PERSON_ID) join PERSON PR2 on (PR2.PERSON_ID=PC.FROM_PERSON_ID) join PERSON_ALIAS PA on (PA.PERSON_ID= c.person_id AND PA.PERSON_ALIAS_TYPE_CD= 2328 AND PA.BEG_EFFECTIVE_DT_TM<=sysdate AND PA.END_EFFECTIVE_DT_TM>=sysdate  AND PA.ACTIVE_IND=1 and pa.beg_effective_dt_tm = (select max(pa1.beg_effective_dt_tm)  from person_alias pa1 where pa1.person_id = pa.person_id and pa1.person_alias_type_cd = 2328 and pa1.beg_effective_dt_tm <= sysdate and pa1.end_effective_dt_tm >=sysdate and pa1.active_ind = 1)) join ORG_ALIAS_POOL_RELTN OA on (OA.ALIAS_POOL_CD=PA.ALIAS_POOL_CD AND OA.ALIAS_ENTITY_NAME='PERSON_ALIAS' AND OA.BEG_EFFECTIVE_DT_TM<=sysdate AND OA.END_EFFECTIVE_DT_TM>=sysdate AND OA.ACTIVE_IND=1) join ORGANIZATION O on (O.ORGANIZATION_ID=OA.ORGANIZATION_ID AND O.ACTIVE_IND=1) left outer join alias_pool ap ON (ap.alias_pool_cd = PA.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) WHERE PC.UPDT_DT_TM between to_date(?,'MM/DD/YYYY') AND to_date(?, 'MM/DD/YYYY') AND PC.ACTIVE_IND=1 order by PATIENT_NAME,PC.PERSON_COMBINE_ID

ccl.codingPersonCombineSortByMrn= SELECT distinct PC.PERSON_COMBINE_ID,PR.NAME_FULL_FORMATTED as PATIENT_NAME, PA.ALIAS as MRN, ap.FORMAT_MASK as mrn_format, O.ORG_NAME as FACILITY,oa.beg_effective_dt_tm, to_char(PCD.UPDT_DT_TM, 'DD-MON-YYYY HH24:MI:SS".00"') as COMBINED_DATE, P.NAME_FULL_FORMATTED as USER1, case when (PR.SEX_CD!=PR2.SEX_CD) then 'YES' ELSE 'NO' END as SEX_UPDATE, to_char(PR.BIRTH_DT_TM,'MM/DD/YYYY HH24:MI') as current_dob,  to_char(case when PR.DECEASED_DT_TM is not null then PR.DECEASED_DT_TM else sysdate end, 'MM/DD/YYYY HH24:MI') as current_deceased_dt_tm, to_char(PR2.BIRTH_DT_TM,'MM/DD/YYYY HH24:MI') as previous_dob,  to_char(case when PR2.DECEASED_DT_TM is not null then PR2.DECEASED_DT_TM else sysdate end, 'MM/DD/YYYY HH24:MI') as previous_deceased_dt_tm  FROM PERSON_COMBINE PC join PERSON_COMBINE_DET PCD on (PCD.PERSON_COMBINE_ID=PC.PERSON_COMBINE_ID AND PCD.ENTITY_NAME='CODING') join PRSNL P on (P.PERSON_ID=PCD.UPDT_ID) join CODING C on (C.CODING_ID=PCD.ENTITY_ID AND C.ACTIVE_IND=1) join PERSON PR on (PR.PERSON_ID=C.PERSON_ID) join PERSON PR2 on (PR2.PERSON_ID=PC.FROM_PERSON_ID) join PERSON_ALIAS PA on (PA.PERSON_ID= c.person_id AND PA.PERSON_ALIAS_TYPE_CD= 2328 AND PA.BEG_EFFECTIVE_DT_TM<=sysdate AND PA.END_EFFECTIVE_DT_TM>=sysdate  AND PA.ACTIVE_IND=1 and pa.beg_effective_dt_tm = (select max(pa1.beg_effective_dt_tm)  from person_alias pa1 where pa1.person_id = pa.person_id and pa1.person_alias_type_cd = 2328 and pa1.beg_effective_dt_tm <= sysdate and pa1.end_effective_dt_tm >=sysdate and pa1.active_ind = 1)) join ORG_ALIAS_POOL_RELTN OA on (OA.ALIAS_POOL_CD=PA.ALIAS_POOL_CD AND OA.ALIAS_ENTITY_NAME='PERSON_ALIAS' AND OA.BEG_EFFECTIVE_DT_TM<=sysdate AND OA.END_EFFECTIVE_DT_TM>=sysdate AND OA.ACTIVE_IND=1) join ORGANIZATION O on (O.ORGANIZATION_ID=OA.ORGANIZATION_ID AND O.ACTIVE_IND=1) left outer join alias_pool ap ON (ap.alias_pool_cd = PA.alias_pool_cd and ap.active_ind = 1 and ap.end_effective_dt_tm > sysdate) WHERE PC.UPDT_DT_TM between to_date(?,'MM/DD/YYYY') AND to_date(?, 'MM/DD/YYYY') AND PC.ACTIVE_IND=1 order by MRN, PERSON_COMBINE_ID

assign.RemoveAllEncntrs= update emrp_auditor_encntr_reltn eaer set eaer.active_ind = 0, eaer.updt_id = ?, eaer.updt_dt_tm = sysdate where eaer.active_ind = 1 and eaer.prsnl_id = ?

assign.getAssignedPatients= select distinct p.name_full_formatted,p.person_id, to_char(p.birth_dt_tm, 'MM/dd/yyyy') as birth_dt_tm,GET_MRNS(p.person_id) as MRNString, get_cd_value(p.SEX_CD, 'display') AS SEX, get_cd_value(p.deceased_cd, 'display') as DECEASED, to_char(p.deceased_dt_tm, 'MM/dd/yyyy') as deceased_dt_tm, pa2.alias AS SSN, ap1.format_mask as SSN_format, a.zipcode AS Zip_code, a.city AS City, a.state AS State, a.street_addr AS Address from emrp_auditor_encntr_reltn eaer join person p on (p.person_id = eaer.person_id and p.person_type_cd=222 and exists (select ee.ENCNTR_ID from encounter ee where ee.person_id = p.person_id and  ee.end_effective_dt_tm>sysdate and ee.active_ind = 1 and ee.organization_id in (select por.organization_id from emrp_prsnl_org_reltn por where por.person_id=? and por.end_effective_dt_tm >sysdate and por.active_ind = 1))) LEFT OUTER join person_alias pa2 ON (pa2.person_id=p.person_id and pa2.active_ind=1 and pa2.person_alias_type_cd=2334 and pa2.alias_pool_cd=7091 and pa2.end_effective_dt_tm > sysdate) LEFT OUTER JOIN alias_pool ap1 ON (ap1.alias_pool_cd = pa2.alias_pool_cd and ap1.active_ind = 1 and ap1.end_effective_dt_tm > sysdate) LEFT OUTER JOIN Address a ON (a.parent_entity_id=p.person_id and a.parent_entity_name='PERSON' and a.active_ind=1 and a.end_effective_dt_tm>sysdate and a.address_type_cd = 288) where eaer.prsnl_id=? and eaer.active_ind = 1

clinical.doc.sorting = select ce.result_val, ce.result_status_cd, ce.event_class_cd, eesr.child_event_set_cd as mainseq,eesr.parent_event_set_cd as typecode, eesr.parent_event_set_name as type1, child_event_set_name  as Event1, get_cd_value(ce.result_status_cd, 'cdf_meaning') as prefixC, get_cd_value(ce.event_class_cd, 'cdf_meaning') as check_numeric, get_cd_value(ce.normalcy_cd, 'cdf_meaning') as check_normalcy,cen.ce_event_note_id as check_comments, ce.parent_event_id, ce.event_id, ce.event_cd, v.event_set_cd, get_cd_value(ce.result_status_cd, 'display') as Result_status, case when (ce.event_class_cd = 5235) then (case when (ce.result_val like '1:%') then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/',substr(ce.result_val,3,4))))) when (ce.result_val like '0:%')then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/', concat(substr(ce.result_val,3,4), concat(' ', concat(substr(ce.result_val,11,2),concat(':', substr(ce.result_val,13,2))))))))) when(ce.result_val like '2:%')then  concat(substr(ce.result_val,11,2), concat(':', substr(ce.result_val,13,2)))end) else (case when ce.event_tag is null then ce.result_val else ce.event_tag end) end as Resultval, to_char(ce.event_end_dt_tm,'MM/DD/YYYY HH24:MI') as eventdate, get_cd_value(ce.result_units_cd, 'display') as Unit, ce.normal_high as normal_high,  ce.normal_low as normal_low, ce.critical_high as critical_high, ce.critical_low as critical_low, get_cd_value(ce.normalcy_cd, 'display') as Normalcy , ce.event_title_text  as ResultTitle, case when pr.name_full_formatted is null then 'Unknown Personnel' else pr.name_full_formatted end as perform_prsnl from emrp_event_set_reltn eesr join v500_event_set_explode v on (v.event_set_cd = eesr.child_event_set_cd) join clinical_event ce on (ce.event_cd = v.event_cd and ce.person_id=? and ce.valid_until_dt_tm>sysdate and ce.view_level = 1  and ce.result_status_cd != 602 and ce.encntr_id = ?) left outer join ce_event_note cen on (ce.event_id=cen.event_id and cen.valid_until_dt_tm>sysdate) left outer join ce_event_prsnl cpr on ( cpr.event_id = ce.event_id and cpr.action_type_cd =  626 and cpr.valid_until_dt_tm > sysdate) left outer join prsnl pr on(pr.person_id = cpr.action_prsnl_id) where eesr.flowsheet_tab_event_set_cd=? order by  eesr.child_event_set_hierarchy_seq ,ce.event_end_dt_tm desc, ce.parent_event_id

clinical.docSortingByPerformedBy= select ce.result_val, ce.result_status_cd, ce.event_class_cd, eesr.child_event_set_cd as mainseq,eesr.parent_event_set_cd as typecode, eesr.parent_event_set_name as type1, child_event_set_name  as Event1, get_cd_value(ce.result_status_cd, 'cdf_meaning') as prefixC, get_cd_value(ce.event_class_cd, 'cdf_meaning') as check_numeric, get_cd_value(ce.normalcy_cd, 'cdf_meaning') as check_normalcy,cen.ce_event_note_id as check_comments, ce.parent_event_id, ce.event_id, ce.event_cd, v.event_set_cd, get_cd_value(ce.result_status_cd, 'display') as Result_status, case when (ce.event_class_cd = 5235) then (case when (ce.result_val like '1:%') then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/',substr(ce.result_val,3,4))))) when (ce.result_val like '0:%')then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/', concat(substr(ce.result_val,3,4), concat(' ', concat(substr(ce.result_val,11,2),concat(':', substr(ce.result_val,13,2))))))))) when(ce.result_val like '2:%')then  concat(substr(ce.result_val,11,2), concat(':', substr(ce.result_val,13,2)))end) else (case when ce.event_tag is null then ce.result_val else ce.event_tag end) end as Resultval, to_char(ce.event_end_dt_tm,'MM/DD/YYYY HH24:MI') as eventdate, get_cd_value(ce.result_units_cd, 'display') as Unit, ce.normal_high as normal_high,  ce.normal_low as normal_low, ce.critical_high as critical_high, ce.critical_low as critical_low, get_cd_value(ce.normalcy_cd, 'display') as Normalcy , ce.event_title_text  as ResultTitle, case when pr.name_full_formatted is null then 'Unknown Personnel' else pr.name_full_formatted end as perform_prsnl from emrp_event_set_reltn eesr join v500_event_set_explode v on (v.event_set_cd = eesr.child_event_set_cd) join clinical_event ce on (ce.event_cd = v.event_cd and ce.person_id=? and ce.valid_until_dt_tm>sysdate and ce.view_level = 1  and ce.result_status_cd != 602 and ce.encntr_id = ?) left outer join ce_event_note cen on (ce.event_id=cen.event_id and cen.valid_until_dt_tm>sysdate) left outer join ce_event_prsnl cpr on ( cpr.event_id = ce.event_id and cpr.action_type_cd =  626 and cpr.valid_until_dt_tm > sysdate) left outer join prsnl pr on(pr.person_id = cpr.action_prsnl_id) where eesr.flowsheet_tab_event_set_cd=? order by  perform_prsnl ,ce.event_end_dt_tm desc, ce.parent_event_id

clinical.docSortingByDate= select ce.result_val, ce.result_status_cd, ce.event_class_cd, eesr.child_event_set_cd as mainseq, eesr.parent_event_set_cd as typecode, eesr.parent_event_set_name as type1, child_event_set_name  as Event1, get_cd_value(ce.result_status_cd, 'cdf_meaning') as prefixC, get_cd_value(ce.event_class_cd, 'cdf_meaning') as check_numeric, get_cd_value(ce.normalcy_cd, 'cdf_meaning') as check_normalcy,cen.ce_event_note_id as check_comments, ce.parent_event_id, ce.event_id, ce.event_cd, v.event_set_cd, get_cd_value(ce.result_status_cd, 'display') as Result_status, case when (ce.event_class_cd = 5235) then (case when (ce.result_val like '1:%') then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/',substr(ce.result_val,3,4))))) when (ce.result_val like '0:%')then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/', concat(substr(ce.result_val,3,4), concat(' ', concat(substr(ce.result_val,11,2),concat(':', substr(ce.result_val,13,2))))))))) when(ce.result_val like '2:%')then  concat(substr(ce.result_val,11,2), concat(':', substr(ce.result_val,13,2)))end) else (case when ce.event_tag is null then ce.result_val else ce.event_tag end) end as Resultval, to_char(ce.event_end_dt_tm,'MM/DD/YYYY HH24:MI') as eventdate, get_cd_value(ce.result_units_cd, 'display') as Unit, ce.normal_high as normal_high, ce.normal_low as normal_low, ce.critical_high as critical_high, ce.critical_low as critical_low, get_cd_value(ce.normalcy_cd, 'display') as Normalcy , ce.event_title_text  as ResultTitle, pr.name_full_formatted as perform_prsnl from emrp_event_set_reltn eesr join v500_event_set_explode v on (v.event_set_cd = eesr.child_event_set_cd) join clinical_event ce on (ce.event_cd = v.event_cd and ce.person_id=? and ce.valid_until_dt_tm>sysdate and ce.view_level = 1 and ce.result_status_cd != 602 and ce.event_end_dt_tm between to_date(?, 'dd-MON-YYYY HH24:MI:SS') and to_date(?,'dd-MON-YYYY HH24:MI:SS') ) left outer join ce_event_note cen on (ce.event_id=cen.event_id and cen.valid_until_dt_tm>sysdate) left outer join ce_event_prsnl cpr on ( cpr.event_id = ce.event_id and cpr.action_type_cd =  626 and cpr.valid_until_dt_tm > sysdate) left outer join prsnl pr on(pr.person_id =  cpr.action_prsnl_id) where eesr.flowsheet_tab_event_set_cd=? order by  eesr.child_event_set_hierarchy_seq  , ce.event_end_dt_tm desc, ce.parent_event_id

print.addMRPAudit= insert into EMRP_ROI_PRINT_HISTORY (PRSNL_ID, PERSON_ID, ENCOUNTERS_SELECTED, CATEGORIES_SELECTED, ENCNTR_START_DT_TM, ENCNTR_END_DT_TM, POSTING_START_DT_TM, POSTING_END_DT_TM, PRINT_DT_TM, PURPOSE, DESTINATION, REQUESTED_BY, PROPER_AUTH_RECEIVED, COMMENTS, EMRP_AUDIT_ID, RELEASE_INFO, DESTINATION_ID, DESTINATION_TXT, REQUESTED_ID, REQUESTED_TXT) VALUES (?,?,?,?,to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),to_date(?,'MM/DD/YYYY HH24:MI:SS'),sysdate,?,?,?,?,?,?,?,?,?,?,?)

getGeneratedAuditId= select EMRP_AUDIT_SEQ.currval from dual

clinical.docSortingByPerformedByDate= select ce.result_val, ce.result_status_cd, ce.event_class_cd, eesr.child_event_set_cd as mainseq, eesr.parent_event_set_cd as typecode, eesr.parent_event_set_name as type1, child_event_set_name  as Event1, get_cd_value(ce.result_status_cd, 'cdf_meaning') as prefixC, get_cd_value(ce.event_class_cd, 'cdf_meaning') as check_numeric, get_cd_value(ce.normalcy_cd, 'cdf_meaning') as check_normalcy,cen.ce_event_note_id as check_comments, ce.parent_event_id, ce.event_id, ce.event_cd, v.event_set_cd, get_cd_value(ce.result_status_cd, 'display') as Result_status, case when (ce.event_class_cd = 5235) then (case when (ce.result_val like '1:%') then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/',substr(ce.result_val,3,4))))) when (ce.result_val like '0:%')then concat(substr(ce.result_val,7,2),concat('/', concat(substr(ce.result_val,9,2),concat('/', concat(substr(ce.result_val,3,4), concat(' ', concat(substr(ce.result_val,11,2),concat(':', substr(ce.result_val,13,2))))))))) when(ce.result_val like '2:%')then  concat(substr(ce.result_val,11,2), concat(':', substr(ce.result_val,13,2)))end) else (case when ce.event_tag is null then ce.result_val else ce.event_tag end) end as Resultval, to_char(ce.event_end_dt_tm,'MM/DD/YYYY HH24:MI') as eventdate, get_cd_value(ce.result_units_cd, 'display') as Unit, ce.normal_high as normal_high, ce.normal_low as normal_low, ce.critical_high as critical_high, ce.critical_low as critical_low, get_cd_value(ce.normalcy_cd, 'display') as Normalcy , ce.event_title_text  as ResultTitle, case when pr.name_full_formatted is null then 'Unknown Personnel' else pr.name_full_formatted end as perform_prsnl from emrp_event_set_reltn eesr join v500_event_set_explode v on (v.event_set_cd = eesr.child_event_set_cd) join clinical_event ce on (ce.event_cd = v.event_cd and ce.person_id=? and ce.valid_until_dt_tm>sysdate and ce.view_level = 1 and ce.result_status_cd != 602 and ce.event_end_dt_tm between to_date(?, 'dd-MON-YYYY HH24:MI:SS') and to_date(?,'dd-MON-YYYY HH24:MI:SS') ) left outer join ce_event_note cen on (ce.event_id=cen.event_id and cen.valid_until_dt_tm>sysdate) left outer join ce_event_prsnl cpr on ( cpr.event_id = ce.event_id and cpr.action_type_cd =  626 and cpr.valid_until_dt_tm > sysdate) left outer join prsnl pr on(pr.person_id =  cpr.action_prsnl_id) where eesr.flowsheet_tab_event_set_cd=? order by  perform_prsnl ,ce.event_end_dt_tm desc, ce.parent_event_id

ccl.eMRPActiveUsers= select PRSNL_ID, USERNAME, NAME_FIRST_KEY, NAME_LAST_KEY, NAME_MIDDLE_KEY, ADMIN_IND, PHYSICIAN_IND, HIM_IND, AUDITOR_IND, get_cd_value(POSITION_CD, 'display') as POSITION_NAME, POSITION_CD, EMPLOYEE_ID, to_char(BEGIN_DT_TM, 'MM/DD/YYYY HH24:MI') as BEGIN_DT_TM, to_char(END_DT_TM, 'MM/DD/YYYY HH24:MI') as END_DT_TM, EMAIL, to_char(BIRTH_DT_TM, 'MM/DD/YYYY') as BIRTH_DT_TM, to_char(ACC_START_DT_TM, 'MM/DD/YYYY HH24:MI') as ACC_START_DT_TM, to_char(ACC_CREATED_DT_TM, 'MM/DD/YYYY HH24:MI') as ACC_CREATED_DT_TM, to_char(LAST_ACCESSED_DT_TM, 'MM/DD/YYYY HH24:MI') as LAST_ACCESSED_DT_TM from emrp_users where active_ind = 1 order by NAME_LAST_KEY, NAME_FIRST_KEY

ccl9.patientActivityforClinic= SELECT distinct E.PERSON_ID, e.encntr_id, SUBSTR(eA.ALIAS,1,15) as MRN,   SUBSTR(P.NAME_FULL_FORMATTED,1,35) as FName FROM ENCOUNTER E join ENCNTR_ALIAS EA on (EA.encntr_ID = E.encntr_ID and ea.encntr_alias_type_cd = 93 AND eA.ACTIVE_IND = 1 AND eA.END_EFFECTIVE_DT_TM > sysdate) join PERSON P on (P.PERSON_ID = E.PERSON_ID   AND P.ACTIVE_IND = 1) WHERE E.REG_DT_TM >= to_date(?,'DD-MON-YYYY hh24:mi:ss') AND E.REG_DT_TM <= to_date(?,'DD-MON-YYYY hh24:mi:ss')   AND E.LOC_FACILITY_CD = ? and e.encntr_type_cd != 15500324 AND NOT EXISTS (SELECT E1.PERSON_ID FROM ENCOUNTER E1 WHERE E1.PERSON_ID = E.PERSON_ID AND E1.BEG_EFFECTIVE_DT_TM <= sysdate AND E1.LOC_FACILITY_CD = E.LOC_FACILITY_CD AND E1.REG_DT_TM >= to_date(?,'DD-MON-YYYY hh24:mi:ss')) ORDER by FName, MRN

ccl9.getDescByFacility= select v1.description from code_value v1 WHERE v1.code_value  in (?) and v1.display_key = ?

ccl9.getDescByClinic= select v1.description from code_value v1 WHERE v1.code_value = ?